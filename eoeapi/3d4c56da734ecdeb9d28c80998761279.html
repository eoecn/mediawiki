{"title":"Adding Licensing to Your App","text":"<p>\u8d1f\u8d23\u4eba\uff1aatearsan \n<\/p><p>\u539f\u6587\u94fe\u63a5\uff1a<a rel=\"nofollow\" target=\"_blank\" class=\"external free\" href=\"http:\/\/docs.eoeandroid.com\/guide\/google\/play\/licensing\/adding-licensing.html\">http:\/\/docs.eoeandroid.com\/guide\/google\/play\/licensing\/adding-licensing.html<\/a>\n<\/p><p><br \/>\n<\/p>\n<table id=\"toc\" class=\"toc\"><tr><td><div id=\"toctitle\"><h2>\u76ee\u5f55<\/h2><\/div>\n<ul>\n<li class=\"toclevel-1 tocsection-1\"><a href=\"#.E7.BB.99.E4.BD.A0.E7.9A.84.E5.BA.94.E7.94.A8.E6.B7.BB.E5.8A.A0.E7.AD.BE.E5.90.8D\"><span class=\"tocnumber\">1<\/span> <span class=\"toctext\">\u7ed9\u4f60\u7684\u5e94\u7528\u6dfb\u52a0\u7b7e\u540d<\/span><\/a>\n<ul>\n<li class=\"toclevel-2 tocsection-2\"><a href=\"#.E6.B7.BB.E5.8A.A0.E7.AD.BE.E5.90.8D.E6.9D.83.E9.99.90\"><span class=\"tocnumber\">1.1<\/span> <span class=\"toctext\">\u6dfb\u52a0\u7b7e\u540d\u6743\u9650<\/span><\/a><\/li>\n<li class=\"toclevel-2 tocsection-3\"><a href=\"#.E5.AE.9E.E7.8E.B0Policy\"><span class=\"tocnumber\">1.2<\/span> <span class=\"toctext\">\u5b9e\u73b0Policy<\/span><\/a>\n<ul>\n<li class=\"toclevel-3 tocsection-4\"><a href=\"#.E8.87.AA.E5.AE.9A.E4.B9.89Policy.E5.90.91.E5.AF.BC\"><span class=\"tocnumber\">1.2.1<\/span> <span class=\"toctext\">\u81ea\u5b9a\u4e49Policy\u5411\u5bfc<\/span><\/a><\/li>\n<li class=\"toclevel-3 tocsection-5\"><a href=\"#ServerManagedPolicy\"><span class=\"tocnumber\">1.2.2<\/span> <span class=\"toctext\">ServerManagedPolicy<\/span><\/a><\/li>\n<li class=\"toclevel-3 tocsection-6\"><a href=\"#StrictPolicy\"><span class=\"tocnumber\">1.2.3<\/span> <span class=\"toctext\">StrictPolicy<\/span><\/a><\/li>\n<\/ul>\n<\/li>\n<li class=\"toclevel-2 tocsection-7\"><a href=\"#.E5.AE.9E.E7.8E.B0Obfuscator\"><span class=\"tocnumber\">1.3<\/span> <span class=\"toctext\">\u5b9e\u73b0Obfuscator<\/span><\/a>\n<ul>\n<li class=\"toclevel-3 tocsection-8\"><a href=\"#AESObfuscator\"><span class=\"tocnumber\">1.3.1<\/span> <span class=\"toctext\">AESObfuscator<\/span><\/a><\/li>\n<\/ul>\n<\/li>\n<li class=\"toclevel-2 tocsection-9\"><a href=\"#.E5.9C.A8Activity.E4.B8.AD.E6.A3.80.E6.9F.A5.E7.AD.BE.E5.90.8D\"><span class=\"tocnumber\">1.4<\/span> <span class=\"toctext\">\u5728Activity\u4e2d\u68c0\u67e5\u7b7e\u540d<\/span><\/a>\n<ul>\n<li class=\"toclevel-3 tocsection-10\"><a href=\"#.E7.AD.BE.E5.90.8D.E6.A3.80.E6.9F.A5.E5.92.8C.E5.93.8D.E5.BA.94.E7.9A.84.E6.8F.8F.E8.BF.B0\"><span class=\"tocnumber\">1.4.1<\/span> <span class=\"toctext\">\u7b7e\u540d\u68c0\u67e5\u548c\u54cd\u5e94\u7684\u63cf\u8ff0<\/span><\/a><\/li>\n<li class=\"toclevel-3 tocsection-11\"><a href=\"#.E5.AF.BC.E5.85.A5\"><span class=\"tocnumber\">1.4.2<\/span> <span class=\"toctext\">\u5bfc\u5165<\/span><\/a><\/li>\n<li class=\"toclevel-3 tocsection-12\"><a href=\"#.E4.BB.A5.E5.86.85.E9.83.A8.E7.B1.BB.E7.9A.84.E6.96.B9.E5.BC.8F.E5.AE.9E.E7.8E.B0LicenseCheckerCallback\"><span class=\"tocnumber\">1.4.3<\/span> <span class=\"toctext\">\u4ee5\u5185\u90e8\u7c7b\u7684\u65b9\u5f0f\u5b9e\u73b0LicenseCheckerCallback<\/span><\/a><\/li>\n<li class=\"toclevel-3 tocsection-13\"><a href=\"#.E5.88.9B.E5.BB.BA.E4.B8.80.E4.B8.AA.E4.BB.8ELicenseCheckerCallback_.E5.88.B0UI.E7.9A.84Handler.E7.BA.BF.E7.A8.8B\"><span class=\"tocnumber\">1.4.4<\/span> <span class=\"toctext\">\u521b\u5efa\u4e00\u4e2a\u4eceLicenseCheckerCallback \u5230UI\u7684Handler\u7ebf\u7a0b<\/span><\/a><\/li>\n<li class=\"toclevel-3 tocsection-14\"><a href=\"#.E5.88.9D.E5.A7.8B.E5.8C.96LicenseChecker.E5.92.8CLicenseCheckerCall_-back\"><span class=\"tocnumber\">1.4.5<\/span> <span class=\"toctext\">\u521d\u59cb\u5316LicenseChecker\u548cLicenseCheckerCall -back<\/span><\/a><\/li>\n<li class=\"toclevel-3 tocsection-15\"><a href=\"#.E8.B0.83.E7.94.A8checkAccess.28.29.E5.88.9D.E5.A7.8B.E5.8C.96.E7.AD.BE.E5.90.8D.E6.A3.80.E6.9F.A5\"><span class=\"tocnumber\">1.4.6<\/span> <span class=\"toctext\">\u8c03\u7528checkAccess()\u521d\u59cb\u5316\u7b7e\u540d\u68c0\u67e5<\/span><\/a><\/li>\n<li class=\"toclevel-3 tocsection-16\"><a href=\"#.E4.B8.BA.E7.AD.BE.E5.90.8D.E8.AE.A4.E8.AF.81.E6.A4.8D.E5.85.A5.E4.BD.A0.E7.9A.84.E5.AF.86.E9.92.A5\"><span class=\"tocnumber\">1.4.7<\/span> <span class=\"toctext\">\u4e3a\u7b7e\u540d\u8ba4\u8bc1\u690d\u5165\u4f60\u7684\u5bc6\u94a5<\/span><\/a><\/li>\n<li class=\"toclevel-3 tocsection-17\"><a href=\"#.E5.85.B3.E9.97.ADIPC.E8.BF.9E.E6.8E.A5.E7.9A.84.E6.97.B6.E5.80.99.E8.B0.83.E7.94.A8LicenseChecker.E7.9A.84onDestory.28.29.E6.96.B9.E6.B3.95\"><span class=\"tocnumber\">1.4.8<\/span> <span class=\"toctext\">\u5173\u95edIPC\u8fde\u63a5\u7684\u65f6\u5019\u8c03\u7528LicenseChecker\u7684onDestory()\u65b9\u6cd5<\/span><\/a><\/li>\n<\/ul>\n<\/li>\n<li class=\"toclevel-2 tocsection-18\"><a href=\"#.E5.AE.9E.E7.8E.B0DeviceLimiter\"><span class=\"tocnumber\">1.5<\/span> <span class=\"toctext\">\u5b9e\u73b0DeviceLimiter<\/span><\/a><\/li>\n<li class=\"toclevel-2 tocsection-19\"><a href=\"#.E6.B7.B7.E6.B7.86.E4.BD.A0.E7.9A.84.E4.BB.A3.E7.A0.81\"><span class=\"tocnumber\">1.6<\/span> <span class=\"toctext\">\u6df7\u6dc6\u4f60\u7684\u4ee3\u7801<\/span><\/a><\/li>\n<li class=\"toclevel-2 tocsection-20\"><a href=\"#.E5.8F.91.E5.B8.83.E7.AD.BE.E5.90.8D.E8.BF.87.E7.9A.84.E5.BA.94.E7.94.A8\"><span class=\"tocnumber\">1.7<\/span> <span class=\"toctext\">\u53d1\u5e03\u7b7e\u540d\u8fc7\u7684\u5e94\u7528<\/span><\/a>\n<ul>\n<li class=\"toclevel-3 tocsection-21\"><a href=\"#.E5.88.A0.E9.99.A4Copy_Protection\"><span class=\"tocnumber\">1.7.1<\/span> <span class=\"toctext\">\u5220\u9664Copy Protection<\/span><\/a><\/li>\n<\/ul>\n<\/li>\n<li class=\"toclevel-2 tocsection-22\"><a href=\"#.E8.8E.B7.E5.BE.97.E6.94.AF.E6.8C.81\"><span class=\"tocnumber\">1.8<\/span> <span class=\"toctext\">\u83b7\u5f97\u652f\u6301<\/span><\/a><\/li>\n<\/ul>\n<\/li>\n<\/ul>\n<\/td><\/tr><\/table>\n<h1> <span class=\"mw-headline\" id=\".E7.BB.99.E4.BD.A0.E7.9A.84.E5.BA.94.E7.94.A8.E6.B7.BB.E5.8A.A0.E7.AD.BE.E5.90.8D\">\u7ed9\u4f60\u7684\u5e94\u7528\u6dfb\u52a0\u7b7e\u540d<\/span><\/h1>\n<p>\u5f53\u4f60\u5efa\u7acb\u4e00\u4e2a\u5f00\u53d1\u8005\u8d26\u53f7\u548c\u5f00\u53d1\u73af\u5883\u4e4b\u540e(\u89c1\u8bbe\u7f6e\u7b7e\u540d)\uff0c\u4f60\u5c31\u53ef\u4ee5\u5728License Verification Library(LVL)\u7ed9\u4f60\u7684app\u6dfb\u52a0\u7b7e\u540d\u4e86\u3002\n<\/p><p>\u5728LVL\u6dfb\u52a0\u7b7e\u540d\u8ba4\u8bc1\u9700\u8981\u9075\u5faa\u4e0b\u9762\u8fd9\u4e9b\u6b65\u9aa4\uff1a\n<\/p><p>1.\u5728\u4f60\u7684\u5e94\u7528\u7684manifest.xml\u91cc\u6dfb\u52a0\u7b7e\u540d\u6743\u9650\n<\/p><p>2.\u5b9e\u73b0Policy \u2014\u2014 \u4f60\u53ef\u4ee5\u9009\u62e9LVL \u4e2d\u63d0\u4f9b\u7684\u5b8c\u6574\u7684\u5b9e\u73b0\u65b9\u6848\uff0c\u6216\u8005\u4f60\u81ea\u5df1\u521b\u5efa\u4e00\u4e2a\n<\/p><p>3.\u5b9e\u73b0Obfuscator, \u5982\u679c\u4f60\u7684Policy\u9700\u8981\u7f13\u5b58\u4efb\u4f55\u7b7e\u540d\u8ba4\u8bc1\u7ed3\u679c\n<\/p><p>4.\u5728\u4f60\u5e94\u7528\u7684main Activity\u4e2d\u6dfb\u52a0\u4ee3\u7801\u8fdb\u884c\u7b7e\u540d\u68c0\u67e5\n<\/p><p>5.\u5b9e\u73b0DeviceLimiter(\u53ef\u9009, \u4f46\u662f\u4e0d\u63a8\u8350)\n<\/p><p>\u4e0b\u9762\u63cf\u8ff0\u4e86\u8fd9\u4e9b\u6b65\u9aa4. \u5f53\u4f60\u5b8c\u6210\u4e86\u8fd9\u4e9b\u64cd\u4f5c, \u4f60\u5c31\u5e94\u7528\u53ef\u4ee5\u6210\u529f\u7f16\u8bd1\u4f60\u7684\u5e94\u7528\u4e86, \u5e76\u6309\u7167\u8bbe\u5b9a\u7684\u6d4b\u8bd5\u73af\u5883\u5f00\u59cb\u6d4b\u8bd5\u4f60\u7684\u5e94\u7528. \n<\/p><p>LVL\u5305\u542b\u4e86\u5bf9\u5168\u5957\u6e90\u7801\u5b8c\u6574\u7684\u6982\u8ff0, \u89c1Summary of LVL Classes and Interfaces\n<\/p><p><br \/>\n<\/p>\n<h2> <span class=\"mw-headline\" id=\".E6.B7.BB.E5.8A.A0.E7.AD.BE.E5.90.8D.E6.9D.83.E9.99.90\">\u6dfb\u52a0\u7b7e\u540d\u6743\u9650<\/span><\/h2>\n<p>\u4e3a\u4e86\u4f7f\u7528Google Play\u53d1\u9001\u7b7e\u540d\u9a8c\u8bc1\u8bf7\u6c42\u5230\u670d\u52a1\u5668, \u4f60\u7684\u5e94\u7528\u672c\u8eab\u5fc5\u987b\u6709\u76f8\u5e94\u7684\u6743\u9650: com.android.vending.CHECK_LICENSE. \u5982\u679c\u4f60\u7684\u5e94\u7528\u6ca1\u6709\u8fdb\u884c\u7b7e\u540d\u8ba4\u8bc1\u6743\u9650\u7684\u58f0\u660e\u5c31\u5c1d\u8bd5\u8fdb\u884c\u7b7e\u540d\u8ba4\u8bc1, LVL\u4f1a\u629b\u51fa\u4e00\u4e2a\u5b89\u5168\u5f02\u5e38.\n<\/p><p>\u5728\u4f60\u7684\u5e94\u7528\u91cc\u6dfb\u52a0\u7b7e\u540d\u8ba4\u8bc1\u7684\u6743\u9650, \u9700\u8981\u5728&lt;manifest&gt;\u4e0b\u521b\u5efa\u5143\u7d20&lt;uses-permission&gt; ,  \u5982\uff1a\n<\/p><p>&lt;uses-permission android:name=\"com.android.vending.CHECK_LICENSE\"&gt;\n<\/p><p>\u4e0b\u9762\u662f\u4f8b\u5b50\uff1a\n<\/p>\n<pre class=\"xml\">&#160;\n<span style=\"color: #009900;\"><span style=\"font-weight: bold; color: black;\">&lt;?xml<\/span> <span style=\"color: #000066;\">version<\/span>=<span style=\"color: #ff0000;\">&quot;1.0&quot;<\/span> <span style=\"color: #000066;\">encoding<\/span>=<span style=\"color: #ff0000;\">&quot;utf-8&quot;<\/span><span style=\"font-weight: bold; color: black;\">?&gt;<\/span><\/span>\n<span style=\"color: #009900;\"><span style=\"font-weight: bold; color: black;\">&lt;manifest<\/span> <span style=\"color: #000066;\">xmlns:android<\/span>=<span style=\"color: #ff0000;\">&quot;http:\/\/schemas.android.com\/apk\/res\/android&quot;<\/span> ...<span style=\"color: #ff0000;\">&quot;&gt;<\/span>\n    <span style=\"color: #009900;\">&lt;!-- Devices &gt;<\/span>= 3 have version of Google Play that supports licensing. --&gt;\n    <span style=\"color: #009900;\">&lt;uses-sdk android:minSdkVersion=&quot;<\/span><span style=\"color: #cc66cc;\">3<\/span><span style=\"color: #ff0000;\">&quot; \/&gt;<\/span>\n    <span style=\"color: #009900;\">&lt;!-- Required permission to check licensing. --&gt;<\/span>\n    <span style=\"color: #009900;\">&lt;uses-permission android:name=&quot;<\/span>com.android.vending.CHECK_LICENSE<span style=\"color: #ff0000;\">&quot; \/&gt;<\/span>\n    ...\n<span style=\"color: #009900;\">&lt;\/manifest&gt;<\/span>\n<\/span><\/pre>\n<div style=\"margin: 1em 0; padding: 10px; overflow: auto; background: #F7F7F7; border-left:4px solid; border-color:#258AAF;\">\n<p>\u6ce8\u610f\uff1a\u4f60\u4e0d\u53ef\u4ee5\u5728LVL\u5e93\u7684\u9879\u76ee\u7684manifest\u4e2d\u58f0\u660eCHECK_LICENSE\u6743\u9650, \u56e0\u4e3aSDK Tools\u4e0d\u4f1a\u628a\u5b83\u5408\u5e76\u5230\u4f9d\u8d56\u7684\u9879\u76ee\u4e2d. \u56e0\u6b64, \u4f60\u5fc5\u987b\u5728\u6bcf\u4e2a\u9879\u76ee\u7684manifest\u4e2d\u8fdb\u884c\u6743\u9650\u58f0\u660e.\n<\/p>\n<\/div>\n<p><br \/>\n<\/p>\n<h2> <span class=\"mw-headline\" id=\".E5.AE.9E.E7.8E.B0Policy\">\u5b9e\u73b0Policy<\/span><\/h2>\n<p>Google Play\u7684\u7b7e\u540d\u670d\u52a1\u672c\u8eab\u4e0d\u786e\u5b9a\u662f\u5426\u5e94\u8be5\u8ba9\u63d0\u4ea4\u7684\u7b7e\u540d\u901a\u8fc7\u8ba4\u8bc1. \u76f8\u53cd, \u8fd9\u4e2a\u804c\u8d23\u4ea4\u7ed9\u4e86\u4f60\u5e94\u7528\u4e2d\u63d0\u4f9b\u7684Policy.\n<\/p><p>Policy\u662fLVL\u58f0\u660e\u7684\u63a5\u53e3, \u7528\u6765\u6839\u636e\u7b7e\u540d\u9a8c\u8bc1\u7ed3\u679c\u63a7\u5236\u4f60\u7684\u5e94\u7528\u5141\u8bb8\u6216\u7981\u7528\u7528\u6237\u8bbf\u95ee. \u4f7f\u7528LVL, \u4f60\u7684\u5e94\u7528\u5fc5\u987b\u63d0\u4f9bPolicy\u7684\u5b9e\u73b0.\n<\/p><p>Policy\u5b9a\u4e86\u4e24\u4e2a\u65b9\u6cd5, allowAccess()\u3001processServerResponse(), \u5f53LicenseChecker\u5b9e\u4f8b\u5904\u7406\u6765\u81ea\u7b7e\u540d\u670d\u52a1\u5668\u7684\u54cd\u5e94\u7684\u65f6\u5019\u4f1a\u88ab\u8c03\u7528. \u5b83\u8fd8\u5b9a\u4e49\u4e86\u4e00\u4e2a\u53eb\u505aLicenseResponse\u7684\u679a\u4e3e\u7c7b, \u5728\u8c03\u7528processServerResponse()\u7684\u65f6\u5019\u628a\u6307\u5b9a\u7684\u7b7e\u540d\u9a8c\u8bc1\u7ed3\u679c\u4f20\u8fdb\u53bb.  \n<\/p>\n<ul><li>processServerResponse() \u5728\u51b3\u5b9a\u662f\u5426\u6388\u6743\u4e4b\u524d\u8ba9\u4f60\u5bf9\u4ece\u7b7e\u540d\u9a8c\u8bc1\u670d\u52a1\u5668\u63a5\u6536\u5230\u7684\u54cd\u5e94\u6570\u636e\u8fdb\u884c\u9884\u5904\u7406.\n<\/li><\/ul>\n<p>\u4e00\u4e2a\u5178\u578b\u7684\u5b9e\u73b0\u662f\u53ef\u4ee5\u4ece\u54cd\u5e94\u6570\u636e\u4e2d\u63d0\u53d6\u4e00\u4e9b\u6216\u5168\u90e8\u5b57\u6bb5\u5e76\u5b58\u5230\u672c\u5730\u8fdb\u884c\u6301\u4e45\u5316\u5b58\u50a8, \u6bd4\u5982\u901a\u8fc7SharedPreferences \u5b58\u50a8, \u4ee5\u786e\u4fdd\u53ef\u4ee5\u8de8\u5e94\u7528\u8bbf\u95ee, \u800c\u4e14\u4e0d\u4f1a\u56e0\u4e3a\u8bbe\u5907\u5173\u673a\u5bfc\u81f4\u6570\u636e\u4e22\u5931. \u4f8b\u5982, Policy\u53ef\u4ee5\u5728\u6301\u4e45\u6027\u6570\u636e\u5bb9\u5668 \u4e2d\u6301\u6709\u7b7e\u540d\u6700\u540e\u4e00\u6b21\u9a8c\u8bc1\u6210\u529f\u7684\u65f6\u95f4\u6233\u3001\u91cd\u8bd5\u6b21\u6570\u3001\u6709\u6548\u671f\u7b49\u7c7b\u4f3c\u7684\u4fe1\u606f, \u800c\u4e0d\u662f\u5728\u5e94\u7528\u6bcf\u6b21\u542f\u52a8\u7684\u65f6\u5019\u91cd\u65b0\u52a0\u8f7d\u8fd9\u4e9b\u6570\u636e.\n<\/p><p>\u5f53\u5728\u672c\u5730\u5b58\u50a8\u54cd\u5e94\u6570\u636e\u7684\u65f6\u5019, Policy\u5fc5\u987b\u786e\u4fdd\u6570\u636e\u8fdb\u884c\u4e86\u6df7\u6dc6\u5904\u7406(\u89c1\u201d\u5b9e\u73b0Obfuscator\u201d)\n<\/p>\n<ul><li>allowAccess()\u6839\u636e\u4efb\u4f55\u6709\u6548\u7684\u7b7e\u540d\u9a8c\u8bc1\u54cd\u5e94\u6570\u636e(\u6765\u81ea\u670d\u52a1\u5668\u54cd\u5e94\u6216\u7f13\u5b58)\u6216\u5176\u4ed6\u7279\u5b9a\u5e94\u7528\u7a0b\u5e8f\u4fe1\u606f\u51b3\u5b9a\u662f\u5426\u6388\u6743\u7ed9\u7528\u6237\u8bbf\u95ee\u4f60\u7684\u5e94\u7528. \u4f8b\u5982, \u4f60\u5b9e\u73b0\u7684 allowAccess()\u53ef\u4ee5\u5e26\u5165\u4e00\u4e9b\u989d\u5916\u7684\u6761\u4ef6, \u5982usage\u6216\u8005\u4ece\u540e\u53f0\u670d\u52a1\u5668\u68c0\u7d22\u5230\u7684\u6570\u636e. \u5728\u6240\u6709\u7684\u60c5\u51b5\u4e0b, \u5982\u679c\u7528\u6237\u88ab\u6388\u6743\u4f7f\u7528\u5e94\u7528, \u65b9\u6cd5\u5e94\u8be5\u53ea\u8fd4\u56detrue. \u5982\u679c\u56e0\u4e3a\u7f51\u7edc\u6216\u7cfb\u7edf\u539f\u56e0\u5bfc\u81f4\u7b7e\u540d\u9a8c\u8bc1\u672a\u5b8c\u6210, \u4f60\u53ef\u4ee5\u6307\u5b9a\u4e00\u4e2a\u91cd\u8bd5\u6b21\u6570\u5e76\u5141\u8bb8\u7528\u6237\u6682\u65f6\u8bbf\u95ee\u76f4\u5230\u4e0b\u4e00\u6b21\u5b8c\u6210\u9a8c\u8bc1.\n<\/li><\/ul>\n<p>\u4e3a\u4e86\u7b80\u5316\u4f60\u7ed9\u5e94\u7528\u6dfb\u52a0\u7b7e\u540d\u7684\u8fc7\u7a0b\u5e76\u63d0\u4f9b\u4e00\u4e2a\u8bbe\u7f6ePolicy\u7684\u8bf4\u660e, LVL\u63d0\u4f9b\u4e86\u4e24\u4e2a\u5b8c\u6574\u7684Policy\u5b9e\u73b0, \u4f60\u53ef\u4ee5\u76f4\u63a5\u4f7f\u7528\u800c\u4e0d\u9700\u8981\u4efb\u4f55\u4fee\u6539: \n<\/p>\n<ul><li>ServerManagedPolicy, \u4f7f\u7528\u670d\u52a1\u5668\u9ed8\u8ba4\u8bbe\u7f6e\u548c\u7f13\u5b58\u7684\u54cd\u5e94\u7ed3\u679c\u6765\u7ba1\u7406\u5404\u79cd\u7f51\u7edc\u73af\u5883\u4e0b\u7684\u8bbf\u95ee,\n<\/li><\/ul>\n<ul><li>StrictPolicy, \u4e0d\u7f13\u5b58\u4efb\u4f55\u54cd\u5e94\u7ed3\u679c\u5e76\u4e14\u53ea\u6709\u670d\u52a1\u5668\u8fd4\u56de\u9a8c\u8bc1\u8fc7\u7684\u54cd\u5e94\u7ed3\u679c\u624d\u80fd\u8bbf\u95ee.\n<\/li><\/ul>\n<p>\u5bf9\u4e8e\u5927\u591a\u6570\u5e94\u7528\u6765\u8bf4, \u6bd4\u8f83\u63a8\u8350ServerManagedPolicy. ServerManagedPolicy\u662fLVL\u9ed8\u8ba4\u7684\u65b9\u6848, \u5e76\u4e14\u5df2\u7ecf\u5305\u542b\u5728LVL\u7684\u793a\u4f8b\u5e94\u7528\u4e2d.\n<\/p><p><br \/>\n<\/p>\n<h3> <span class=\"mw-headline\" id=\".E8.87.AA.E5.AE.9A.E4.B9.89Policy.E5.90.91.E5.AF.BC\">\u81ea\u5b9a\u4e49Policy\u5411\u5bfc<\/span><\/h3>\n<p>\u5728\u4f60\u7684\u7b7e\u540d\u5b9e\u73b0\u4e2d, \u4f60\u53ef\u4ee5\u4f7f\u7528LVL\u63d0\u4f9b\u7684\u5b8c\u6574\u7684Policy\u5b9e\u73b0(ServerManagedPolicy\u6216StrictPolicy)\u6216\u8005\u4f60\u53ef\u4ee5\u81ea\u5b9a\u4e49\u4e00\u4e2aPolicy. \u5bf9\u4e8e\u4efb\u4f55\u81ea\u5b9a\u4e49Policy, \u8fd9\u91cc\u6709\u51e0\u4e2a\u91cd\u8981\u7684\u8bbe\u8ba1\u8981\u70b9\u9700\u8981\u7406\u89e3\u5e76\u4e14\u5728\u4f60\u7684\u5b9e\u73b0\u4e2d\u4f7f\u7528.\n<\/p><p>\u7b7e\u540d\u9a8c\u8bc1\u670d\u52a1\u5668\u4e00\u822c\u4f1a\u9650\u5236\u8bf7\u6c42\u6b21\u6570\u4ee5\u9632\u6b62\u8fc7\u5ea6\u4f7f\u7528\u670d\u52a1\u5668\u8d44\u6e90\u800c\u5bfc\u81f4\u62d2\u7edd\u670d\u52a1. \u5f53\u4e00\u4e2a\u5e94\u7528\u8d85\u8fc7\u4e86\u8bf7\u6c42\u9650\u5236, \u670d\u52a1\u5668\u4f1a\u8fd4\u56de503\u54cd\u5e94\u7801, \u4f5c\u4e3a\u4e00\u4e2a\u901a\u7528\u7684\u670d\u52a1\u5668\u9519\u8bef\u544a\u8bc9\u4f60\u7684\u5e94\u7528. \u8fd9\u5c31\u610f\u5473\u7740\u5728\u9650\u5236\u88ab\u91cd\u7f6e\u4e4b\u524d\u5c06\u6ca1\u6709\u53ef\u7528\u7684\u7b7e\u540d\u9a8c\u8bc1\u54cd\u5e94\u7ed3\u679c\u63d0\u4f9b\u7ed9\u7528\u6237, \u8fd9\u4f1a\u65e0\u671f\u9650\u7684\u5f71\u54cd\u5e94\u7528\u7528\u6237.\n<\/p><p>\u5982\u679c\u4f60\u51c6\u5907\u81ea\u5b9a\u4e49\u4e00\u4e2apolicy, \u6211\u4eec\u63a8\u8350Policy: \n<\/p><p>1.\t\u628a\u5927\u90e8\u5206\u6700\u8fd1\u7684\u6210\u529f\u7684\u7b7e\u540d\u9a8c\u8bc1\u7ed3\u679c\u7f13\u5b58(\u5e76\u6df7\u6dc6\u5904\u7406) \u5728\u672c\u5730\u8fdb\u884c\u6301\u4e45\u5316\u4fdd\u5b58\n<\/p><p>2.\t\u53ea\u8981\u7f13\u5b58\u7684\u54cd\u5e94\u7ed3\u679c\u662f\u6709\u6548\u7684, \u90a3\u4e48\u5bf9\u6240\u6709\u7684\u7b7e\u540d\u68c0\u67e5\u90fd\u8fd4\u56de\u7f13\u5b58\u7684\u54cd\u5e94\u7ed3\u679c, \u800c\u4e0d\u662f\u521b\u5efa\u4e00\u4e2a\u9a8c\u8bc1\u8bf7\u6c42. \u6211\u4eec\u63a8\u8350\u6839\u636e\u670d\u52a1\u5668\u989d\u5916\u63d0\u4f9b\u7684VT\u8bbe\u7f6e\u54cd\u5e94\u7ed3\u679c\u7684\u6709\u6548\u671f. \u66f4\u591a\u4fe1\u606f\u89c1Server Response Extras\n<\/p><p>3.\t\u5982\u679c\u5c1d\u8bd5\u4efb\u4f55\u8bf7\u6c42\u90fd\u8fd4\u56de\u9519\u8bef, \u4f7f\u7528\u4e00\u4e2a\u6307\u6570\u56de\u907f\u8fd9\u4e2a\u60c5\u51b5.  \u8bb0\u5f55Google Play\u5ba2\u6237\u7aef\u81ea\u52a8\u5c1d\u8bd5\u5931\u8d25\u7684\u8bf7\u6c42, \u56e0\u4e3a\u5728\u5927\u591a\u6570\u60c5\u51b5\u4e0b\u4f60\u7684Policy\u4e0d\u9700\u8981\u518d\u53bb\u5c1d\u8bd5\n<\/p><p>4.\t\u63d0\u4f9b\u4e00\u4e2a\u201c\u5bbd\u9650\u671f\u9650\u201d\u5141\u8bb8\u7528\u6237\u5728\u9650\u5b9a\u7684\u65f6\u95f4\u6216\u6b21\u6570\u5185\u4f7f\u7528\u4f60\u7684\u5e94\u7528, \u5728\u9700\u8981\u91cd\u65b0\u8fdb\u884c\u7b7e\u540d\u9a8c\u8bc1\u7684\u65f6\u5019. \u5f53\u6ca1\u6709\u6709\u6548\u7684\u7b7e\u540d\u54cd\u5e94\u7ed3\u679c\u65f6, \u4f60\u53ef\u4ee5\u8bbe\u7f6e\u4e00\u4e2a\u8303\u56f4\u5f88\u5927\u7684\u9650\u5236\u503c\u63a7\u5236\u5728\u5bbd\u9650\u671f\u5185\u7684\u7528\u6237\u5141\u8bb8\u4f7f\u7528\u4f60\u7684\u5e94\u7528\u76f4\u5230\u4e0b\u4e00\u6b21\u7b7e\u540d\u68c0\u67e5\u5b8c\u6210.\n<\/p><p>\u4f9d\u7167\u4e0a\u9762\u5217\u51fa\u7684\u5411\u5bfc\u8bbe\u8ba1\u4f60\u7684Policy\u662f\u5f88\u5173\u952e, \u56e0\u4e3a\u5b83\u53ef\u4ee5\u786e\u4fdd\u6700\u597d\u7684\u7528\u6237\u4f53\u9a8c, \u751a\u81f3\u540c\u65f6\u8ba9\u4f60\u80fd\u5728\u51fa\u9519\u7684\u60c5\u51b5\u4e0b\u6709\u6548\u7684\u63a7\u5236\u4f60\u7684\u5e94\u7528.\n<\/p><p>\u8bb0\u5f55\u4efb\u4f55\u670d\u52a1\u5668\u63d0\u4f9b\u7684\u53ef\u7528\u7684\u8bbe\u7f6e\u5e2e\u52a9\u4f60\u7ba1\u7406\u6709\u6548\u671f\u548c\u7f13\u5b58, \u91cd\u8bd5\u5bbd\u9650\u671f\u7b49\u7b49. \u4f7f\u7528\u670d\u52a1\u5668\u63d0\u4f9b\u7684\u8bbe\u7f6e\u975e\u5e38\u7b80\u5355\u5e76\u4e14\u9ad8\u5ea6\u63a8\u8350. \u53ef\u4ee5\u770b\u770bServerManagedPolicy\u5b9e\u73b0\u7684\u4f8b\u5b50. \u6709\u5173\u4e8e\u670d\u52a1\u5668\u7684\u63d0\u4f9b\u8bbe\u7f6e\u548c\u4fe1\u606f\u53ef\u4ee5\u89c1Server Response Extras\n<\/p><p><br \/>\n<\/p>\n<h3> <span class=\"mw-headline\" id=\"ServerManagedPolicy\">ServerManagedPolicy<\/span><\/h3>\n<p>ServerManagedPolicy\u662fLVL\u63d0\u4f9b\u7684\u5b8c\u6574\u5b9e\u73b0\u7684\u5e76\u63a8\u8350\u4f7f\u7528\u7684Policy\u63a5\u53e3. \u8fd9\u4e2a\u5b9e\u73b0\u5df2\u7ecf\u4f5c\u4e3a\u9ed8\u8ba4\u7684Policy\u8ddfLVL\u7684\u7c7b\u548c\u670d\u52a1\u6574\u5408\u5728\u7c7b\u5e93\u91cc.\n<\/p><p>ServerManagedPolicy\u63d0\u4f9b\u4e86\u5904\u7406\u7b7e\u540d\u548c\u91cd\u8bd5\u54cd\u5e94\u7684\u6240\u6709\u65b9\u6cd5. \u5b83\u4f1a\u628a\u6240\u6709\u7684\u54cd\u5e94\u7ed3\u679c\u7f13\u5b58\u5230\u672c\u5730SharedPreferences \u6587\u4ef6, \u5e76\u4f7f\u7528\u5e94\u7528\u7684Obfuscator \u7684\u5b9e\u73b0\u7c7b\u6df7\u6dc6. \u8fd9\u786e\u4fdd\u4e86\u7b7e\u540d\u7684\u54cd\u5e94\u6570\u636e\u662f\u5b89\u5168\u7684\u5e76\u4e14\u4e0d\u4f1a\u56e0\u4e3a\u8bbe\u5907\u5173\u673a\u800c\u4e22\u5931.\n<\/p><p>ServerManagedPolicy \u63d0\u4f9b\u4e86\u63a5\u53e3\u7684\u5177\u4f53\u5b9e\u73b0\u65b9\u6cd5processServerResponse()\u548callowAccess()\u540c\u65f6\u4e5f\u5305\u62ec\u4e00\u7ec4\u652f\u6301\u7ba1\u7406\u7b7e\u540d\u54cd\u5e94\u6570\u636e\u7684\u65b9\u6cd5\u548c\u7c7b\u578b.\n<\/p><p>\u91cd\u8981\u7684\u662f, ServerManagedPolicy\u7684\u5173\u952e\u7279\u6027\u662f\u4f7f\u7528\u670d\u52a1\u5668\u63d0\u4f9b\u7684\u8bbe\u7f6e\u4e3a\u57fa\u7840\u7ba1\u7406\u5e94\u7528\u7684\u7b7e\u540d\u6388\u6743, \u800c\u4e0d\u53d7\u5404\u79cd\u7f51\u7edc\u548c\u5f02\u5e38\u6761\u4ef6\u7684\u5f71\u54cd. \u5f53\u4e00\u4e2a\u5e94\u7528\u8fde\u63a5\u5230Google Play\u670d\u52a1\u5668\u8fdb\u884c\u7b7e\u540d\u8ba4\u8bc1\u7684\u65f6\u5019, \u670d\u52a1\u5668\u4f1a\u628a\u8bbe\u7f6e\u9879\u4f5c\u4e3akey-value\u7684\u5f62\u5f0f\u5b58\u5230\u67d0\u4e9b\u54cd\u5e94\u7c7b\u578b\u7684\u989d\u5916\u7684\u5b57\u6bb5\u4e2d. \u4f8b\u5982, \u670d\u52a1\u5668\u63d0\u4f9b\u4e86\u63a8\u8350\u5e94\u7528\u7b7e\u540d\u4f7f\u7528\u7684\u4e00\u4e9b\u503c, \u5c24\u5176\u662f\u662f\u6709\u6548\u671f\u3001\u91cd\u8bd5\u5bbd\u9650\u671f\u3001\u6700\u5927\u91cd\u8bd5\u6b21\u6570. ServerManagedPolicy \u628a\u7b7e\u540d\u54cd\u5e94\u6570\u636e\u4e2d\u7684\u503c\u4f20\u5165\u5230processServerResponse() \u5e76\u5728allowAccess()\u4e2d\u6821\u9a8c\u503c. \u6709\u5173\u4e8eServerManagedPolicy\u4f7f\u7528\u670d\u52a1\u5668\u63d0\u4f9b\u7684\u8bbe\u7f6e\u9879, \u89c1Server Response Extras.\n<\/p><p>\u4e3a\u4e86\u65b9\u4fbf\u3001\u66f4\u597d\u7684\u6027\u80fd\u548c\u4eceGoogle Play\u670d\u52a1\u5668\u4e0a\u53d6\u5f97\u66f4\u597d\u7684\u7b7e\u540d\u8bbe\u7f6e\u6548\u679c, \u5f3a\u70c8\u63a8\u8350\u4f7f\u7528ServerManagedPolicy\u4f5c\u4e3a\u4f60\u7684Policy.\n<\/p><p>\u5982\u679c\u4f60\u62c5\u5fc3\u5b58\u5728\u672c\u5730SharedPreferences\u4e2d\u7684\u7b7e\u540d\u54cd\u5e94\u6570\u636e\u7684\u5b89\u5168, \u4f60\u53ef\u4ee5\u4f7f\u7528\u66f4\u5f3a\u5927\u7684\u6df7\u6dc6\u7b97\u6cd5\u6216\u8bbe\u8ba1\u4e00\u4e2a\u66f4\u4e25\u683c\u7684\u4e0d\u5b58\u50a8\u7b7e\u540d\u6570\u636e\u7684Policy. LVL\u5305\u542b\u4e86\u4e00\u4e2a\u8fd9\u6837\u7684\u4f8b\u5b50, \u66f4\u591a\u4fe1\u606f\u89c1StrictPolicy .\n<\/p><p>\u4f7f\u7528ServerManagedPolicy, \u53ea\u8981\u5c06\u5b83\u5bfc\u5165\u5230\u4f60\u7684activity\u4e2d, \u521b\u5efa\u4e00\u4e2a\u5b9e\u4f8b, \u5f53\u521b\u5efaLicenseChecker\u7684\u65f6\u5019\u4f20\u9012\u5b83\u7684\u5f15\u7528\u8fdb\u53bb. \u66f4\u591a\u4fe1\u606f\u89c1Instantiate LicenseChecker and LicenseCheckerCallback\n<\/p><p><br \/>\n<\/p>\n<h3> <span class=\"mw-headline\" id=\"StrictPolicy\">StrictPolicy<\/span><\/h3>\n<p>StrictPolicy\u662fLVL\u63d0\u4f9b\u7684\u53e6\u4e00\u4e2a\u53ef\u9009\u7684Policy\u7684\u5b9e\u73b0\u63a5\u53e3. \u5b83\u63d0\u4f9b\u7684Policy\u6bd4ServerManagedPolicy\u66f4\u4e3a\u4e25\u683c, \u5b83\u4e0d\u5141\u8bb8\u7528\u6237\u8bbf\u95ee\u5e94\u7528\u9664\u975e\u5728\u8bbf\u95ee\u7684\u65f6\u5019\u4ece\u670d\u52a1\u5668\u63a5\u6536\u5230\u6807\u8bc6\u7528\u6237\u53ef\u4ee5\u8bbf\u95ee\u7684\u7b7e\u540d\u54cd\u5e94\u6570\u636e. \n<\/p><p>StrictPolicy\u7684\u4e3b\u8981\u7279\u70b9\u662f\u4e0d\u4f1a\u628a\u4efb\u4f55\u7b7e\u540d\u54cd\u5e94\u6570\u636e\u4ee5\u6301\u4e45\u5316\u65b9\u5f0f\u5b58\u5728\u672c\u5730. \u56e0\u4e3a\u4e0d\u5b58\u50a8\u6570\u636e, \u91cd\u8bd5\u8bf7\u6c42\u4e0d\u4f1a\u88ab\u8bb0\u5f55\u5e76\u4e14\u7f13\u5b58\u7684\u54cd\u5e94\u6570\u636e\u4e0d\u4f1a\u7528\u4e8e\u5b8c\u6210\u7b7e\u540d\u68c0\u67e5. Policy\u5141\u8bb8\u8bbf\u95ee\u53ea\u80fd\u5728\uff1a\n<\/p>\n<ul><li>\u4ece\u670d\u52a1\u5668\u63a5\u6536\u5230\u7b7e\u540d\u54cd\u5e94\u6570\u636e\n<\/li><li>\u5e76\u4e14\u54cd\u5e94\u6570\u636e\u6807\u8bc6\u7528\u6237\u9a8c\u8bc1\u901a\u8fc7\u53ef\u4ee5\u8bbf\u95ee\u5e94\u7528\n<\/li><\/ul>\n<p>\u5982\u679c\u4f60\u6240\u5173\u5fc3\u7684\u662f\u5728\u6240\u6709\u60c5\u51b5\u4e0b, \u6ca1\u6709\u7528\u6237\u53ef\u4ee5\u8bbf\u95ee\u4f60\u7684\u5e94\u7528\u9664\u975e\u7528\u6237\u5728\u4f7f\u7528\u7684\u65f6\u5019\u88ab\u786e\u8ba4\u8ba4\u8bc1\u8fc7\u4e86, \u90a3\u4e48\u4f7f\u7528StrictPolicy\u662f\u6bd4\u8f83\u5408\u9002\u7684. \u6b64\u5916, Policy\u6bd4ServerManagedPolicy\u7a0d\u5fae\u5b89\u5168\u70b9, \u81ea\u4ece\u4e0d\u5728\u672c\u5730\u7f13\u5b58\u6570\u636e\u540e, \u6076\u610f\u7528\u6237\u5c31\u6ca1\u6709\u529e\u6cd5\u7be1\u6539\u672c\u5730\u6570\u636e\u83b7\u53d6\u5e94\u7528\u8bbf\u95ee\u6743\u9650.\n<\/p><p>\u540c\u65f6, Policy\u5bf9\u4e8e\u666e\u901a\u7528\u6237\u6765\u8bf4\u662f\u4e00\u4e2a\u6311\u6218, \u8fd9\u610f\u5473\u7740\u4ed6\u4eec\u5728\u6ca1\u6709\u53ef\u7528\u7f51\u7edc\u7684\u65f6\u5019\u65e0\u6cd5\u4f7f\u7528\u5e94\u7528. \u53e6\u4e00\u4e2a\u526f\u4f5c\u7528\u662f\u81ea\u4ece\u4f60\u7684\u5e94\u7528\u4e0d\u4f7f\u7528\u7f13\u5b58\u540e\u5c06\u4f1a\u53d1\u9001\u66f4\u591a\u7684\u7b7e\u540d\u9a8c\u8bc1\u8bf7\u6c42\u5230\u670d\u52a1\u5668.\n<\/p><p>\u603b\u7684\u6765\u8bf4, \u8fd9\u4e2a\u7b56\u7565\u4ee3\u8868\u4e86\u5728\u67d0\u4e2a\u7a0b\u5ea6\u4e0a\u7684\u7528\u6237\u662f\u7edd\u5bf9\u5b89\u5168\u5e76\u4e14\u53ef\u63a7\u7684. \u6240\u4ee5\u7528Policy\u4e4b\u524d\u8981\u4ed4\u7ec6\u8003\u8651\u4e0b.\n<\/p><p>\u4f7f\u7528StrictPolicy, \u53ea\u8981\u5c06\u5b83\u5bfc\u5165\u5230\u4f60\u7684activity\u4e2d, \u521b\u5efa\u4e00\u4e2a\u5b9e\u4f8b, \u5f53\u521b\u5efaLicenseChecker\u7684\u65f6\u5019\u4f20\u9012\u5b83\u7684\u5f15\u7528\u8fdb\u53bb.\u66f4\u591a\u4fe1\u606f\u89c1Instantiate LicenseChecker and LicenseCheckerCallback.\n<\/p><p><br \/>\n<\/p>\n<h2> <span class=\"mw-headline\" id=\".E5.AE.9E.E7.8E.B0Obfuscator\">\u5b9e\u73b0Obfuscator<\/span><\/h2>\n<p>\u4e00\u4e2a\u5178\u578b\u7684Policy\u5b9e\u73b0\u9700\u8981\u4e3a\u4e00\u4e2a\u5e94\u7528\u4fdd\u5b58\u7b7e\u540d\u54cd\u5e94\u6570\u636e\u5230\u6301\u4e45\u5316\u5b58\u50a8\u5668, \u6240\u4ee5\u5b83\u53ef\u4ee5\u8de8\u5e94\u7528\u8c03\u7528\u5e76\u4e14\u4e0d\u4f1a\u56e0\u4e3a\u8bbe\u5907\u5173\u673a\u800c\u4e22\u5931\u6570\u636e. \u4f8b\u5982, Policy\u53ef\u4ee5\u5728\u6301\u4e45\u6027\u6570\u636e\u5bb9\u5668\u4e2d\u6301\u6709\u7b7e\u540d\u6700\u540e\u4e00\u6b21\u9a8c\u8bc1\u6210\u529f\u7684\u65f6\u95f4\u6233\u3001\u91cd\u8bd5\u6b21\u6570\u3001\u6709\u6548\u671f\u7b49\u7c7b\u4f3c\u7684\u4fe1\u606f, \u800c\u4e0d\u662f\u5728\u5e94\u7528\u6bcf\u6b21\u542f\u52a8\u7684\u65f6\u5019\u91cd\u65b0\u52a0\u8f7d\u8fd9\u4e9b\u6570\u636e. \u9ed8\u8ba4\u7684Policy\u5b9e\u73b0\u5728LVL\u7684ServerManagedPolicy\u4e2d, \u5b83\u4f1a\u628a\u54cd\u5e94\u6570\u636e\u4fdd\u5b58\u5728SharedPreferences\u5b9e\u4f8b\u4e2d,  \u4ee5\u786e\u4fdd\u6570\u636e\u662f\u6301\u4e45\u5316\u7684.\n<\/p><p>\u56e0\u4e3aPolicy\u4f1a\u4f7f\u7528\u4fdd\u5b58\u7684\u6570\u636e\u53bb\u5224\u65ad\u5141\u8bb8\u8fd8\u662f\u4e0d\u5141\u8bb8\u8bbf\u95ee\u5e94\u7528, \u5b83\u5fc5\u987b\u4fdd\u8bc1\u4efb\u4f55\u6570\u636e\u662f\u5b89\u5168\u7684\u5e76\u4e14\u4e0d\u80fd\u91cd\u7528\u6216\u88ab\u62e5\u6709root\u6743\u9650\u7684\u7528\u6237\u63a7\u5236. \u6240\u4ee5Policy\u5fc5\u987b\u8981\u5728\u5b58\u50a8\u4e4b\u524d\u6df7\u6dc6\u6570\u636e, \u5bf9\u6bcf\u4e00\u4e2a\u8bbe\u5907\u4f7f\u7528\u4e00\u4e2a\u552f\u4e00\u7684\u5bc6\u94a5. \u5728\u6307\u5b9a\u7684\u5e94\u7528\u548c\u6307\u5b9a\u7684\u8bbe\u5907\u4e2d\u4f7f\u7528\u5bc6\u94a5\u662f\u5f88\u5173\u952e\u7684, \u56e0\u4e3a\u5b83\u53ef\u4ee5\u9632\u6b62\u5728\u5e94\u7528\u548c\u8bbe\u5907\u4e0a\u5171\u4eab\u6df7\u6dc6\u8fc7\u7684\u6570\u636e.\n<\/p><p>LVL\u5e2e\u52a9\u5e94\u7528\u4ee5\u4e00\u79cd\u5b89\u5168\u3001\u6301\u4e45\u5316\u7684\u65b9\u5f0f\u4fdd\u5b58\u7b7e\u540d\u54cd\u5e94\u6570\u636e. \u9996\u5148, \u5b83\u63d0\u4f9bObfuscator \u63a5\u53e3\u8ba9\u4f60\u7684\u5e94\u7528\u5728\u5b58\u50a8\u6570\u636e\u7684\u65f6\u5019\u53ef\u4ee5\u9009\u62e9\u6df7\u6dc6\u7b97\u6cd5. \u5728\u8fd9\u4e2a\u57fa\u7840\u4e0a, LVL\u63d0\u4f9b\u4e86\u5e2e\u52a9\u7c7bPreferenceObfuscator, \u8d1f\u8d23\u8c03\u7528\u5e94\u7528\u7684Obfuscator \u7c7b, \u5e76\u4e14\u8bfb\u5199SharedPreferences \u5b9e\u4f8b\u4e2d\u6df7\u6dc6\u7684\u6570\u636e.\n<\/p><p>LVL\u63d0\u4f9b\u4e86Obfuscator \u7684\u5b8c\u6574\u5b9e\u73b0\u7c7b\u2014\u2014AESObfuscator, \u4f7f\u7528AES\u52a0\u5bc6\u6280\u672f\u6df7\u6dc6\u6570\u636e. \u4f60\u53ef\u4ee5\u76f4\u63a5\u5728\u4f60\u7684\u5e94\u7528\u4e2d\u4f7f\u7528AESObfuscator\u6216\u8005\u4fee\u6539\u5b83\u4ee5\u9002\u5e94\u4f60\u7684\u9700\u6c42. \u66f4\u591a\u4fe1\u606f\u89c1\u4e00\u4e0b\u7ae0\u8282.\n<\/p><p><br \/>\n<\/p>\n<h3> <span class=\"mw-headline\" id=\"AESObfuscator\">AESObfuscator<\/span><\/h3>\n<p>AESObfuscator\u662fLVL\u63d0\u4f9b\u7684\u5e76\u63a8\u8350\u7684Obfuscator \u7684\u5b9e\u73b0\u63a5\u53e3. \u8be5\u5b9e\u73b0\u5df2\u7ecf\u96c6\u6210\u5728LVL\u7684\u793a\u4f8b\u5e94\u7528\u4e2d\u5e76\u4e14\u5728lib\u5e93\u4e2d\u4f5c\u4e3a\u9ed8\u8ba4\u7684Obfuscator .\n<\/p><p>AESObfuscator\u63d0\u4f9b\u5b89\u5168\u6df7\u6dc6\u5b9e\u73b0\u662f\u5728\u4ece\u6570\u636e\u5b58\u50a8\u5668\u4e2d\u8bfb\u5199\u6570\u636e\u7684\u65f6\u5019\u901a\u8fc7AES\u52a0\u5bc6\u6216\u89e3\u5bc6\u5b9e\u73b0\u7684. Obfuscator \u79cd\u5b50\u52a0\u5bc6\u8981\u7528\u5230\u5e94\u7528\u63d0\u4f9b\u7684\u4e09\u4e2a\u6570\u636e\u5b57\u6bb5: \n<\/p><p>1.\tsalt  \u2013 \u4e00\u4e2a\u968f\u673a\u7684\u5b57\u8282(byte)\u6570\u7ec4\u7528\u4e8e\u6bcf\u4e00\u4e2a(\u5355\u4f4d)\u7684\u6df7\u6dc6\n<\/p><p>2.\t\u5e94\u7528\u7684\u5b57\u7b26\u6807\u8bc6, \u4ee3\u8868\u7740\u5e94\u7528\u7684\u5305\u540d\n<\/p><p>3.\t\u8bbe\u5907\u7684\u5b57\u7b26\u6807\u8bc6, \u5c3d\u53ef\u80fd\u6765\u81ea\u6307\u5b9a\u7684\u8bbe\u5907\u7684\u6e90\u6570\u636e, \u4ee5\u4fbf\u4e8e\u662f\u552f\u4e00\u503c\n<\/p><p>\u4f7f\u7528AESObfuscator, \u9996\u5148\u8981\u5bfc\u5165\u5230\u4f60\u7684activity. \u5b9a\u4e49\u4e00\u4e2a\u79c1\u6709\u9759\u6001\u7684\u5e38\u91cf\u6570\u7ec4(private static final array)\u7528\u6765\u4fdd\u5b58salt\u5b57\u8282\u5e76\u521d\u59cb\u5316\u751f\u621020\u4e2a\u968f\u673a\u5b57\u8282. \n<\/p>\n<pre class=\"java\">&#160;\n        ...\n    <span style=\"color: #808080; font-style: italic;\">\/\/ Generate 20 random bytes, and put them here.<\/span>\n    <span style=\"color: #000000; font-weight: bold;\">private<\/span> <span style=\"color: #000000; font-weight: bold;\">static<\/span> <span style=\"color: #000000; font-weight: bold;\">final<\/span> <span style=\"color: #993333;\">byte<\/span><span style=\"color: #66cc66;\">&#91;<\/span><span style=\"color: #66cc66;\">&#93;<\/span> SALT = <span style=\"color: #000000; font-weight: bold;\">new<\/span> <span style=\"color: #993333;\">byte<\/span><span style=\"color: #66cc66;\">&#91;<\/span><span style=\"color: #66cc66;\">&#93;<\/span> <span style=\"color: #66cc66;\">&#123;<\/span>\n     <span style=\"color: #cc66cc;\">-46<\/span>, <span style=\"color: #cc66cc;\">65<\/span>, <span style=\"color: #cc66cc;\">30<\/span>, <span style=\"color: #cc66cc;\">-128<\/span>, <span style=\"color: #cc66cc;\">-103<\/span>, <span style=\"color: #cc66cc;\">-57<\/span>, <span style=\"color: #cc66cc;\">74<\/span>, <span style=\"color: #cc66cc;\">-64<\/span>, <span style=\"color: #cc66cc;\">51<\/span>, <span style=\"color: #cc66cc;\">88<\/span>, <span style=\"color: #cc66cc;\">-95<\/span>,\n     <span style=\"color: #cc66cc;\">-45<\/span>, <span style=\"color: #cc66cc;\">77<\/span>, <span style=\"color: #cc66cc;\">-117<\/span>, <span style=\"color: #cc66cc;\">-36<\/span>, <span style=\"color: #cc66cc;\">-113<\/span>, <span style=\"color: #cc66cc;\">-11<\/span>, <span style=\"color: #cc66cc;\">32<\/span>, <span style=\"color: #cc66cc;\">-64<\/span>, <span style=\"color: #cc66cc;\">89<\/span>\n     <span style=\"color: #66cc66;\">&#125;<\/span>;\n    ...\n&#160;<\/pre>\n<p>\u63a5\u4e0b\u6765, \u5b9a\u4e49\u4e00\u4e2a\u4efb\u4f55\u5730\u65b9\u90fd\u53ef\u4ee5\u4f7f\u7528\u7684\u53d8\u91cf\u4fdd\u5b58\u8bbe\u5907\u7684\u6807\u8bc6\u7b26\u5e76\u6307\u5b9a\u4e00\u4e2a\u503c. \u4f8b\u5982, \u5728LVL\u7684\u4f8b\u5b50\u4e2d\u67e5\u8be2\u7cfb\u7edf\u8bbe\u7f6e\u662f\u4f7f\u7528android.Settings.Secure.ANDROID_ID, \u8fd9\u4e2a\u503c\u5bf9\u4e8e\u6bcf\u4e00\u4e2a\u8bbe\u5907\u6765\u8bf4\u90fd\u662f\u552f\u4e00\u7684.\n<\/p><p>\u6ce8\u610f, \u6839\u636e\u4f60\u4f7f\u7528\u7684API, \u4f60\u7684\u5e94\u7528\u53ef\u80fd\u9700\u8981\u6dfb\u52a0\u8bbf\u95ee\u7cfb\u7edf\u7279\u5b9a\u4fe1\u606f\u7684\u6743\u9650. \u4f8b\u5982, \u67e5\u8be2TelephonyManager\u83b7\u53d6\u8bbe\u5907\u7684IMEI\u7801\u6216\u76f8\u5173\u6570\u636e, \u4f60\u7684\u5e94\u7528\u5c31\u9700\u8981\u5728manifest\u91cc\u6dfb\u52a0\u6743\u9650android.permission.READ_PHONE_STATE\n<\/p><p>\u8bf7\u6c42\u65b0\u6743\u9650\u552f\u4e00\u7684\u76ee\u7684\u5c31\u662f\u4e3a\u4e86\u83b7\u53d6\u7279\u5b9a\u8bbe\u5907\u7684\u4fe1\u606f\u7528\u4e8e\u4f60\u7684Obfuscator, \u8003\u8651\u505a\u53ef\u80fd\u4f1a\u5f71\u54cd\u4f60\u7684\u5e94\u7528\u6216\u5728Google Play\u4e0a\u88ab\u8fc7\u6ee4(\u56e0\u4e3a\u6709\u4e9b\u6743\u9650\u53ef\u80fd\u5f15\u8d77SDK\u6784\u5efa\u5de5\u5177\u6dfb\u52a0\u5173\u8054\u7684&lt;uses-feature&gt;)\n<\/p><p>\u6700\u540e, \u6784\u5efaAESObfuscator\u5b9e\u4f8b, \u4f20\u5165\u53c2\u6570salt\u3001\u5e94\u7528\u6807\u8bc6\u7b26\u3001\u8bbe\u5907\u6807\u8bc6\u7b26. \u4f60\u53ef\u4ee5\u5728\u6784\u5efaPolicy \u548cLicenseChecker \u7684\u65f6\u5019\u76f4\u63a5\u521b\u5efa. \u4f8b\u5982: \n<\/p>\n<pre class=\"java\">&#160;\n...\n    <span style=\"color: #808080; font-style: italic;\">\/\/ Construct the LicenseChecker with a Policy.<\/span>\n    mChecker = <span style=\"color: #000000; font-weight: bold;\">new<\/span> LicenseChecker<span style=\"color: #66cc66;\">&#40;<\/span>\n        <span style=\"color: #000000; font-weight: bold;\">this<\/span>, <span style=\"color: #000000; font-weight: bold;\">new<\/span> ServerManagedPolicy<span style=\"color: #66cc66;\">&#40;<\/span><span style=\"color: #000000; font-weight: bold;\">this<\/span>,\n            <span style=\"color: #000000; font-weight: bold;\">new<\/span> AESObfuscator<span style=\"color: #66cc66;\">&#40;<\/span>SALT, getPackageName<span style=\"color: #66cc66;\">&#40;<\/span><span style=\"color: #66cc66;\">&#41;<\/span>, deviceId<span style=\"color: #66cc66;\">&#41;<\/span><span style=\"color: #66cc66;\">&#41;<\/span>,\n        BASE64_PUBLIC_KEY  <span style=\"color: #808080; font-style: italic;\">\/\/ Your public licensing key.<\/span>\n        <span style=\"color: #66cc66;\">&#41;<\/span>;\n    ...\n&#160;<\/pre>\n<p>\u5b8c\u6574\u7684\u4f8b\u5b50\u89c1LVL\u793a\u4f8b\u4ee3\u7801\u7684MainActivity.\n<\/p><p><br \/>\n<\/p>\n<h2> <span class=\"mw-headline\" id=\".E5.9C.A8Activity.E4.B8.AD.E6.A3.80.E6.9F.A5.E7.AD.BE.E5.90.8D\">\u5728Activity\u4e2d\u68c0\u67e5\u7b7e\u540d<\/span><\/h2>\n<p>\u5f53\u4f60\u5b9e\u73b0\u4e86Policy\u7ba1\u7406\u4f60\u5e94\u7528\u7684\u8bbf\u95ee, \u4e0b\u4e00\u6b65\u5c31\u662f\u589e\u52a0\u7b7e\u540d\u8ba4\u8bc1\u5230\u4f60\u7684\u5e94\u7528, \u521b\u5efa\u4e00\u4e2a\u9a8c\u8bc1\u8bf7\u6c42\u5230\u670d\u52a1\u5668\u5982\u679c\u9700\u8981\u57fa\u4e8e\u54cd\u5e94\u7ed3\u679c\u7ba1\u7406\u4f60\u5e94\u7528\u7684\u8bbf\u95ee. \u6240\u6709\u589e\u52a0\u7b7e\u540d\u68c0\u67e5\u548c\u5904\u7406\u54cd\u5e94\u7ed3\u679c\u7684\u5de5\u4f5c\u90fd\u5728\u4f60\u7684main Activity\u91cc. \n<\/p><p>\u589e\u52a0\u7b7e\u540d\u68c0\u67e5\u548c\u5904\u7406\u54cd\u5e94\u7ed3\u679c, \u4f60\u5fc5\u987b: \n<\/p><p>1.\t\u5bfc\u5165\n<\/p><p>2.\t\u4ee5\u5185\u90e8\u7c7b\u7684\u65b9\u5f0f\u5b9e\u73b0LicenseCheckerCallback\n<\/p><p>3.\t\u521b\u5efa\u4e00\u4e2a\u4eceLicenseCheckerCallback \u5230UI\u7ebf\u7a0b\u7684Handler \n<\/p><p>4.\t\u5b9e\u4f8b\u5316LicenseChecker\u548cLicenseCheckerCallback\n<\/p><p>5.\t\u8c03\u7528checkAccess()\u521d\u59cb\u5316\u7b7e\u540d\u68c0\u67e5\n<\/p><p>6.\t\u7ed9\u7b7e\u540d\u8ba4\u8bc1\u690d\u5165\u4f60\u7684\u516c\u94a5\n<\/p><p>7.\t\u5173\u95edIPC\u8fde\u63a5\u7684\u65f6\u5019\u8c03\u7528LicenseChecker\u7684onDestory()\n<\/p><p>\u4e0b\u9762\u63cf\u8ff0\u4e86\u8fd9\u4e9b\u6b65\u9aa4.\n<\/p><p><br \/>\n<\/p>\n<h3> <span class=\"mw-headline\" id=\".E7.AD.BE.E5.90.8D.E6.A3.80.E6.9F.A5.E5.92.8C.E5.93.8D.E5.BA.94.E7.9A.84.E6.8F.8F.E8.BF.B0\">\u7b7e\u540d\u68c0\u67e5\u548c\u54cd\u5e94\u7684\u63cf\u8ff0<\/span><\/h3>\n<p>\u5728\u5927\u90e8\u5206\u60c5\u51b5\u4e0b, \u4f60\u5e94\u8be5\u628a\u7b7e\u540d\u68c0\u67e5\u7684\u5de5\u4f5c\u653e\u5728\u4f60\u5e94\u7528\u7684main Activity\u7684onCreate()\u4e2d. \u8fd9\u53ef\u4ee5\u786e\u4fdd\u7528\u6237\u4e00\u52a0\u8f7d\u4f60\u7684\u5e94\u7528\u9a6c\u4e0a\u5c31\u4f1a\u8fdb\u884c\u7b7e\u540d\u68c0\u67e5. \u6709\u4e9b\u65f6\u5019, \u4f60\u4e5f\u53ef\u4ee5\u628a\u7b7e\u540d\u68c0\u67e5\u653e\u5728\u5176\u4ed6\u4f4d\u7f6e. \u4f8b\u5982, \u5982\u679c\u4f60\u7684\u5e94\u7528\u5305\u542b\u4e86\u591a\u4e2a\u53ef\u4ee5\u901a\u8fc7\u5176\u4ed6Intent\u542f\u52a8\u7684Activity\u7684\u6a21\u5757, \u4f60\u53ef\u4ee5\u628a\u7b7e\u540d\u68c0\u67e5\u653e\u5728\u8fd9\u5199Activity\u91cc\u9762.\n<\/p><p>\u7b7e\u540d\u68c0\u67e5\u4e3b\u8981\u5305\u542b\u4e24\u4e2a\u6b65\u9aa4: \n\u4e00\u4e2a\u542f\u52a8\u7b7e\u540d\u68c0\u67e5\u7684\u65b9\u6cd5\u2014\u2014\u5728LVL\u91cc, \u8fd9\u662f\u4f60\u5b9e\u73b0\u7684LicenseCheckerCallback\u63a5\u53e3. \u8fd9\u4e2a\u63a5\u53e3\u5b9a\u4e49\u4e86\u4e24\u4e2a\u65b9\u6cd5, allow() \u548c dontAllow(), \u5b83\u4eec\u90fd\u4f1a\u88ablib\u5e93\u6839\u636e\u7b7e\u540d\u68c0\u67e5\u7684\u7ed3\u679c\u89e6\u53d1. \u4f60\u53ef\u4ee5\u6839\u636e\u4f60\u7684\u9700\u6c42\u5b9e\u73b0\u4efb\u4f55\u903b\u8f91, \u5141\u8bb8\u6216\u4e0d\u5141\u8bb8\u7528\u6237\u8bbf\u95ee\u4f60\u7684\u5e94\u7528. \u6ce8\u610f, \u8fd9\u4e24\u4e2a\u65b9\u6cd5\u4e0d\u786e\u5b9a\u662f\u5426\u5141\u8bb8\u8bbf\u95ee\u2014\u2014\u8fd9\u4e2a\u7531\u4f60\u5b9e\u73b0\u7684Policy\u6765\u51b3\u5b9a. \u5f53\u7136, \u8fd9\u4e9b\u65b9\u6cd5\u7b80\u5355\u7684\u63d0\u4f9b\u4e86\u5e94\u7528\u7684\u884c\u4e3a, \u600e\u4e48\u5141\u8bb8\u548c\u7981\u6b62(\u6216\u5904\u7406\u5e94\u7528\u7684\u9519\u8bef).\n<\/p><p>allow()\u548cdontAllow()\u65b9\u6cd5\u63d0\u4f9b\u4e86\u5b83\u4eec\u54cd\u5e94\u7ed3\u679c\u7684\u201c\u7406\u7531\u201d(reason), \u8fd9\u4e2a\u662fPolicy\u4e2d\u7684\u4e00\u4e2a\u503c, LICENSED, NOT_LICENSED, or RETRY. \u9700\u8981\u63d0\u51fa\u6765\u7684\u662f, \u4f60\u5e94\u8be5\u5728dontAllow()\u4e2d\u5904\u7406\u63a5\u6536\u5230RETRY\u7684\u60c5\u51b5\u5e76\u4e14\u63d0\u4f9b\u4e00\u4e2a\u201c\u91cd\u8bd5\u201d\u7684\u6309\u94ae\u7ed9\u7528\u6237, \u8fd9\u53ef\u80fd\u4f1a\u56e0\u4e3a\u670d\u52a1\u5728\u8bf7\u6c42\u9636\u6bb5\u4e0d\u53ef\u7528\u800c\u53d1\u751f.\n<\/p><p><img src=\"http:\/\/docs.eoeandroid.com\/images\/licensing_flow.png\" alt=\"licensing_flow.png\" \/>\n<\/p><p>\u56fe6 \u7b7e\u540d\u68c0\u67e5\u7684\u6d41\u7a0b\u56fe\n<\/p><p>\u4e0a\u9762\u7684\u56fe\u8868\u8bf4\u660e\u4e86\u7b7e\u540d\u68c0\u67e5\u53d1\u751f\u7684\u8fc7\u7a0b: \n<\/p><p>1.\t\u5728\u5e94\u7528main Activity\u91cc\u5b9e\u4f8b\u5316LicenseCheckerCallback\u548cLicenseChecker\u7b49\u5bf9\u8c61. \u5f53\u6784\u9020LicenseChecker\u7684\u65f6\u5019, \u9700\u8981\u4f20\u5165Context\u3001Policy\u7684\u5b9e\u73b0\u7c7b\u3001\u5f00\u53d1\u8005\u8d26\u53f7\u7684\u516c\u94a5\u4f5c\u4e3a\u7b7e\u540d\u68c0\u67e5\u7684\u53c2\u6570. \n<\/p><p>2.\t\u7136\u540e\u5728LicenseChecker\u5bf9\u8c61\u91cc\u8c03\u7528checkAccess(). \u65b9\u6cd5\u7684\u5b9e\u73b0\u8c03\u7528Policy\u5224\u65adSharedPreferences\u91cc\u662f\u5426\u6709\u6709\u6548\u7684\u7b7e\u540d\u54cd\u5e94\u6570\u636e. \n<\/p>\n<dl><dd><ul><li>\u5982\u679c\u6709, checkAccess()\u8c03\u7528allow()\n<\/li><li>\u5426\u5219, LicenseChecker\u4f1a\u521d\u59cb\u5316\u4e00\u4e2a\u7b7e\u540d\u8ba4\u8bc1\u8bf7\u6c42\u53d1\u9001\u5230\u7b7e\u540d\u8ba4\u8bc1\u670d\u52a1\u5668\n<\/li><\/ul>\n<\/dd><\/dl>\n<div style=\"margin: 1em 0; padding: 10px; overflow: auto; background: #F7F7F7; border-left:4px solid; border-color:#258AAF;\">\n<p>\u6ce8\u610f:\u7b7e\u540d\u8ba4\u8bc1\u670d\u52a1\u5668\u603b\u662f\u4f1a\u8fd4\u56deLICENSED \u5f53\u4f60\u6267\u884c\u4e00\u4e2a\u6d4b\u8bd5\u5e94\u7528\u7684\u7b7e\u540d\u68c0\u67e5\u65f6\n<\/p>\n<\/div>\n<p>3.\t\u63a5\u6536\u5230\u54cd\u5e94\u6570\u636e\u7684\u65f6\u5019, LicenseChecker\u4f1a\u521b\u5efa\u4e00\u4e2aLicenseValidator\u68c0\u67e5\u7b7e\u540d\u7684\u7b7e\u540d\u5e76\u63d0\u53d6\u54cd\u5e94\u6570\u636e\u4e2d\u7684\u5b57\u6bb5, \u7136\u540e\u628a\u5b83\u4eec\u4f20\u8fdb\u4f60\u7684Policy\u505a\u8fdb\u4e00\u6b65\u7684\u64cd\u4f5c.\n<\/p>\n<dl><dd><ul><li>\u5982\u679c\u7b7e\u540d\u6709\u6548, Policy\u4f1a\u7f13\u5b58\u54cd\u5e94\u7ed3\u679c\u5230SharedPreferences\u5e76\u901a\u77e5LicenseValidator\u7b49\u4e0b\u8c03\u7528LicenseCheckerCallback\u5bf9\u8c61\u91cc\u7684allow()\n<\/li><\/ul>\n<\/dd><\/dl>\n<dl><dd><ul><li>\u5982\u679c\u7b7e\u540d\u65e0\u6548, Policy\u4f1a\u901a\u77e5LicenseValidator\u8c03\u7528LicenseCheckerCallback\u91cc\u7684dontallow()\n<\/li><\/ul>\n<\/dd><\/dl>\n<p>4.\t\u5982\u679c\u53d1\u751f\u53ef\u6062\u590d\u7684\u672c\u5730\u6216\u8005\u670d\u52a1\u5668\u9519\u8bef, \u4f8b\u5982\u5f53\u524d\u7f51\u7edc\u65e0\u6cd5\u53d1\u9001\u8bf7\u6c42, LicenseChecker\u4f1a\u4f20\u9012RETRY\u4e3a\u54cd\u5e94\u7ed3\u679c\u5230Policy\u7684processServerResponse(). \u5e76\u4e14allow()\u548cdontAllow()\u4e5f\u4f1a\u63a5\u6536\u4e00\u4e2areason\u53c2\u6570. allow()\u7684reason\u503c\u4e00\u822c\u662fPolicy.LICENSED \u6216Policy.RETRY, dontAllow()\u7684reason\u503c\u4e00\u822c\u662fPolicy. Policy.LICENSED \u6216Policy.RETRY\u6216Policy.RETRY. \u5982\u679c\u4f60\u60f3\u7ed9\u7528\u6237\u663e\u793a\u4e00\u4e2a\u54cd\u5e94\u503c, \u90a3\u4e48\u8fd9\u4e9b\u503c\u662f\u975e\u5e38\u6709\u7528\u7684, \u4f8b\u5982\u63d0\u4f9b\u4e00\u4e2a\u201d\u91cd\u8bd5\u201d\u7684\u6309\u94ae\u5f53dontAllow()\u54cd\u5e94Policy.RETRY, \u8fd9\u53ef\u80fd\u662f\u7531\u4e8e\u670d\u52a1\u4e0d\u53ef\u7528\n<\/p><p>5.\t\u5982\u679c\u5e94\u7528\u51fa\u73b0\u9519\u8bef, \u4f8b\u5982\u5e94\u7528\u5c1d\u8bd5\u4ee5\u4e00\u4e2a\u65e0\u6548\u7684\u5305\u540d\u53bb\u68c0\u67e5\u7b7e\u540d\u65f6\u5019, LicenseChecker\u4f20\u9012\u4e00\u4e2a\u9519\u8bef\u7684\u54cd\u5e94\u7ed3\u679c\u5230LicenseCheckerCallback\u7684applicationError()\u4e2d\n<\/p><p><br \/>\n\u6ce8\u610f, \u9664\u4e86\u5728\u542f\u52a8\u7684\u65f6\u5019\u8fdb\u884c\u7b7e\u540d\u68c0\u67e5\u5e76\u5904\u7406\u7ed3\u679c, \u4f60\u7684\u5e94\u7528\u4e5f\u9700\u8981\u63d0\u4f9bPolicy\u7684\u5b9e\u73b0, \u5982\u679cPolicy\u4fdd\u5b58\u54cd\u5e94\u7ed3\u679c(\u4f8b\u5982ServerManagedPolicy), \u4e00\u4e2aObfuscator \u7684\u5b9e\u73b0.\n<\/p><p><br \/>\n<\/p>\n<h3> <span class=\"mw-headline\" id=\".E5.AF.BC.E5.85.A5\">\u5bfc\u5165<\/span><\/h3>\n<p>\u9996\u5148, \u6253\u5f00\u5e94\u7528\u7684main Activity\u6587\u4ef6, \u4eceLVL\u7684\u5305\u4e2d\u5bfc\u5165LicenseChecker\u548cLicenseCheckerCallback.\n<\/p>\n<pre>\n    import com.android.vending.licensing.LicenseChecker;     import com.android.vending.licensing.LicenseCheckerCallback;\n<\/pre>\n<p>\u5982\u679c\u4f60\u9700\u8981\u7528LVL\u63d0\u4f9b\u7684\u9ed8\u8ba4Policy\u5b9e\u73b0ServerManagedPolicy, \u4e5f\u5bfc\u5165\u5b83, \u540c\u65f6\u5bfc\u5165AESObfuscator. \u5982\u679c\u4f7f\u7528\u81ea\u5b9a\u4e49\u7684Policy\u548cObfuscator\u5c31\u4e0d\u8981\u4e86.\n<\/p>\n<pre>\n    import com.android.vending.licensing.ServerManagedPolicy;     import com.android.vending.licensing.AESObfuscator;\n<\/pre>\n<h3> <span class=\"mw-headline\" id=\".E4.BB.A5.E5.86.85.E9.83.A8.E7.B1.BB.E7.9A.84.E6.96.B9.E5.BC.8F.E5.AE.9E.E7.8E.B0LicenseCheckerCallback\">\u4ee5\u5185\u90e8\u7c7b\u7684\u65b9\u5f0f\u5b9e\u73b0LicenseCheckerCallback<\/span><\/h3>\n<p>LicenseCheckerCallback\u662fLVL\u63d0\u4f9b\u7684\u5904\u7406\u7b7e\u540d\u68c0\u67e5\u7ed3\u679c\u7684\u63a5\u53e3. \u4f7f\u7528LVL\u8fdb\u884c\u7b7e\u540d\u68c0\u67e5, \u5fc5\u987b\u5b9e\u73b0LicenseCheckerCallback\u548c\u5b83\u7684\u65b9\u6cd5\u5141\u8bb8\u6216\u8005\u4e0d\u5141\u8bb8\u8bbf\u95ee\u5e94\u7528.\n<\/p><p>\u7b7e\u540d\u7684\u68c0\u67e5\u7ed3\u679c\u603b\u662f\u4f1a\u8c03\u7528LicenseCheckerCallback\u4e2d\u7684\u4e00\u4e2a\u65b9\u6cd5, \u57fa\u4e8e\u54cd\u5e94\u7ed3\u679c\u7684\u9a8c\u8bc1, \u670d\u52a1\u5668\u9a8c\u8bc1\u7801\u7684\u672c\u8eab, \u548c\u4efb\u4f55\u4f60\u7684Policy\u63d0\u4f9b\u7684\u989d\u5916\u7684\u5904\u7406. \u4f60\u7684\u5e94\u7528\u53ef\u4ee5\u5728\u4efb\u4f55\u9700\u8981\u7684\u5730\u65b9\u5b9e\u73b0\u65b9\u6cd5. \u4e00\u822c\u6700\u597d\u4fdd\u6301\u65b9\u6cd5\u7b80\u5355, \u9650\u5236\u5b83\u4eec\u7ba1\u7406UI\u72b6\u6001\u548c\u5e94\u7528\u7684\u8bbf\u95ee. \u5982\u679c\u4f60\u60f3\u5bf9\u7b7e\u540d\u54cd\u5e94\u7ed3\u679c\u8fdb\u884c\u8fdb\u4e00\u6b65\u5904\u7406, \u4f8b\u5982\u8fde\u63a5\u540e\u7aef\u670d\u52a1\u5668\u6216\u4f7f\u7528\u81ea\u5b9a\u4e49\u7684\u7ea6\u675f, \u4f60\u5e94\u8be5\u8003\u8651\u628a\u4f60\u7684\u4ee3\u7801\u5408\u5e76\u5230Policy, \u800c\u4e0d\u662f\u628a\u5b83\u4eec\u653e\u5728LicenseCheckerCallback\u7684\u65b9\u6cd5\u91cc. \n<\/p><p>\u5728\u5927\u591a\u6570\u60c5\u51b5\u4e0b, \u4f60\u5e94\u8be5\u628aLicenseCheckerCallback\u7684\u5b9e\u73b0\u4f5c\u4e3a\u4e00\u4e2a\u5185\u90e8\u7c7b\u5b9a\u4e49\u5728\u4f60\u7684main Activity\u4e2d. \n<\/p><p>\u6839\u636e\u9700\u8981\u5b9e\u73b0allow()\u548cdontAllow(). \u9996\u5148, \u4f60\u53ef\u4ee5\u5728\u65b9\u6cd5\u91cc\u53ea\u8fdb\u884c\u7b80\u5355\u7684\u7ed3\u679c\u5904\u7406, \u4f8b\u5982\u5728\u5bf9\u8bdd\u6846\u91cc\u663e\u793a\u7b7e\u540d\u7684\u68c0\u67e5\u7ed3\u679c. \u8fd9\u53ef\u4ee5\u5e2e\u52a9\u4f60\u66f4\u5feb\u7684\u8fd0\u884c\u4f60\u7684\u5e94\u7528\u800c\u4e14\u6709\u5229\u4e8e\u8c03\u8bd5. \u7136\u540e, \u5f53\u4f60\u51b3\u5b9a\u4f60\u60f3\u8981\u5176\u4ed6\u7684\u884c\u4e3a\u4e4b\u540e\u5c31\u53ef\u4ee5\u6dfb\u52a0\u66f4\u590d\u6742\u5904\u7406.\n<\/p><p>\u8fd9\u91cc\u662f\u4e00\u4e9b\u5728dontAllow()\u91cc\u5904\u7406\u6ca1\u6709\u9a8c\u8bc1\u7ed3\u679c\u7684\u5efa\u8bae:\n<\/p>\n<ul><li>\u5982\u679creason\u662fPolicy.RETRY, \u663e\u793a\u4e00\u4e2a\u201d\u91cd\u8bd5\u201d\u7684\u5bf9\u8bdd\u6846\u7ed9\u7528\u6237, \u5305\u542b\u4e00\u4e2a\u6309\u94ae\u53ef\u4ee5\u521b\u5efa\u4e00\u4e2a\u65b0\u7684\u7b7e\u540d\u8ba4\u8bc1\u8bf7\u6c42\n<\/li><\/ul>\n<ul><li>\u663e\u793a\u201d\u8d2d\u4e70\u8fd9\u4e2a\u5e94\u7528\u201d\u7684\u5bf9\u8bdd\u6846, \u5305\u542b\u4e00\u4e2a\u6309\u94ae\u53ef\u4ee5\u5f15\u5bfc\u7528\u6237\u5230Google Play\u4e0a\u53ef\u4ee5\u8d2d\u4e70\u8fd9\u4e2a\u5e94\u7528\u7684\u8be6\u60c5\u9875. \u6709\u5173\u4e8e\u8bbe\u7f6e\u8fd9\u79cd\u94fe\u63a5\u7684\u7684\u4fe1\u606f, \u89c1 Linking to Your Products\n<\/li><\/ul>\n<ul><li>\u663e\u793a\u4e00\u4e2aToast\u901a\u77e5\u8868\u660e\u8fd9\u4e2a\u5e94\u7528\u662f\u6709\u9650\u7684, \u56e0\u4e3a\u5b83\u6ca1\u6709\u8ba4\u8bc1\u901a\u8fc7\n<\/li><\/ul>\n<p><br \/>\n\u4e0b\u9762\u662fLVL\u4e2d\u5b9e\u73b0LicenseCheckerCallback\u7684\u4f8b\u5b50, \u5728\u65b9\u6cd5\u4e2d\u4f7f\u7528\u5bf9\u8bdd\u6846\u663e\u793a\u7b7e\u540d\u68c0\u67e5\u7ed3\u679c.\n<\/p>\n<pre class=\"java\">&#160;\n<span style=\"color: #000000; font-weight: bold;\">private<\/span> <span style=\"color: #000000; font-weight: bold;\">class<\/span> MyLicenseCheckerCallback <span style=\"color: #000000; font-weight: bold;\">implements<\/span> LicenseCheckerCallback <span style=\"color: #66cc66;\">&#123;<\/span>\n    <span style=\"color: #000000; font-weight: bold;\">public<\/span> <span style=\"color: #993333;\">void<\/span> allow<span style=\"color: #66cc66;\">&#40;<\/span><span style=\"color: #993333;\">int<\/span> reason<span style=\"color: #66cc66;\">&#41;<\/span> <span style=\"color: #66cc66;\">&#123;<\/span>\n        <span style=\"color: #b1b100;\">if<\/span> <span style=\"color: #66cc66;\">&#40;<\/span>isFinishing<span style=\"color: #66cc66;\">&#40;<\/span><span style=\"color: #66cc66;\">&#41;<\/span><span style=\"color: #66cc66;\">&#41;<\/span> <span style=\"color: #66cc66;\">&#123;<\/span>\n            <span style=\"color: #808080; font-style: italic;\">\/\/ Don't update UI if Activity is finishing.<\/span>\n            <span style=\"color: #000000; font-weight: bold;\">return<\/span>;\n        <span style=\"color: #66cc66;\">&#125;<\/span>\n        <span style=\"color: #808080; font-style: italic;\">\/\/ Should allow user access.<\/span>\n        displayResult<span style=\"color: #66cc66;\">&#40;<\/span>getString<span style=\"color: #66cc66;\">&#40;<\/span>R.<span style=\"color: #006600;\">string<\/span>.<span style=\"color: #006600;\">allow<\/span><span style=\"color: #66cc66;\">&#41;<\/span><span style=\"color: #66cc66;\">&#41;<\/span>;\n    <span style=\"color: #66cc66;\">&#125;<\/span>\n&#160;\n    <span style=\"color: #000000; font-weight: bold;\">public<\/span> <span style=\"color: #993333;\">void<\/span> dontAllow<span style=\"color: #66cc66;\">&#40;<\/span><span style=\"color: #993333;\">int<\/span> reason<span style=\"color: #66cc66;\">&#41;<\/span> <span style=\"color: #66cc66;\">&#123;<\/span>\n        <span style=\"color: #b1b100;\">if<\/span> <span style=\"color: #66cc66;\">&#40;<\/span>isFinishing<span style=\"color: #66cc66;\">&#40;<\/span><span style=\"color: #66cc66;\">&#41;<\/span><span style=\"color: #66cc66;\">&#41;<\/span> <span style=\"color: #66cc66;\">&#123;<\/span>\n            <span style=\"color: #808080; font-style: italic;\">\/\/ Don't update UI if Activity is finishing.<\/span>\n            <span style=\"color: #000000; font-weight: bold;\">return<\/span>;\n        <span style=\"color: #66cc66;\">&#125;<\/span>\n        displayResult<span style=\"color: #66cc66;\">&#40;<\/span>getString<span style=\"color: #66cc66;\">&#40;<\/span>R.<span style=\"color: #006600;\">string<\/span>.<span style=\"color: #006600;\">dont_allow<\/span><span style=\"color: #66cc66;\">&#41;<\/span><span style=\"color: #66cc66;\">&#41;<\/span>;\n&#160;\n        <span style=\"color: #b1b100;\">if<\/span> <span style=\"color: #66cc66;\">&#40;<\/span>reason == <a href=\"http:\/\/www.google.com\/search?hl=en&amp;q=allinurl%3APolicy+java.sun.com&amp;btnI=I%27m%20Feeling%20Lucky\"><span style=\"color: #aaaadd; font-weight: bold;\">Policy<\/span><\/a>.<span style=\"color: #006600;\">RETRY<\/span><span style=\"color: #66cc66;\">&#41;<\/span> <span style=\"color: #66cc66;\">&#123;<\/span>\n            <span style=\"color: #808080; font-style: italic;\">\/\/ If the reason received from the policy is RETRY, it was probably<\/span>\n            <span style=\"color: #808080; font-style: italic;\">\/\/ due to a loss of connection with the service, so we should give the<\/span>\n            <span style=\"color: #808080; font-style: italic;\">\/\/ user a chance to retry. So show a dialog to retry.<\/span>\n            showDialog<span style=\"color: #66cc66;\">&#40;<\/span>DIALOG_RETRY<span style=\"color: #66cc66;\">&#41;<\/span>;\n        <span style=\"color: #66cc66;\">&#125;<\/span> <span style=\"color: #b1b100;\">else<\/span> <span style=\"color: #66cc66;\">&#123;<\/span>\n            <span style=\"color: #808080; font-style: italic;\">\/\/ Otherwise, the user is not licensed to use this app.<\/span>\n            <span style=\"color: #808080; font-style: italic;\">\/\/ Your response should always inform the user that the application<\/span>\n            <span style=\"color: #808080; font-style: italic;\">\/\/ is not licensed, but your behavior at that point can vary. You might<\/span>\n            <span style=\"color: #808080; font-style: italic;\">\/\/ provide the user a limited access version of your app or you can<\/span>\n            <span style=\"color: #808080; font-style: italic;\">\/\/ take them to Google Play to purchase the app.<\/span>\n            showDialog<span style=\"color: #66cc66;\">&#40;<\/span>DIALOG_GOTOMARKET<span style=\"color: #66cc66;\">&#41;<\/span>;\n        <span style=\"color: #66cc66;\">&#125;<\/span>\n    <span style=\"color: #66cc66;\">&#125;<\/span>\n<span style=\"color: #66cc66;\">&#125;<\/span>\n&#160;<\/pre>\n<p>\u53e6\u5916, \u4f60\u5e94\u8be5\u5b9e\u73b0applicationError(), LVL\u8ba9\u4f60\u7684\u5e94\u7528\u5904\u7406\u65e0\u6cd5\u91cd\u8bd5\u7684\u9519\u8bef. \u9519\u8bef\u5217\u8868\u89c1Licensing Reference\u7684Server Response Codes. \u4f60\u53ef\u4ee5\u5728\u4efb\u4f55\u4f60\u9700\u8981\u7684\u5730\u65b9\u5b9e\u73b0\u8fd9\u4e2a\u65b9\u6cd5. \u5728\u5927\u591a\u6570\u60c5\u51b5\u4e0b, \u8fd9\u4e2a\u65b9\u6cd5\u5e94\u8be5\u8bb0\u5f55\u9519\u8bef\u5e76\u8c03\u7528dontAllow().\n<\/p><p><br \/>\n<\/p>\n<h3> <span class=\"mw-headline\" id=\".E5.88.9B.E5.BB.BA.E4.B8.80.E4.B8.AA.E4.BB.8ELicenseCheckerCallback_.E5.88.B0UI.E7.9A.84Handler.E7.BA.BF.E7.A8.8B\">\u521b\u5efa\u4e00\u4e2a\u4eceLicenseCheckerCallback \u5230UI\u7684Handler\u7ebf\u7a0b<\/span><\/h3>\n<p>\u5728\u7b7e\u540d\u68c0\u67e5\u7684\u65f6\u5019, LVL\u4f1a\u4f20\u9012\u4e00\u4e2a\u8bf7\u6c42\u5230Google Play, \u6765\u5904\u7406\u548c\u7b7e\u540d\u9a8c\u8bc1\u670d\u52a1\u5668\u7684\u901a\u4fe1. LVL\u5728\u5f02\u6b65IPC(\u4f7f\u7528Binder)\u4e0a\u4f20\u9012\u8bf7\u6c42 , \u6240\u4ee5\u5b9e\u9645\u5904\u7406\u548c\u7f51\u7edc\u901a\u4fe1\u4e0d\u5728\u4f60\u5e94\u7528\u7684\u540c\u4e00\u4e2a\u7ebf\u7a0b\u4e2d. \u540c\u6837\u7684, \u5f53Google Play\u63a5\u6536\u5230\u7ed3\u679c\u65f6, \u5b83\u5728IPC\u91cc\u8c03\u7528\u56de\u8c03\u65b9\u6cd5, \u5728\u4f60\u5e94\u7528\u8fdb\u7a0b\u7684IPC\u7ebf\u7a0b\u6c60\u91cc\u8f6e\u6d41\u6267\u884c . \n<\/p><p>LicenseChecker\u901a\u8fc7Google Play\u7ba1\u7406\u4f60\u5e94\u7528\u7684IPC\u901a\u4fe1, \u5305\u62ec\u8c03\u7528\u53d1\u9001\u8bf7\u6c42\u548c\u63a5\u6536\u54cd\u5e94\u7684\u56de\u8c03\u51fd\u6570\u7684\u65b9\u6cd5. LicenseChecker\u4f1a\u8ddf\u8e2a\u6253\u5f00\u7684\u7b7e\u540d\u8bf7\u6c42\u5e76\u7ba1\u7406\u5b83\u4eec\u7684\u8d85\u65f6\u8bbe\u5b9a. \n<\/p><p>\u6240\u4ee5\u5b83\u53ef\u4ee5\u9002\u5f53\u7684\u5904\u7406\u8d85\u65f6\u4e5f\u53ef\u4ee5\u5904\u7406\u4f20\u8fdb\u6765\u7684\u54cd\u5e94, \u800c\u4e0d\u4f1a\u5f71\u54cd\u4f60\u7684UI\u7ebf\u7a0b, LicenseChecker\u5b9e\u4f8b\u5316\u7684\u65f6\u5019\u4f1a\u4ea7\u751f\u4e00\u4e2a\u540e\u53f0\u7ebf\u7a0b. \u5b83\u4f1a\u5728\u7ebf\u7a0b\u91cc\u5904\u7406\u6240\u6709\u7684\u7b7e\u540d\u68c0\u67e5\u7ed3\u679c, \u65e0\u8bba\u662f\u662f\u4ece\u670d\u52a1\u5668\u63a5\u6536\u5230\u7684\u54cd\u5e94\u7ed3\u679c\u8fd8\u662f\u8d85\u65f6\u9519\u8bef. LVL\u6700\u540e\u90fd\u4f1a\u4ece\u540e\u53f0\u7ebf\u7a0b\u8c03\u7528\u4f60\u7684LicenseCheckerCallback.\n<\/p><p>\u5bf9\u4f60\u7684\u5e94\u7528\u6765\u8bf4, \u8fd9\u610f\u5473\u7740:\n<\/p><p>1.\t\u5728\u5927\u591a\u6570\u60c5\u51b5\u4e0b, \u4f60\u7684LicenseCheckerCallback\u91cc\u7684\u65b9\u6cd5\u4f1a\u88ab\u540e\u53f0\u7ebf\u7a0b\u89e6\u53d1\n<\/p><p>2.\t\u8fd9\u4e9b\u65b9\u6cd5\u4e0d\u4f1a\u4fee\u6539\u72b6\u6001\u6216\u5728UI\u7ebf\u7a0b\u91cc\u8c03\u7528\u4efb\u4f55\u5904\u7406\u65b9\u6cd5, \u9664\u975e\u4f60\u5728UI\u7ebf\u7a0b\u91cc\u521b\u5efa\u4e00\u4e2aHandler\u5e76\u4e14\u628a\u4f60\u7684\u56de\u8c03\u65b9\u6cd5\u4f20\u8fdb\u53bb.\n<\/p><p><br \/>\n\u5982\u679c\u4f60\u60f3\u8ba9LicenseCheckerCallback\u91cc\u7684\u65b9\u6cd5\u66f4\u65b0UI\u7ebf\u7a0b, \u5982\u4e0b\u6240\u793a, \u5728main Activity\u91cc\u7684onCreate()\u91cc\u521b\u5efaHandler. \u5728\u8fd9\u4e2a\u4f8b\u5b50\u91cc, LVL\u793a\u4f8b\u5e94\u7528\u7684LicenseCheckerCallback\u65b9\u6cd5(\u89c1\u4e0a\u6587)\u8c03\u7528displayResult()\u901a\u8fc7Handler\u7684post()\u66f4\u65b0UI\u7ebf\u7a0b.\n<\/p>\n<pre class=\"java\">&#160;\n<span style=\"color: #000000; font-weight: bold;\">private<\/span> Handler mHandler;\n&#160;\n    @Override\n    <span style=\"color: #000000; font-weight: bold;\">public<\/span> <span style=\"color: #993333;\">void<\/span> onCreate<span style=\"color: #66cc66;\">&#40;<\/span>Bundle savedInstanceState<span style=\"color: #66cc66;\">&#41;<\/span> <span style=\"color: #66cc66;\">&#123;<\/span>\n        ...\n        <span style=\"color: #006600;\">mHandler<\/span> = <span style=\"color: #000000; font-weight: bold;\">new<\/span> Handler<span style=\"color: #66cc66;\">&#40;<\/span><span style=\"color: #66cc66;\">&#41;<\/span>;\n    <span style=\"color: #66cc66;\">&#125;<\/span>\n&#160;<\/pre>\n<p>\u7136\u540e, \u5728LicenseCheckerCallback\u65b9\u6cd5\u91cc, \u4f60\u53ef\u4ee5\u4f7f\u7528Handler\u65b9\u6cd5\u4f20\u9012Runnable\u6216Message\u5bf9\u8c61\u5230Handler\u5bf9\u8c61. \u8fd9\u91cc\u662fLVL\u91cc\u7684\u4f8b\u5b50, \u5728UI\u7ebf\u7a0b\u91cc\u4f20\u9012Runnable\u5230Handler\u663e\u793a\u7b7e\u540d\u72b6\u6001.\n<\/p>\n<pre class=\"java\">&#160;\n<span style=\"color: #000000; font-weight: bold;\">private<\/span> <span style=\"color: #993333;\">void<\/span> displayResult<span style=\"color: #66cc66;\">&#40;<\/span><span style=\"color: #000000; font-weight: bold;\">final<\/span> <a href=\"http:\/\/www.google.com\/search?hl=en&amp;q=allinurl%3AString+java.sun.com&amp;btnI=I%27m%20Feeling%20Lucky\"><span style=\"color: #aaaadd; font-weight: bold;\">String<\/span><\/a> result<span style=\"color: #66cc66;\">&#41;<\/span> <span style=\"color: #66cc66;\">&#123;<\/span>\n        mHandler.<span style=\"color: #006600;\">post<\/span><span style=\"color: #66cc66;\">&#40;<\/span><span style=\"color: #000000; font-weight: bold;\">new<\/span> <a href=\"http:\/\/www.google.com\/search?hl=en&amp;q=allinurl%3ARunnable+java.sun.com&amp;btnI=I%27m%20Feeling%20Lucky\"><span style=\"color: #aaaadd; font-weight: bold;\">Runnable<\/span><\/a><span style=\"color: #66cc66;\">&#40;<\/span><span style=\"color: #66cc66;\">&#41;<\/span> <span style=\"color: #66cc66;\">&#123;<\/span>\n            <span style=\"color: #000000; font-weight: bold;\">public<\/span> <span style=\"color: #993333;\">void<\/span> run<span style=\"color: #66cc66;\">&#40;<\/span><span style=\"color: #66cc66;\">&#41;<\/span> <span style=\"color: #66cc66;\">&#123;<\/span>\n                mStatusText.<span style=\"color: #006600;\">setText<\/span><span style=\"color: #66cc66;\">&#40;<\/span>result<span style=\"color: #66cc66;\">&#41;<\/span>;\n                setProgressBarIndeterminateVisibility<span style=\"color: #66cc66;\">&#40;<\/span><span style=\"color: #000000; font-weight: bold;\">false<\/span><span style=\"color: #66cc66;\">&#41;<\/span>;\n                mCheckLicenseButton.<span style=\"color: #006600;\">setEnabled<\/span><span style=\"color: #66cc66;\">&#40;<\/span><span style=\"color: #000000; font-weight: bold;\">true<\/span><span style=\"color: #66cc66;\">&#41;<\/span>;\n            <span style=\"color: #66cc66;\">&#125;<\/span>\n        <span style=\"color: #66cc66;\">&#125;<\/span><span style=\"color: #66cc66;\">&#41;<\/span>;\n    <span style=\"color: #66cc66;\">&#125;<\/span>\n&#160;<\/pre>\n<p><br \/>\n<\/p>\n<h3> <span class=\"mw-headline\" id=\".E5.88.9D.E5.A7.8B.E5.8C.96LicenseChecker.E5.92.8CLicenseCheckerCall_-back\">\u521d\u59cb\u5316LicenseChecker\u548cLicenseCheckerCall -back<\/span><\/h3>\n<p>\u5728main Activity\u7684onCreate()\u91cc, \u521b\u5efaLicenseChecker\u548cLicenseCheckerCallback\u7684\u79c1\u6709\u5b9e\u4f8b\u5bf9\u8c61. \u4f60\u5fc5\u987b\u5148\u5b9e\u4f8b\u5316LicenseCheckerCallback, \u56e0\u4e3a\u4f60\u8c03\u7528LicenseChecker\u7684\u6784\u9020\u51fd\u6570\u7684\u65f6\u5019\u9700\u8981\u4f20\u9012LicenseCheckerCallback\u7684\u5f15\u7528\u8fdb\u53bb.\n<\/p><p>\u5f53\u4f60\u5b9e\u4f8b\u5316LicenseChecker\u7684\u65f6\u5019, \u4f60\u9700\u8981\u4f20\u5165\u8fd9\u4e9b\u53c2\u6570: \n<\/p>\n<ul><li>Context\n<\/li><\/ul>\n<ul><li>\u7528\u4e8e\u7b7e\u540d\u68c0\u67e5\u7684Policy\u5b9e\u4f8b\u5f15\u7528. \u5728\u5927\u591a\u6570\u60c5\u51b5\u4e0b, \u4f60\u53ef\u4ee5\u4f7f\u7528LVL\u63d0\u4f9b\u7684\u9ed8\u8ba4Policy\u5b9e\u4f8b, ServerManagedPolicy.\n<\/li><\/ul>\n<ul><li>\u7528\u4e8e\u8ba4\u8bc1\u7684\u4f60\u516c\u5171\u8d26\u53f7\u5bc6\u94a5\u7684\u5b57\u7b26\n<\/li><\/ul>\n<p>\u5982\u679c\u4f60\u4f7f\u7528ServerManagedPolicy, \u4f60\u4e0d\u9700\u8981\u76f4\u63a5\u8bbf\u95ee\u7c7b, \u6240\u4ee5\u4f60\u53ef\u4ee5\u50cf\u4e0b\u9762\u7684\u4f8b\u5b50\u91cc\u4e00\u6837\u5728LicenseChecker\u7684\u6784\u9020\u51fd\u6570\u91cc\u521d\u59cb\u5316\u5b83. \u6ce8\u610f\u4f60\u5728\u6784\u9020ServerManagedPolicy\u7684\u65f6\u5019\u9700\u8981\u4f20\u5165\u4e00\u4e2aObfuscator\u5b9e\u4f8b\u7684\u5f15\u7528.\n<\/p><p>\u4e0b\u9762\u662f\u5728Activity\u7684onCreate()\u91cc\u521d\u59cb\u5316LicenseChecker\u548cLicenseCheckerCallback\u7684\u4f8b\u5b50. \n<\/p>\n<pre class=\"java\">&#160;\n<span style=\"color: #000000; font-weight: bold;\">public<\/span> <span style=\"color: #000000; font-weight: bold;\">class<\/span> MainActivity <span style=\"color: #000000; font-weight: bold;\">extends<\/span> Activity <span style=\"color: #66cc66;\">&#123;<\/span>\n    ...\n    <span style=\"color: #000000; font-weight: bold;\">private<\/span> LicenseCheckerCallback mLicenseCheckerCallback;\n    <span style=\"color: #000000; font-weight: bold;\">private<\/span> LicenseChecker mChecker;\n&#160;\n    @Override\n    <span style=\"color: #000000; font-weight: bold;\">public<\/span> <span style=\"color: #993333;\">void<\/span> onCreate<span style=\"color: #66cc66;\">&#40;<\/span>Bundle savedInstanceState<span style=\"color: #66cc66;\">&#41;<\/span> <span style=\"color: #66cc66;\">&#123;<\/span>\n        <span style=\"color: #000000; font-weight: bold;\">super<\/span>.<span style=\"color: #006600;\">onCreate<\/span><span style=\"color: #66cc66;\">&#40;<\/span>savedInstanceState<span style=\"color: #66cc66;\">&#41;<\/span>;\n        ...\n        <span style=\"color: #808080; font-style: italic;\">\/\/ Construct the LicenseCheckerCallback. The library calls this when done.<\/span>\n        mLicenseCheckerCallback = <span style=\"color: #000000; font-weight: bold;\">new<\/span> MyLicenseCheckerCallback<span style=\"color: #66cc66;\">&#40;<\/span><span style=\"color: #66cc66;\">&#41;<\/span>;\n&#160;\n        <span style=\"color: #808080; font-style: italic;\">\/\/ Construct the LicenseChecker with a Policy.<\/span>\n        mChecker = <span style=\"color: #000000; font-weight: bold;\">new<\/span> LicenseChecker<span style=\"color: #66cc66;\">&#40;<\/span>\n            <span style=\"color: #000000; font-weight: bold;\">this<\/span>, <span style=\"color: #000000; font-weight: bold;\">new<\/span> ServerManagedPolicy<span style=\"color: #66cc66;\">&#40;<\/span><span style=\"color: #000000; font-weight: bold;\">this<\/span>,\n                <span style=\"color: #000000; font-weight: bold;\">new<\/span> AESObfuscator<span style=\"color: #66cc66;\">&#40;<\/span>SALT, getPackageName<span style=\"color: #66cc66;\">&#40;<\/span><span style=\"color: #66cc66;\">&#41;<\/span>, deviceId<span style=\"color: #66cc66;\">&#41;<\/span><span style=\"color: #66cc66;\">&#41;<\/span>,\n            BASE64_PUBLIC_KEY  <span style=\"color: #808080; font-style: italic;\">\/\/ Your public licensing key.<\/span>\n            <span style=\"color: #66cc66;\">&#41;<\/span>;\n        ...\n    <span style=\"color: #66cc66;\">&#125;<\/span>\n<span style=\"color: #66cc66;\">&#125;<\/span>\n&#160;<\/pre>\n<p>\u6ce8\u610f\u53ea\u6709\u5728\u672c\u5730\u7684\u7f13\u5b58\u91cc\u6709\u6709\u6548\u7684\u7b7e\u540d\u54cd\u5e94\u6570\u636e\u7684\u65f6\u5019, LicenseChecker\u624d\u4f1a\u5728UI\u7ebf\u7a0b\u91cc\u8c03\u7528LicenseCheckerCallback\u7684\u56de\u8c03\u65b9\u6cd5. \u5982\u679c\u53d1\u9001\u4e86\u7b7e\u540d\u68c0\u67e5\u8bf7\u6c42\u5230\u670d\u52a1\u5668, \u56de\u8c03\u65b9\u6cd5\u603b\u4f1a\u88ab\u8c03\u7528, \u751a\u81f3\u5728\u7f51\u7edc\u9519\u8bef\u7684\u65f6\u5019\u4e5f\u4f1a\u8c03\u7528.\n<\/p><p><br \/>\n<\/p>\n<h3> <span class=\"mw-headline\" id=\".E8.B0.83.E7.94.A8checkAccess.28.29.E5.88.9D.E5.A7.8B.E5.8C.96.E7.AD.BE.E5.90.8D.E6.A3.80.E6.9F.A5\">\u8c03\u7528checkAccess()\u521d\u59cb\u5316\u7b7e\u540d\u68c0\u67e5<\/span><\/h3>\n<p>\u5728main Activity\u91cc, \u589e\u52a0\u8c03\u7528LicenseChecker\u5b9e\u4f8b\u7684checkAccess()\u7684\u65b9\u6cd5. \u5728\u8fd9\u4e2a\u65b9\u6cd5\u91cc, \u4f20\u5165LicenseCheckerCallback\u5b9e\u4f8b\u7684\u5f15\u7528\u4f5c\u4e3a\u4f5c\u4e3a\u53c2\u6570. \u5982\u679c\u4f60\u9700\u8981\u5728\u8c03\u7528\u5904\u7406\u4efb\u4f55\u7279\u6b8a\u7684UI\u6548\u679c\u6216\u72b6\u6001\u7ba1\u7406, \u4f60\u53ef\u4ee5\u5728checkAccess()\u7684\u5c01\u88c5\u65b9\u6cd5\u91cc\u6709\u6548\u7684\u5904\u7406. \u4e0b\u9762\u662fLVL\u91cc\u4ecedoCheck()\u5c01\u88c5\u65b9\u6cd5\u91cc\u8c03\u7528checkAccess()\u7684\u4f8b\u5b50\uff1a\n<\/p>\n<pre class=\"java\">&#160;\n<span style=\"color: #000000; font-weight: bold;\">public<\/span> <span style=\"color: #000000; font-weight: bold;\">class<\/span> MainActivity <span style=\"color: #000000; font-weight: bold;\">extends<\/span> Activity <span style=\"color: #66cc66;\">&#123;<\/span>\n    ...\n    <span style=\"color: #000000; font-weight: bold;\">private<\/span> LicenseCheckerCallback mLicenseCheckerCallback;\n    <span style=\"color: #000000; font-weight: bold;\">private<\/span> LicenseChecker mChecker;\n&#160;\n    @Override\n    <span style=\"color: #000000; font-weight: bold;\">public<\/span> <span style=\"color: #993333;\">void<\/span> onCreate<span style=\"color: #66cc66;\">&#40;<\/span>Bundle savedInstanceState<span style=\"color: #66cc66;\">&#41;<\/span> <span style=\"color: #66cc66;\">&#123;<\/span>\n        <span style=\"color: #000000; font-weight: bold;\">super<\/span>.<span style=\"color: #006600;\">onCreate<\/span><span style=\"color: #66cc66;\">&#40;<\/span>savedInstanceState<span style=\"color: #66cc66;\">&#41;<\/span>;\n        ...\n        <span style=\"color: #808080; font-style: italic;\">\/\/ Construct the LicenseCheckerCallback. The library calls this when done.<\/span>\n        mLicenseCheckerCallback = <span style=\"color: #000000; font-weight: bold;\">new<\/span> MyLicenseCheckerCallback<span style=\"color: #66cc66;\">&#40;<\/span><span style=\"color: #66cc66;\">&#41;<\/span>;\n&#160;\n        <span style=\"color: #808080; font-style: italic;\">\/\/ Construct the LicenseChecker with a Policy.<\/span>\n        mChecker = <span style=\"color: #000000; font-weight: bold;\">new<\/span> LicenseChecker<span style=\"color: #66cc66;\">&#40;<\/span>\n            <span style=\"color: #000000; font-weight: bold;\">this<\/span>, <span style=\"color: #000000; font-weight: bold;\">new<\/span> ServerManagedPolicy<span style=\"color: #66cc66;\">&#40;<\/span><span style=\"color: #000000; font-weight: bold;\">this<\/span>,\n                <span style=\"color: #000000; font-weight: bold;\">new<\/span> AESObfuscator<span style=\"color: #66cc66;\">&#40;<\/span>SALT, getPackageName<span style=\"color: #66cc66;\">&#40;<\/span><span style=\"color: #66cc66;\">&#41;<\/span>, deviceId<span style=\"color: #66cc66;\">&#41;<\/span><span style=\"color: #66cc66;\">&#41;<\/span>,\n            BASE64_PUBLIC_KEY  <span style=\"color: #808080; font-style: italic;\">\/\/ Your public licensing key.<\/span>\n            <span style=\"color: #66cc66;\">&#41;<\/span>;\n        ...\n    <span style=\"color: #66cc66;\">&#125;<\/span>\n<span style=\"color: #66cc66;\">&#125;<\/span>\n&#160;<\/pre>\n<h3> <span class=\"mw-headline\" id=\".E4.B8.BA.E7.AD.BE.E5.90.8D.E8.AE.A4.E8.AF.81.E6.A4.8D.E5.85.A5.E4.BD.A0.E7.9A.84.E5.AF.86.E9.92.A5\">\u4e3a\u7b7e\u540d\u8ba4\u8bc1\u690d\u5165\u4f60\u7684\u5bc6\u94a5<\/span><\/h3>\n<p>\u5bf9\u6bcf\u4e00\u4e2a\u5f00\u53d1\u8005\u8d26\u53f7, Google Play\u662f\u81ea\u52a8\u751f\u6210\u53ea\u7528\u4e8e\u7b7e\u540d\u68c0\u67e5\u76842048\u4f4d\u7684RSA\u516c\u6709\/\u79c1\u6709\u5bc6\u94a5. \u5bc6\u94a5\u548c\u5f00\u53d1\u8005\u7684\u8d26\u53f7\u662f\u552f\u4e00\u5173\u8054\u7684, \u5e76\u4e14\u901a\u8fc7\u8fd9\u4e2a\u8d26\u53f7\u53d1\u5e03\u7684\u5e94\u7528\u90fd\u5171\u4eab\u8fd9\u4e00\u4e2a\u5bc6\u94a5. \u867d\u7136\u5bc6\u94a5\u548c\u5f00\u53d1\u8005\u8d26\u53f7\u5173\u8054, \u4f46\u662f\u5b83\u548c\u4f60\u767b\u5f55\u5e94\u7528(\u6216\u5b83\u7684\u884d\u751f\u4ea7\u54c1)\u6240\u7528\u7684\u4e0d\u4e00\u6837. \n<\/p><p>Google Play \u5f00\u53d1\u8005\u7f51\u7ad9\u516c\u5f00\u7528\u4e8e\u7b7e\u540d\u7684\u516c\u5171\u5bc6\u94a5\u6388\u6743\u7ed9\u4efb\u4f55\u5f00\u53d1\u8005, \u4f46\u662f\u5b83\u4fdd\u6301\u6240\u6709\u7528\u6237\u7684\u79c1\u6709\u5bc6\u94a5\u5728\u4e00\u4e2a\u5b89\u5168\u7684\u5730\u65b9. \u5f53\u4e00\u4e2a\u5e94\u7528\u4e3a\u4f60\u8d26\u53f7\u53d1\u5e03\u7684\u5e94\u7528\u8bf7\u6c42\u7b7e\u540d\u8ba4\u8bc1, \u7b7e\u540d\u8ba4\u8bc1\u670d\u52a1\u5668\u4f1a\u6807\u8bc6\u54cd\u5e94\u7ed3\u679c\u662f\u4f7f\u7528\u7684\u79c1\u6709\u5bc6\u94a5. \u5f53LVL\u63a5\u6536\u5230\u54cd\u5e94\u7684\u65f6\u5019, \u5b83\u4f1a\u4f7f\u7528\u5e94\u7528\u63d0\u4f9b\u7684\u516c\u5171\u5bc6\u94a5\u53bb\u9a8c\u8bc1\u54cd\u5e94\u7ed3\u679c\u7684\u7b7e\u540d. \n<\/p><p><br \/>\n\u8981\u5728\u5e94\u7528\u4e2d\u6dfb\u52a0\u7b7e\u540d, \u4f60\u5fc5\u987b\u83b7\u5f97\u4f60\u5f00\u53d1\u8d26\u53f7\u7684\u516c\u94a5\u5e76\u590d\u5236\u5230\u4f60\u7684\u5e94\u7528. \u4e0b\u9762\u662f\u600e\u4e48\u83b7\u53d6\u4f60\u8d26\u53f7\u7684\u516c\u94a5: \n<\/p><p>1.\u767b\u5f55Google Play\u5f00\u53d1\u8005\u7f51\u7ad9. \u786e\u4fdd\u4f60\u767b\u5f55\u8d26\u53f7\u4e0a\u7684\u5e94\u7528\u5df2\u53d1\u5e03(\u6216\u5c06\u53d1\u5e03).\n<\/p><p>2.\u5728\u8d26\u53f7\u9996\u9875, \u67e5\u627e\u201d\u7f16\u8f91\u5c5e\u6027\u201d(Edit profile)\u94fe\u63a5\u5e76\u70b9\u51fb\n<\/p><p>3.\u5728\u7f16\u8f91\u5c5e\u6027(Edit profile)\u9875\u9762, \u67e5\u627e\u201d\u7b7e\u540d\u201d(Licensing)\u9762\u677f. \u7528\u4e8e\u7b7e\u540d\u7684\u516c\u94a5\u5728\u6587\u672c\u6846\u201d\u516c\u94a5\u201d(Public Key)\u91cc. \n<\/p><p><br \/>\n\u6dfb\u52a0\u516c\u94a5\u5230\u4f60\u7684\u5e94\u7528, \u53ea\u8981\u5728\u6587\u672c\u6846\u91cc\u590d\u5236\u5230\u4f60\u7684\u5e94\u7528\u91cc, \u8d4b\u503c\u7ed9\u4f60String \u5c5e\u6027BASE64_PUBLIC_KEY. \u5f53\u4f60\u590d\u5236\u7684\u65f6\u5019\u786e\u4fdd\u4f60\u9009\u62e9\u4e86\u5b8c\u6574\u5bc6\u94a5, \u4e0d\u8981\u9057\u6f0f\u4e86\u5b57\u7b26. \n<\/p><p>\u793a\u4f8b\uff1a\n<\/p>\n<pre class=\"java\">&#160;\n<span style=\"color: #000000; font-weight: bold;\">public<\/span> <span style=\"color: #000000; font-weight: bold;\">class<\/span> MainActivity <span style=\"color: #000000; font-weight: bold;\">extends<\/span> Activity <span style=\"color: #66cc66;\">&#123;<\/span>\n        <span style=\"color: #000000; font-weight: bold;\">private<\/span> <span style=\"color: #000000; font-weight: bold;\">static<\/span> <span style=\"color: #000000; font-weight: bold;\">final<\/span> <a href=\"http:\/\/www.google.com\/search?hl=en&amp;q=allinurl%3AString+java.sun.com&amp;btnI=I%27m%20Feeling%20Lucky\"><span style=\"color: #aaaadd; font-weight: bold;\">String<\/span><\/a> BASE64_PUBLIC_KEY = <span style=\"color: #ff0000;\">&quot;MIIBIjANBgkqhkiG ... &quot;<\/span>; <span style=\"color: #808080; font-style: italic;\">\/\/truncated for this example<\/span>\n    ...\n    <span style=\"color: #66cc66;\">&#125;<\/span>\n&#160;<\/pre>\n<p><br \/>\n<\/p>\n<h3> <span class=\"mw-headline\" id=\".E5.85.B3.E9.97.ADIPC.E8.BF.9E.E6.8E.A5.E7.9A.84.E6.97.B6.E5.80.99.E8.B0.83.E7.94.A8LicenseChecker.E7.9A.84onDestory.28.29.E6.96.B9.E6.B3.95\">\u5173\u95edIPC\u8fde\u63a5\u7684\u65f6\u5019\u8c03\u7528LicenseChecker\u7684onDestory()\u65b9\u6cd5<\/span><\/h3>\n<p>\u6700\u540e, \u8ba9LVL\u5728\u4f60\u7684\u5e94\u7528Context\u6539\u53d8\u7684\u65f6\u5019\u6e05\u7a7a, \u5728Activity\u7684onDesctory()\u5b9e\u73b0\u91cc\u589e\u52a0\u4e00\u4e2a\u8c03\u7528LicenseChecker\u7684onDestory()\u7684\u65b9\u6cd5. \u8fd9\u4f1a\u8ba9LicenseChecker\u9002\u65f6\u7684\u5173\u95ed\u4efb\u4f55\u8fde\u63a5\u5230Google Play \u5e94\u7528\u7684IliecensingService\u7684IPC\u8fde\u63a5, \u5e76\u4e14\u5220\u9664\u4efb\u4f55service\u548chandler\u7684\u5f15\u7528. \n<\/p><p>\u8c03\u7528LicenseChecker\u7684onDestory()\u5931\u8d25\u4f1a\u5bfc\u81f4\u4f60\u7684\u5e94\u7528\u5728\u751f\u547d\u5468\u671f\u5185\u51fa\u73b0\u95ee\u9898. \u4f8b\u5982, \u5f53\u7528\u6237\u5728\u7b7e\u540d\u68c0\u67e5\u7684\u65f6\u5019\u6539\u53d8\u5c4f\u5e55\u65b9\u5411, \u5e94\u7528\u7684Context\u4f1a\u88ab\u9500\u6bc1. \u5982\u679c\u4f60\u7684\u5e94\u7528\u4e0d\u80fd\u9002\u65f6\u7684\u5173\u95edLicenseChecker\u7684IPC\u8fde\u63a5, \u4f60\u7528\u7684\u5e94\u7528\u4f1a\u5728\u63a5\u6536\u5230\u54cd\u5e94\u7684\u65f6\u5019\u5d29\u6e83. \u7c7b\u4f3c\u7684, \u5982\u679c\u7528\u6237\u5728\u7b7e\u540d\u68c0\u67e5\u7684\u65f6\u5019\u9000\u51fa\u5e94\u7528\u4f1a\u5bfc\u81f4\u5e94\u7528\u5728\u63a5\u6536\u5230\u54cd\u5e94\u7684\u65f6\u5019\u5d29\u6e83, \u9664\u975e\u4f60\u5728\u65ad\u5f00\u8fde\u63a5\u7684\u65f6\u5019\u6b63\u786e\u7684\u8c03\u7528LicenseChecker\u7684onDestory().\n<\/p><p>\u4e0b\u9762\u662fLVL\u91cc\u7684\u4f8b\u5b50, mChecker\u662fLicenseChecker\u7684\u5b9e\u4f8b: \n<\/p>\n<pre class=\"java\">&#160;\n@Override\n    <span style=\"color: #000000; font-weight: bold;\">protected<\/span> <span style=\"color: #993333;\">void<\/span> onDestroy<span style=\"color: #66cc66;\">&#40;<\/span><span style=\"color: #66cc66;\">&#41;<\/span> <span style=\"color: #66cc66;\">&#123;<\/span>\n        <span style=\"color: #000000; font-weight: bold;\">super<\/span>.<span style=\"color: #006600;\">onDestroy<\/span><span style=\"color: #66cc66;\">&#40;<\/span><span style=\"color: #66cc66;\">&#41;<\/span>;\n        mChecker.<span style=\"color: #006600;\">onDestroy<\/span><span style=\"color: #66cc66;\">&#40;<\/span><span style=\"color: #66cc66;\">&#41;<\/span>;\n        ...\n    <span style=\"color: #66cc66;\">&#125;<\/span>\n&#160;<\/pre>\n<p>\u5982\u679c\u4f60\u7ee7\u627f\u6216\u4fee\u6539LicenseChecker, \u4f60\u53ef\u80fd\u8fd8\u9700\u8981\u8c03\u7528LicenseChecker\u7684finishCheck()\u6e05\u7406\u6240\u6709IPC\u8fde\u63a5.\n<\/p><p><br \/>\n<\/p>\n<h2> <span class=\"mw-headline\" id=\".E5.AE.9E.E7.8E.B0DeviceLimiter\">\u5b9e\u73b0DeviceLimiter<\/span><\/h2>\n<p>\u6709\u4e9b\u65f6\u5019, \u4f60\u53ef\u80fd\u5e0c\u671b\u4f60\u7684Policy\u9650\u5236\u4e00\u4e9b\u5b9e\u9645\u7684\u8bbe\u5907\u5141\u8bb8\u4f7f\u7528\u5355\u4e00\u7684\u7b7e\u540d. \u8fd9\u53ef\u4ee5\u9632\u6b62\u7528\u6237\u5c06\u7b7e\u540d\u7684\u5e94\u7528\u79fb\u52a8\u5230\u5176\u4ed6\u8bbe\u5907\u4e0a\u5e76\u4e14\u5728\u8fd9\u4e9b\u8bbe\u5907\u4e0a\u901a\u8fc7\u540c\u4e00\u4e2a\u8d26\u53f7\u4f7f\u7528\u5e94\u7528 . \u5b83\u8fd8\u53ef\u4ee5\u9632\u6b62\u7528\u6237\u901a\u8fc7\u63d0\u4f9b\u8d26\u53f7\u5173\u8054\u7684\u7b7e\u540d\u7ed9\u5176\u4ed6\u4eba\u5171\u4eab\u5e94\u7528, \u4ed6\u4eec\u968f\u540e\u5c31\u53ef\u4ee5\u5728\u4ed6\u4eec\u7684\u8bbe\u5907\u4e0a\u767b\u5f55\u8d26\u53f7\u5e76\u6388\u6743\u7ed9\u5e94\u7528. \n<\/p><p>LVL\u652f\u6301\u901a\u8fc7DeviceLimiter\u63a5\u53e3\u7ed9\u6bcf\u53f0\u5b9a\u4e49\u4e86\u65b9\u6cd5allowDeviceAccess()\u7684\u8bbe\u5907\u7b7e\u540d. \u5f53LicenseValidator\u5904\u7406\u6765\u81ea\u7b7e\u540d\u670d\u52a1\u5668\u7684\u54cd\u5e94\u6570\u636e\u65f6\u5019, \u5b83\u4f1a\u8c03\u7528allowDeviceAccess(), \u628a\u54cd\u5e94\u6570\u636e\u4e2d\u7684\u7528\u6237ID\u4f20\u8fdb\u53bb. \n<\/p><p>\u5982\u679c\u4f60\u4e0d\u884c\u9650\u5b9a\u8bbe\u5907, \u8fd9\u4e0d\u662f\u5fc5\u9700\u7684\u5de5\u4f5c\u2014\u2014LicenseChecker\u7c7b\u4f1a\u81ea\u52a8\u4f7f\u7528\u9ed8\u8ba4\u7684\u5b9e\u73b0NullDeviceLimiter. \u987e\u540d\u601d\u4e49, NullDeviceLimiter\u662f\u4e00\u4e2a\u201d\u65e0\u64cd\u4f5c\u201d\u7684\u7c7b, \u5b83\u7684allowDeviceAccess()\u65b9\u6cd5\u5bf9\u6240\u6709\u7528\u6237\u548c\u8bbe\u5907\u53ea\u4f1a\u7b80\u5355\u7684\u8fd4\u56deLICENSED.\n<\/p><p><br \/>\n\u6709\u4e9b\u65f6\u5019, \u4f60\u53ef\u80fd\u5e0c\u671b\u4f60\u7684Policy\u9650\u5236\u4e00\u4e9b\u5b9e\u9645\u7684\u8bbe\u5907\u5141\u8bb8\u4f7f\u7528\u5355\u4e00\u7684\u7b7e\u540d. \u8fd9\u53ef\u4ee5\u9632\u6b62\u7528\u6237\u5c06\u7b7e\u540d\u7684\u5e94\u7528\u79fb\u52a8\u5230\u5176\u4ed6\u8bbe\u5907\u4e0a\u5e76\u4e14\u5728\u8fd9\u4e9b\u8bbe\u5907\u4e0a\u901a\u8fc7\u540c\u4e00\u4e2a\u8d26\u53f7\u4f7f\u7528\u5e94\u7528 . \u5b83\u8fd8\u53ef\u4ee5\u9632\u6b62\u7528\u6237\u901a\u8fc7\u63d0\u4f9b\u8d26\u53f7\u5173\u8054\u7684\u7b7e\u540d\u7ed9\u5176\u4ed6\u4eba\u5171\u4eab\u5e94\u7528, \u4ed6\u4eec\u968f\u540e\u5c31\u53ef\u4ee5\u5728\u4ed6\u4eec\u7684\u8bbe\u5907\u4e0a\u767b\u5f55\u8d26\u53f7\u5e76\u6388\u6743\u7ed9\u5e94\u7528. \n<\/p><p>LVL\u652f\u6301\u901a\u8fc7DeviceLimiter\u63a5\u53e3\u7ed9\u6bcf\u53f0\u5b9a\u4e49\u4e86\u65b9\u6cd5allowDeviceAccess()\u7684\u8bbe\u5907\u7b7e\u540d. \u5f53LicenseValidator\u5904\u7406\u6765\u81ea\u7b7e\u540d\u670d\u52a1\u5668\u7684\u54cd\u5e94\u6570\u636e\u65f6\u5019, \u5b83\u4f1a\u8c03\u7528allowDeviceAccess(), \u628a\u54cd\u5e94\u6570\u636e\u4e2d\u7684\u7528\u6237ID\u4f20\u8fdb\u53bb. \n<\/p><p>\u5982\u679c\u4f60\u4e0d\u884c\u9650\u5b9a\u8bbe\u5907, \u8fd9\u4e0d\u662f\u5fc5\u9700\u7684\u5de5\u4f5c\u2014\u2014LicenseChecker\u7c7b\u4f1a\u81ea\u52a8\u4f7f\u7528\u9ed8\u8ba4\u7684\u5b9e\u73b0NullDeviceLimiter. \u987e\u540d\u601d\u4e49, NullDeviceLimiter\u662f\u4e00\u4e2a\u201d\u65e0\u64cd\u4f5c\u201d\u7684\u7c7b, \u5b83\u7684allowDeviceAccess()\u65b9\u6cd5\u5bf9\u6240\u6709\u7528\u6237\u548c\u8bbe\u5907\u53ea\u4f1a\u7b80\u5355\u7684\u8fd4\u56deLICENSED.\n<\/p><p><br \/>\n<\/p>\n<div style=\"margin: 1em 0; padding: 10px; overflow: auto; background: #F7F7F7; border-left:4px solid; border-color:#FF7F00;\">\n<p>\u8b66\u544a: Per-device\u7b7e\u540d\u5bf9\u5927\u591a\u6570\u5e94\u7528\u4e0d\u5efa\u8bae\u4f7f\u7528, \u56e0\u4e3a: \n<\/p>\n<ul><li>\u5b83\u9700\u8981\u4f60\u63d0\u4f9b\u540e\u7aef\u670d\u52a1\u5668\u6765\u7ba1\u7406\u7528\u6237\u548c\u8bbe\u5907\u7684\u6620\u5c04\n<\/li><\/ul>\n<ul><li>\u5b83\u53ef\u80fd\u5728\u4e0d\u7ecf\u610f\u95f4\u5bfc\u81f4\u7528\u6237\u5728\u53e6\u4e00\u4e2a\u8bbe\u5907\u4e0a\u65e0\u6cd5\u8bbf\u95ee\u4ed6\u4eec\u5408\u6cd5\u8d2d\u4e70\u7684\u5e94\u7528\n<\/li><\/ul>\n<\/div>\n<h2> <span class=\"mw-headline\" id=\".E6.B7.B7.E6.B7.86.E4.BD.A0.E7.9A.84.E4.BB.A3.E7.A0.81\">\u6df7\u6dc6\u4f60\u7684\u4ee3\u7801<\/span><\/h2>\n<p>\u786e\u4fdd\u4f60\u7684\u5e94\u7528\u5b89\u5168, \u7279\u522b\u5bf9\u4e8e\u4f7f\u7528\u7b7e\u540d\u548c\/\u6216\u81ea\u5b9a\u4e49\u7684\u7ea6\u675f\u548c\u4fdd\u62a4\u7684\u4ed8\u8d39\u5e94\u7528\u6765\u8bf4, \u6df7\u6dc6\u4f60\u7684\u5e94\u7528\u7a0b\u5e8f\u7684\u4ee3\u7801\u662f\u975e\u5e38\u91cd\u8981\u7684. \u9002\u5f53\u7684\u6df7\u6dc6\u4f60\u5e94\u7528\u7684\u4ee3\u7801\u53ef\u4ee5\u8ba9\u6076\u610f\u7528\u6237\u53cd\u7f16\u8bd1\u4f60\u7684\u5e94\u7528\u7a0b\u5e8f\u5b57\u8282\u7801\u53d8\u5f97\u975e\u5e38\u56f0\u96be, \u4fee\u6539\u5b83\u2014\u2014\u4f8b\u5982\u79fb\u9664\u7b7e\u540d\u68c0\u67e5\u7684\u90e8\u5206, \u7136\u540e\u91cd\u65b0\u7f16\u8bd1. \n<\/p><p>\u5927\u591a\u6570\u6df7\u6dc6\u5904\u7406\u7a0b\u5e8f\u5bf9android\u5e94\u7528\u90fd\u662f\u6709\u6548\u7684, \u5305\u62ecProGuard\u4e5f\u63d0\u4f9b\u4e86\u4ee3\u7801\u4f18\u5316\u7684\u7279\u6027. \u5f3a\u70c8\u63a8\u8350\u4f7f\u7528\u4e86Google Play Licensing\u7684\u5e94\u7528\u4f7f\u7528ProGuard\u6216\u7c7b\u4f3c\u7684\u7a0b\u5e8f\u6df7\u6dc6\u4f60\u7684\u4ee3\u7801. \n<\/p><p><br \/>\n<\/p>\n<h2> <span class=\"mw-headline\" id=\".E5.8F.91.E5.B8.83.E7.AD.BE.E5.90.8D.E8.BF.87.E7.9A.84.E5.BA.94.E7.94.A8\">\u53d1\u5e03\u7b7e\u540d\u8fc7\u7684\u5e94\u7528<\/span><\/h2>\n<p>\u4f60\u6d4b\u8bd5\u5b8c\u4f60\u7684\u7b7e\u540d\u4e4b\u540e, \u5c31\u53ef\u4ee5\u51c6\u5907\u5728Google Play\u4e0a\u53d1\u5e03\u4f60\u7684\u5e94\u7528\u4e86. \u6309\u7167\u6b63\u5e38\u7684\u6b65\u9aa4\u51c6\u5907\u3001\u767b\u5f55, \u7136\u540e\u53d1\u5e03\u4f60\u7684\u5e94\u7528.\n<\/p>\n<h3> <span class=\"mw-headline\" id=\".E5.88.A0.E9.99.A4Copy_Protection\">\u5220\u9664Copy Protection<\/span><\/h3>\n<p>\u5f53\u4f60\u4e0a\u4f20\u7b7e\u540d\u8fc7\u7684\u5e94\u7528\u4e4b\u540e, \u8bb0\u5f97\u5728\u5e94\u7528\u91cc\u5220\u9664copy protection\u5982\u679c\u5b83\u73b0\u5728\u5728\u4f7f\u7528. \u767b\u5f55\u5f00\u53d1\u8005\u7f51\u7ad9\u8fdb\u5165\u5e94\u7528\u4e0a\u4f20\u7684\u8be6\u60c5\u9875, \u68c0\u67e5\u5e76\u5220\u9664copy protection. \u5728\u53d1\u5e03(Publishing)\u9009\u9879\u90e8\u5206, \u786e\u4fddCopy Protection\u5355\u9009\u6309\u94ae\u9009\u9879\u662f\u201d\u5173\u95ed\u201d(Off)\u72b6\u6001.\n<\/p>\n<h2> <span class=\"mw-headline\" id=\".E8.8E.B7.E5.BE.97.E6.94.AF.E6.8C.81\">\u83b7\u5f97\u652f\u6301<\/span><\/h2>\n<p>\u5982\u679c\u4f60\u5728\u5b9e\u73b0\u6216\u90e8\u7f72\u53d1\u5e03\u4f60\u7684\u5e94\u7528\u7684\u65f6\u5019\u6709\u95ee\u9898\u6216\u9047\u5230\u95ee\u9898, \u8bf7\u4f7f\u7528\u4e0b\u9762\u8868\u683c\u4e2d\u7684\u652f\u6301\u8d44\u6e90\u5217\u8868. \u901a\u8fc7\u6307\u5bfc\u4f60\u67e5\u8be2\u6b63\u786e\u7684\u8bba\u575b, \u4f60\u53ef\u4ee5\u66f4\u5feb\u901f\u7684\u83b7\u5f97\u4f60\u9700\u8981\u7684\u652f\u6301.\n<\/p><p>\u88682 Google Play \u6388\u6743\u670d\u52a1\u7684\u5f00\u53d1\u8005\u652f\u6301\u8d44\u6e90\n<\/p>\n<table style=\"border-spacing: 0px;margin: 4px 4px; width: 90%; border-left:1px solid #ccc;border-top:1px solid #ccc;\">\n\n\n<tr style=\"background:#DEE8F1;\">\n<th style=\"border-right:1px solid #ccc;border-bottom:1px solid #ccc; padding:5px 15px\"> \u652f\u6301\u7c7b\u578b\n<\/th>\n<th style=\"border-right:1px solid #ccc;border-bottom:1px solid #ccc; padding:5px 15px\"> \u8d44\u6e90\n<\/th>\n<th style=\"border-right:1px solid #ccc;border-bottom:1px solid #ccc; padding:5px 15px\"> \u4e3b\u4f53\u8303\u56f4\n<\/th><\/tr>\n<tr style=\"vertical-align:top;\">\n<td style=\"border-right:1px solid #ccc;border-bottom:0px solid #ccc; padding:5px 15px;\">\n<p>\u5f00\u53d1\u548c\u6d4b\u8bd5\u95ee\u9898\n<\/p>\n<\/td>\n<td style=\"border-right:1px solid #ccc;border-bottom:1px solid #ccc; padding:5px 15px;\">\n<p>Google \u7fa4\u7ec4: android-developers\n<\/p>\n<\/td>\n<td style=\"border-right:1px solid #ccc;border-bottom:0px solid #ccc; padding:5px 15px;\">\n<p>LVL \u4e0b\u8f7d\u548c\u96c6\u6210, lib\u9879\u76ee,Policy \u95ee\u9898, \u7528\u6237\u4f53\u9a8c\u5efa\u8bae, \u5904\u7406\u54cd\u5e94, Obfuscator, IPC, \u6d4b\u8bd5\u73af\u5883\u8bbe\u7f6e\n<\/p>\n<\/td><\/tr>\n<tr style=\"vertical-align:top;\">\n<td style=\"border-right:1px solid #ccc;border-bottom:1px solid #ccc; padding:5px 15px;\">\n<\/td>\n<td style=\"border-right:1px solid #ccc;border-bottom:1px solid #ccc; padding:5px 15px;\">\n<p>Stack Overflow:<a rel=\"nofollow\" target=\"_blank\" class=\"external free\" href=\"http:\/\/stackoverflow.com\/questions\/tagged\/android\">http:\/\/stackoverflow.com\/questions\/tagged\/android<\/a>\n<\/p>\n<\/td>\n<td style=\"border-right:1px solid #ccc;border-bottom:1px solid #ccc; padding:5px 15px;\">\n<\/td><\/tr>\n<tr style=\"vertical-align:top;\">\n<td style=\"border-right:1px solid #ccc;border-bottom:0px solid #ccc; padding:5px 15px;\">\n<p>\u8d26\u53f7,\u53d1\u5e03\u548c\u90e8\u7f72\u95ee\u9898\n<\/p>\n<\/td>\n<td style=\"border-right:1px solid #ccc;border-bottom:1px solid #ccc; padding:5px 15px;\">\n<p>Google Play \u5e2e\u52a9\u8bba\u575b\n<\/p>\n<\/td>\n<td style=\"border-right:1px solid #ccc;border-bottom:0px solid #ccc; padding:5px 15px;\">\n<p>\u5f00\u53d1\u8005\u8d26\u53f7, \u7b7e\u540d\u5bc6\u94a5, \u6d4b\u8bd5\u8d26\u53f7, \u670d\u52a1\u5668\u54cd\u5e94, \u6d4b\u8bd5\u54cd\u5e94, \u5e94\u7528\u90e8\u7f72\u548c\u7ed3\u679c\n<\/p>\n<\/td><\/tr>\n<tr style=\"vertical-align:top;\">\n<td style=\"border-right:1px solid #ccc;border-bottom:1px solid #ccc; padding:5px 15px;\">\n<\/td>\n<td style=\"border-right:1px solid #ccc;border-bottom:1px solid #ccc; padding:5px 15px;\">\n<p>\u6388\u6743\u5e38\u89c1\u95ee\u9898\n<\/p>\n<\/td>\n<td style=\"border-right:1px solid #ccc;border-bottom:1px solid #ccc; padding:5px 15px;\">\n<p><br \/>\n<\/p>\n<\/td><\/tr>\n<tr style=\"vertical-align:top;\">\n<td style=\"border-right:1px solid #ccc;border-bottom:1px solid #ccc; padding:5px 15px;\">\n<p>LVL \u95ee\u9898\u8ddf\u8e2a\n<\/p>\n<\/td>\n<td style=\"border-right:1px solid #ccc;border-bottom:1px solid #ccc; padding:5px 15px;\">\n<p>Marketlicensing project \u95ee\u9898\u8ddf\u8e2a\n<\/p>\n<\/td>\n<td style=\"border-right:1px solid #ccc;border-bottom:1px solid #ccc; padding:5px 15px;\">\n<p>LVL\u6e90\u7801\u548c\u63a5\u53e3\u5b9e\u73b0\u7684Bug\u548c\u95ee\u9898\u62a5\u544a\n<\/p>\n<\/td><\/tr><\/table>\n<p><br \/>\n\u600e\u4e48\u628a\u4e00\u822c\u4fe1\u606f\u53d1\u9001\u5230\u4e0a\u9762\u7684\u7fa4\u7ec4\u5217\u8868\u91cc\u53bb, \u89c1Resource\u6807\u7b7e\u9875\u7684 Developer Forums\u6587\u6863\n<\/p>"}