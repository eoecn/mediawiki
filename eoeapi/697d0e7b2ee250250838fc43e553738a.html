{"title":"Creating an IME","text":"<p>\u8d1f\u8d23\u4eba\uff1asfshine \n<\/p><p>\u539f\u6587\u94fe\u63a5\uff1a<a rel=\"nofollow\" target=\"_blank\" class=\"external free\" href=\"http:\/\/docs.eoeandroid.com\/guide\/topics\/text\/creating-input-method.html\">http:\/\/docs.eoeandroid.com\/guide\/topics\/text\/creating-input-method.html<\/a>\n<\/p><p><br \/>\n<\/p>\n<table id=\"toc\" class=\"toc\"><tr><td><div id=\"toctitle\"><h2>\u76ee\u5f55<\/h2><\/div>\n<ul>\n<li class=\"toclevel-1 tocsection-1\"><a href=\"#Creating_an_Input_Method\"><span class=\"tocnumber\">1<\/span> <span class=\"toctext\">Creating an Input Method<\/span><\/a>\n<ul>\n<li class=\"toclevel-2 tocsection-2\"><a href=\"#The_IME_Lifecycle-IME.E7.9A.84.E7.94.9F.E5.91.BD.E5.91.A8.E6.9C.9F\"><span class=\"tocnumber\">1.1<\/span> <span class=\"toctext\">The IME Lifecycle-IME\u7684\u751f\u547d\u5468\u671f<\/span><\/a><\/li>\n<li class=\"toclevel-2 tocsection-3\"><a href=\"#Declaring_IME_Components_in_the_Manifest-IME.E7.9A.84.E7.BB.84.E4.BB.B6.E6.B8.85.E5.8D.95.E4.B8.AD.E5.A3.B0.E6.98.8E\"><span class=\"tocnumber\">1.2<\/span> <span class=\"toctext\">Declaring IME Components in the Manifest-IME\u7684\u7ec4\u4ef6\u6e05\u5355\u4e2d\u58f0\u660e<\/span><\/a><\/li>\n<li class=\"toclevel-2 tocsection-4\"><a href=\"#The_Input_Method_API-.E8.BE.93.E5.85.A5.E7.9A.84API\"><span class=\"tocnumber\">1.3<\/span> <span class=\"toctext\">The Input Method API-\u8f93\u5165\u7684API<\/span><\/a><\/li>\n<li class=\"toclevel-2 tocsection-5\"><a href=\"#Designing_the_Input_Method_UI-.E8.AE.BE.E7.BD.AE.E8.BE.93.E5.85.A5.E6.B3.95.E7.9A.84.E7.95.8C.E9.9D.A2\"><span class=\"tocnumber\">1.4<\/span> <span class=\"toctext\">Designing the Input Method UI-\u8bbe\u7f6e\u8f93\u5165\u6cd5\u7684\u754c\u9762<\/span><\/a>\n<ul>\n<li class=\"toclevel-3 tocsection-6\"><a href=\"#Input_view-.E8.BE.93.E5.85.A5.E6.B3.95.E7.95.8C.E9.9D.A2\"><span class=\"tocnumber\">1.4.1<\/span> <span class=\"toctext\">Input view-\u8f93\u5165\u6cd5\u754c\u9762<\/span><\/a><\/li>\n<li class=\"toclevel-3 tocsection-7\"><a href=\"#Candidates_view-.E5.80.99.E9.80.89.E5.AD.97.E7.95.8C.E9.9D.A2\"><span class=\"tocnumber\">1.4.2<\/span> <span class=\"toctext\">Candidates view-\u5019\u9009\u5b57\u754c\u9762<\/span><\/a><\/li>\n<li class=\"toclevel-3 tocsection-8\"><a href=\"#UI_design_considerations-.E7.95.8C.E9.9D.A2.E8.AE.BE.E8.AE.A1.E8.A6.81.E7.82.B9\"><span class=\"tocnumber\">1.4.3<\/span> <span class=\"toctext\">UI design considerations-\u754c\u9762\u8bbe\u8ba1\u8981\u70b9<\/span><\/a><\/li>\n<li class=\"toclevel-3 tocsection-9\"><a href=\"#Handling_multiple_screen_sizes-.E5.A4.9A.E5.88.86.E8.BE.A8.E7.8E.87.E6.94.AF.E6.8C.81\"><span class=\"tocnumber\">1.4.4<\/span> <span class=\"toctext\">Handling multiple screen sizes-\u591a\u5206\u8fa8\u7387\u652f\u6301<\/span><\/a><\/li>\n<li class=\"toclevel-3 tocsection-10\"><a href=\"#Handling_different_input_types-.E5.A4.84.E7.90.86.E4.B8.8D.E5.90.8C.E7.9A.84.E8.BE.93.E5.85.A5.E7.B1.BB.E5.9E.8B\"><span class=\"tocnumber\">1.4.5<\/span> <span class=\"toctext\">Handling different input types-\u5904\u7406\u4e0d\u540c\u7684\u8f93\u5165\u7c7b\u578b<\/span><\/a><\/li>\n<\/ul>\n<\/li>\n<li class=\"toclevel-2 tocsection-11\"><a href=\"#Sending_Text_to_the_Application-.E5.90.91.E5.BA.94.E7.94.A8.E5.8F.91.E9.80.81.E6.96.87.E6.9C.AC\"><span class=\"tocnumber\">1.5<\/span> <span class=\"toctext\">Sending Text to the Application-\u5411\u5e94\u7528\u53d1\u9001\u6587\u672c<\/span><\/a>\n<ul>\n<li class=\"toclevel-3 tocsection-12\"><a href=\"#Editing_the_text_around_the_cursor-.E5.9C.A8.E5.85.89.E6.A0.87.E5.91.A8.E5.9B.B4.E7.BC.96.E8.BE.91.E6.96.87.E6.9C.AC\"><span class=\"tocnumber\">1.5.1<\/span> <span class=\"toctext\">Editing the text around the cursor-\u5728\u5149\u6807\u5468\u56f4\u7f16\u8f91\u6587\u672c<\/span><\/a><\/li>\n<li class=\"toclevel-3 tocsection-13\"><a href=\"#Composing_text_before_committing-.E5.9C.A8.E6.8F.90.E4.BA.A4.E6.96.87.E6.9C.AC.E4.B9.8B.E5.89.8D.E7.9A.84.E6.92.B0.E5.86.99\"><span class=\"tocnumber\">1.5.2<\/span> <span class=\"toctext\">Composing text before committing-\u5728\u63d0\u4ea4\u6587\u672c\u4e4b\u524d\u7684\u64b0\u5199<\/span><\/a><\/li>\n<li class=\"toclevel-3 tocsection-14\"><a href=\"#Intercepting_hardware_key_events-.E6.8B.A6.E6.88.AA.E5.AE.9E.E4.BD.93.E9.94.AE.E7.9B.98.E6.8C.89.E9.92.AE.E4.BA.8B.E4.BB.B6\"><span class=\"tocnumber\">1.5.3<\/span> <span class=\"toctext\">Intercepting hardware key events-\u62e6\u622a\u5b9e\u4f53\u952e\u76d8\u6309\u94ae\u4e8b\u4ef6<\/span><\/a><\/li>\n<\/ul>\n<\/li>\n<li class=\"toclevel-2 tocsection-15\"><a href=\"#Creating_an_IME_Subtype-.E5.88.9B.E5.BB.BA.E4.B8.80.E4.B8.AA.E8.BE.93.E5.85.A5.E6.B3.95.E4.BA.9A.E7.A7.8D\"><span class=\"tocnumber\">1.6<\/span> <span class=\"toctext\">Creating an IME Subtype-\u521b\u5efa\u4e00\u4e2a\u8f93\u5165\u6cd5\u4e9a\u79cd<\/span><\/a>\n<ul>\n<li class=\"toclevel-3 tocsection-16\"><a href=\"#Choosing_IME_subtypes_from_the_notification_bar-.E9.80.9A.E8.BF.87.E9.80.9A.E7.9F.A5.E6.A0.8F.E9.80.89.E6.8B.A9.E8.BE.93.E5.85.A5.E6.B3.95.E7.9A.84.E4.BA.9A.E7.A7.8D\"><span class=\"tocnumber\">1.6.1<\/span> <span class=\"toctext\">Choosing IME subtypes from the notification bar-\u901a\u8fc7\u901a\u77e5\u680f\u9009\u62e9\u8f93\u5165\u6cd5\u7684\u4e9a\u79cd<\/span><\/a><\/li>\n<li class=\"toclevel-3 tocsection-17\"><a href=\"#Choosing_IME_subtypes_from_System_Settings-.E9.80.9A.E8.BF.87.E7.B3.BB.E7.BB.9F.E8.AE.BE.E7.BD.AE.E9.80.89.E6.8B.A9.E8.BE.93.E5.85.A5.E6.B3.95.E4.BA.9A.E7.A7.8D\"><span class=\"tocnumber\">1.6.2<\/span> <span class=\"toctext\">Choosing IME subtypes from System Settings-\u901a\u8fc7\u7cfb\u7edf\u8bbe\u7f6e\u9009\u62e9\u8f93\u5165\u6cd5\u4e9a\u79cd<\/span><\/a><\/li>\n<\/ul>\n<\/li>\n<li class=\"toclevel-2 tocsection-18\"><a href=\"#General_IME_Considerations-.E5.88.9B.E5.BB.BA.E8.BE.93.E5.85.A5.E6.B3.95.E5.BA.94.E7.94.A8.E7.9A.84.E6.B3.A8.E6.84.8F.E4.BA.8B.E9.A1.B9\"><span class=\"tocnumber\">1.7<\/span> <span class=\"toctext\">General IME Considerations-\u521b\u5efa\u8f93\u5165\u6cd5\u5e94\u7528\u7684\u6ce8\u610f\u4e8b\u9879<\/span><\/a><\/li>\n<\/ul>\n<\/li>\n<\/ul>\n<\/td><\/tr><\/table>\n<h1> <span class=\"mw-headline\" id=\"Creating_an_Input_Method\"> Creating an Input Method <\/span><\/h1>\n<p>An input method editor (IME) is a user control that enables users to enter text. Android provides an extensible input method framework that allows applications to provide users alternative input methods, such as on-screen keyboards or even speech input. Once installed, users can select which IME they want to use from the system settings and use it across the entire system; only one IME may be enabled at a time.\n<\/p><p>\u8f93\u5165\u6cd5\u7f16\u8f91\u5668\uff08IME\uff0c\u6709\u7684\u5730\u65b9\u7b80\u79f0IME\uff09\u662f\u4e00\u4e2a\u4f7f\u7528\u6237\u80fd\u591f\u8f93\u5165\u6587\u5b57\u7684\u63a7\u4ef6\u3002Android\u63d0\u4f9b\u4e86\u4e00\u4e2a\u53ef\u6269\u5c55\u7684\u8f93\u5165\u6cd5\u6846\u67b6\uff0c\u5b83\u5141\u8bb8\u5e94\u7528\u7a0b\u5e8f\u4e3a\u7528\u6237\u63d0\u4f9b\u53ef\u66ff\u4ee3\u7684\u8f93\u5165\u65b9\u6cd5\uff0c\u5982\u5c4f\u5e55\u4e0a\u7684\u952e\u76d8\u751a\u81f3\u662f\u8bed\u97f3\u8f93\u5165\u3002\u4e00\u65e6\u5b89\u88c5,\u7528\u6237\u5c31\u53ef\u4ee5\u5728\u7cfb\u7edf\u8bbe\u7f6e\u91cc\u9009\u62e9\u4ed6\u559c\u6b22\u7684\u8f93\u5165\u6cd5,\u8fd9\u4e2a\u8bbe\u7f6e\u53ef\u4ee5\u5728Android\u7cfb\u7edf\u7684\u6240\u6709\u7684\u5730\u65b9\u4f7f\u7528\u3002\u5f53\u7136\uff0c\u4f7f\u7528\u8fc7\u7a0b\u4e2d\uff0c\u4e00\u6b21\u53ea\u6709\u4e00\u79cd\u8f93\u5165\u6cd5\u88ab\u6fc0\u6d3b\uff08\u7528\u6237\u9009\u62e9\u7684\u90a3\u4e2a\uff09\u3002\n<\/p><p>To add an IME to the Android system, you create an Android application containing a class that extends InputMethodService. In addition, you usually create a \"settings\" activity that passes options to the IME service. You can also define a settings UI that's displayed as part of the system settings.\n<\/p><p>\u60f3\u8981\u7ed9Android\u5f00\u53d1\u4e00\u4e2a\u8f93\u5165\u6cd5\u5e94\u7528\uff0c\u60a8\u7684Android\u5e94\u7528\u9700\u8981\u542b\u4e00\u4e2a\u7ee7\u627f\u81eaInputMethodService\u7684\u7c7b\u3002\u6b64\u5916\uff0c\u60a8\u901a\u5e38\u9700\u8981\u521b\u5efa\u4e00\u4e2a\u201c\u8bbe\u7f6e\u8f93\u5165\u6cd5\u201d\u7684Activity\u6765\u8bbe\u5b9a\u5e94\u7528\u7684\u914d\u7f6e\u3002\u60a8\u4e5f\u53ef\u4ee5\u5b9a\u4e49\u4e00\u4e2a\u4f5c\u4e3a\u7cfb\u7edf\u8bbe\u7f6e\u7684\u4e00\u90e8\u5206\u6765\u663e\u793a\u7684\u8bbe\u7f6e\u754c\u9762\u3002\n<\/p><p>This article covers the following:\n<\/p>\n<ul><li>The IME lifecycle.\n<\/li><li>Declaring IME components in the application manifest.\n<\/li><li>The IME API.\n<\/li><li>Designing an IME UI.\n<\/li><li>Sending text from an IME to an application.\n<\/li><li>Working with IME subtypes.\n<\/li><\/ul>\n<p>If you haven't worked with IMEs before, you should read the introductory article Onscreen Input Methods first. Also, the Soft Keyboard sample app included in the SDK contains sample code that you can modify to start building your own IME.\n<\/p><p>\u672c\u6587\u5305\u62ec\u4ee5\u4e0b\u5185\u5bb9\uff1a\n<\/p>\n<ul><li>IME\u7684\u751f\u547d\u5468\u671f\u3002\n<\/li><li>\u5728\u5e94\u7528\u7a0b\u5e8f\u6e05\u5355\u4e2d\u7684\u58f0\u660eIME\u7ec4\u4ef6\u3002\n<\/li><li>IME\u7684API\u3002\n<\/li><li>\u8bbe\u8ba1\u4e00\u4e2aIME\u7684\u754c\u9762\u3002\n<\/li><li>\u4eceIME\u5411\u5e94\u7528\u7a0b\u5e8f\u53d1\u9001\u6587\u672c\u3002\n<\/li><li>\u4f7f\u7528IME\u7684\u53d8\u79cd\u3002\n<\/li><\/ul>\n<p>\u5982\u679c\u60a8\u4ee5\u524d\u6ca1\u6709\u5f00\u53d1\u8fc7IME\uff0c\u5efa\u8bae\u5148\u9605\u8bfb\u300a\u5c4f\u5e55\u4e0a\u7684\u8f93\u5165\u6cd5\u300b\u8fd9\u4e00\u7ae0\u7684\u4ecb\u7ecd\u3002\u6b64\u5916\uff0c\u60a8\u53ef\u4ee5\u901a\u8fc7\u4fee\u6539SDK\u4e2d\u7684\u8f6f\u952e\u76d8\uff08Soft Keyboard sample\uff09\u5b9e\u4f8b\u4ee3\u7801\u6765\u5f00\u59cb\u5efa\u7acb\u81ea\u5df1\u7684\u8f93\u5165\u6cd5\u5e94\u7528\u3002\n<\/p>\n<h2> <span class=\"mw-headline\" id=\"The_IME_Lifecycle-IME.E7.9A.84.E7.94.9F.E5.91.BD.E5.91.A8.E6.9C.9F\">The IME Lifecycle-IME\u7684\u751f\u547d\u5468\u671f<\/span><\/h2>\n<p>The following diagram describes the life cycle of an IME:\n<\/p><p>IME\u7684\u751f\u547d\u5468\u671f\u5982\u4e0b\u56fe\uff1a\n<\/p><p><img src=\"http:\/\/docs.eoeandroid.com\/resources\/articles\/images\/inputmethod_lifecycle_image.png\" alt=\"inputmethod_lifecycle_image.png\" \/>\n<\/p><p>Figure 1. The life cycle of an IME.\n<\/p><p>The following sections describe how to implement the UI and code associated with an IME that follows this lifecycle.\n<\/p><p>\u4e0b\u9762\u4ecb\u7ecd\u4e86\u600e\u4e48\u6839\u636e\u8f93\u5165\u6cd5\u7684\u751f\u547d\u5468\u671f\u6765\u5b9e\u73b0\u8f93\u5165\u6cd5\u7684\u754c\u9762\u548c\u4ee3\u7801\n<\/p>\n<h2> <span class=\"mw-headline\" id=\"Declaring_IME_Components_in_the_Manifest-IME.E7.9A.84.E7.BB.84.E4.BB.B6.E6.B8.85.E5.8D.95.E4.B8.AD.E5.A3.B0.E6.98.8E\">Declaring IME Components in the Manifest-IME\u7684\u7ec4\u4ef6\u6e05\u5355\u4e2d\u58f0\u660e<\/span><\/h2>\n<p>In the Android system, an IME is an Android application that contains a special IME service. The application's manifest file must declare the service, request the necessary permissions, provide an intent filter that matches the action action.view.InputMethod, and provide metadata that defines characteristics of the IME. In addition, to provide a settings interface that allows the user to modify the behavior of the IME, you can define a \"settings\" activity that can be launched from System Settings.\n<\/p><p>\u5728Android\u7cfb\u7edf\u4e2d\uff0cIME\u662f\u4e00\u4e2aAndroid\u5e94\u7528\u7a0b\u5e8f\u5305\u542b\u4e00\u4e2a\u7279\u6b8a\u7684\u8f93\u5165\u6cd5\u670d\u52a1\u3002\u5e94\u7528\u7a0b\u5e8f\u7684\u6e05\u5355\u6587\u4ef6\u5fc5\u987b\u7533\u62a5\u670d\u52a1\uff0c\u7d22\u53d6\u5fc5\u8981\u7684\u6743\u9650\uff0c\u63d0\u4f9b\u76f8\u5339\u914d\u7684\u884c\u52a8action.view.InputMethod\u610f\u56fe\u8fc7\u6ee4\u5668\uff0c\u5e76\u63d0\u4f9b\u5143\u6570\u636e\u5b9a\u4e49\u8f93\u5165\u6cd5\u7684\u7279\u70b9\u3002\u6b64\u5916\uff0c\u63d0\u4f9b\u4e86\u4e00\u4e2a\u8bbe\u7f6e\u754c\u9762\uff0c\u5141\u8bb8\u7528\u6237\u4fee\u6539\u8f93\u5165\u6cd5\u7684\u884c\u4e3a\uff0c\u4f60\u53ef\u4ee5\u5b9a\u4e49\u4e00\u4e2a\u201c\u8bbe\u7f6e\u201d\u7684\u6d3b\u52a8\uff0c\u53ef\u4ee5\u4ece\u7cfb\u7edf\u8bbe\u7f6e\u63a8\u51fa\u3002\n<\/p><p>The following snippet declares IME service. It requests the permission BIND_INPUT_METHOD to allow the service to connect the IME to the system, sets up an intent filter that matches the action android.view.InputMethod, and defines metadata for the IME:\n<\/p><p>\u4e0b\u9762\u7684\u4ee3\u7801\u7247\u6bb5\u58f0\u660e\u4e86IME\u670d\u52a1\uff0c\u8fd9\u4e2a\u670d\u52a1\u9700\u8981\u901a\u8fc7BIND_INPUT_METHOD\u6743\u9650\u6765\u662f\u7cfb\u7edf\u5141\u8bb8\u5b83\u8fde\u63a5\u7cfb\u7edf\u7684IME\uff08\u8f93\u5165\u6cd5\u670d\u52a1\uff09\u3002\u8fd8\u9700\u8981\u521b\u5efa\u4e00\u4e2a\u5e94\u7b54android.view.InputMethod\u7684\u610f\u56fe\u8fc7\u6ee4\u5668\u4ee5\u53ca\u5b9a\u4e49IME\u7684\u5143\u6570\u636e\uff1a\n<\/p>\n<pre class=\"java\">&#160;\n&lt;!-- Declares the input method service --&gt;\n    &lt;service android:name=<span style=\"color: #ff0000;\">&quot;FastInputIME&quot;<\/span>\n        android:label=<span style=\"color: #ff0000;\">&quot;@string\/fast_input_label&quot;<\/span>\n        android:permission=<span style=\"color: #ff0000;\">&quot;android.permission.BIND_INPUT_METHOD&quot;<\/span>&gt;\n        &lt;intent-filter&gt;\n            &lt;action android:name=<span style=\"color: #ff0000;\">&quot;android.view.InputMethod&quot;<\/span> \/&gt;\n        &lt;\/intent-filter&gt;\n        &lt;meta-data android:name=<span style=\"color: #ff0000;\">&quot;android.view.im&quot;<\/span> android:resource=<span style=\"color: #ff0000;\">&quot;@xml\/method&quot;<\/span> \/&gt;\n    &lt;\/service&gt;\n&#160;<\/pre>\n<p>This next snippet declares the settings activity for the IME. It has an intent filter for ACTION_MAIN that indicates this activity is the main entry point for the IME application:\n<\/p><p>\u63a5\u4e0b\u6765\u7684\u4ee3\u7801\u7247\u6bb5\u58f0\u660e\u4e86\u8bbe\u7f6eIME\u7684Activity\u3002\u4ed6\u6709\u4e00\u4e2a\u5e94\u7b54android.intent.action.MAIN\u7684\u8fc7\u6ee4\u5668\uff0c\u8fd9\u4e2a\u8fc7\u6ee4\u5668\u8868\u660e\u8fd9\u4e2aActivity\u662fIME\u5e94\u7528\u7684\u5165\u53e3\u3002\n<\/p>\n<pre class=\"java\">&#160;\n&lt;!-- Optional: an activity <span style=\"color: #b1b100;\">for<\/span> controlling the IME settings --&gt;\n    &lt;activity android:name=<span style=\"color: #ff0000;\">&quot;FastInputIMESettings&quot;<\/span> \n        android:label=<span style=\"color: #ff0000;\">&quot;@string\/fast_input_settings&quot;<\/span>&gt;\n        &lt;intent-filter&gt;\n            &lt;action android:name=<span style=\"color: #ff0000;\">&quot;android.intent.action.MAIN&quot;<\/span>\/&gt;\n        &lt;\/intent-filter&gt;\n    &lt;\/activity&gt;\n&#160;<\/pre>\n<p>You can also provide access to the IME's settings directly from its UI.\n<\/p><p>\u60a8\u4e5f\u53ef\u4ee5\u628a\u8bbe\u7f6e\u8f93\u5165\u6cd5\u7684\u529f\u80fd\u76f4\u63a5\u653e\u5230\u8f93\u5165\u6cd5\u5e94\u7528\u7684\u754c\u9762\u4e0a\u3002\n<\/p>\n<h2> <span class=\"mw-headline\" id=\"The_Input_Method_API-.E8.BE.93.E5.85.A5.E7.9A.84API\">The Input Method API-\u8f93\u5165\u7684API<\/span><\/h2>\n<p>Classes specific to IMEs are found in the android.inputmethodservice and android.view.inputmethod packages. The KeyEvent class is important for handling keyboard characters.\n<\/p><p>\u5728android.inputmethodservice\u548candroid.view.inputmethod\u5305\u4e0b\u9762\u53ef\u4ee5\u627e\u5230\u5f00\u53d1IME\u6240\u9700\u7684\u7279\u6b8a\u7684\u7c7b\u3002\u6309\u94ae\u4e8b\u4ef6\u7c7b\u5bf9\u4e8e\u5904\u7406\u952e\u76d8\u5b57\u7b26\u7684\u8f93\u5165\u975e\u5e38\u91cd\u8981\u3002\n<\/p><p><br \/>\nThe central part of an IME is a service component, a class that extends InputMethodService. In addition to implementing the normal service lifecycle, this class has callbacks for providing your IME's UI, handling user input, and delivering text to the field that currently has focus. By default, the InputMethodService class provides most of the implementation for managing the state and visibility of the IME and communicating with the current input field.\n<\/p><p>\u4e00\u4e2a\u8f93\u5165\u6cd5\u5e94\u7528\u7684\u6838\u5fc3\u90e8\u5206\u662f\u4e00\u4e2a\u670d\u52a1\u7ec4\u4ef6\uff0c\u8fd9\u662f\u4e00\u4e2a\u7ee7\u627f\u81eaInputMethodService\u7684\u7c7b\u3002\u9664\u4e86\u7ee7\u627f\u901a\u5e38\u7684\u670d\u52a1\u5468\u671f\uff0c\u8fd9\u4e2a\u7c7b\u8fd8\u6709\u63d0\u4f9b\u8f93\u5165\u6cd5\u754c\u9762\u3001\u5904\u7406\u7528\u6237\u8f93\u5165\u3001\u53d1\u9001\u6587\u672c\u5230\u7126\u70b9\u533a\u57df\u7684\u56de\u8c03\u51fd\u6570\u3002\u9ed8\u8ba4\u7684\uff0cInputMethodService\u7c7b\u63d0\u4f9b\u4e86\u5927\u90e8\u5206\u7ba1\u7406\u8f93\u5165\u6cd5\u7684\u72b6\u6001\u3001\u8f93\u5165\u6cd5\u7684\u53ef\u89c1\u6027\u4ee5\u53ca\u4e0e\u5f53\u524d\u7126\u70b9\u533a\u57df\u4ea4\u6d41\u7684\u63a5\u53e3\u3002\n<\/p><p>The following classes are also important:\n<\/p><p>BaseInputConnection\n<\/p>\n<dl><dd>Defines the communication channel from an InputMethod back to the application that is receiving its input. You use it to read text around the cursor, commit text to the text box, and send raw key events to the application. Applications should extend this class rather than implementing the base interface InputConnection.\n<\/dd><\/dl>\n<p>KeyboardView\n<\/p>\n<dl><dd>An extension of View that renders a keyboard and responds to user input events. The keyboard layout is specified by an instance of Keyboard, which you can define in an XML file.\n<\/dd><\/dl>\n<p><br \/>\n<\/p><p>\u4e0b\u9762\u7684\u7c7b\u4e5f\u5f88\u91cd\u8981\uff1a\n<\/p><p>BaseInputConnection  \n<\/p>\n<dl><dd>\u5b9a\u4e49\u4e86\u4ece\u8f93\u5165\u6cd5\u8fd4\u56de\u5230\u5e94\u7528\u540e\u8be5\u5e94\u7528\u63a5\u6536\u8f93\u5165\u6cd5\u8f93\u5165\u4fe1\u606f\u7684\u6e20\u9053\u3002\u60a8\u53ef\u4ee5\u4f7f\u7528\u5b83\u6765\u8bfb\u53d6\u5149\u6807\u5468\u56f4\u7684\u6587\u672c\uff0c\u63d0\u4ea4\u6587\u672c\u6587\u672c\u6846\u5185\u7684\u4fe1\u606f\uff0c\u53d1\u9001\u539f\u751f\u7684\u6309\u94ae\u4e8b\u4ef6\u5230\u5e94\u7528\u3002\u5e94\u7528\u7a0b\u5e8f\u5e94\u8be5\u7ee7\u627f\uff0c\u800c\u4e0d\u662f\u5b9e\u73b0InputConnection\u7c7b\u7684\u63a5\u53e3\u3002\n<\/dd><\/dl>\n<p>KeyboardView\n<\/p>\n<dl><dd>\u67e5\u770b\u6269\u5c55\uff0c\u5448\u73b0\u4e00\u4e2a\u952e\u76d8\u548c\u54cd\u5e94\u7528\u6237\u7684\u8f93\u5165\u4e8b\u4ef6\u3002\u952e\u76d8\u7684\u4e00\u4e2a\u5b9e\u4f8b\uff0c\u60a8\u53ef\u4ee5\u5b9a\u4e49\u5728\u6307\u5b9a\u7684\u952e\u76d8\u5e03\u5c40XML\u6587\u4ef6\u3002\n<\/dd><\/dl>\n<h2> <span class=\"mw-headline\" id=\"Designing_the_Input_Method_UI-.E8.AE.BE.E7.BD.AE.E8.BE.93.E5.85.A5.E6.B3.95.E7.9A.84.E7.95.8C.E9.9D.A2\">Designing the Input Method UI-\u8bbe\u7f6e\u8f93\u5165\u6cd5\u7684\u754c\u9762<\/span><\/h2>\n<p>There are two main visual elements for an IME: the input view and the candidates view. You only have to implement the elements that are relevant to the input method you're designing.\n<\/p><p>\u4e00\u4e2a\u8f93\u5165\u6cd5\u5e94\u7528\u6709\u4e24\u4e2a\u4e3b\u8981\u7684\u754c\u9762\u5143\u7d20\uff1a\u5019\u9009\u5b57\u754c\u9762\u548c\u8f93\u5165\u754c\u9762\u3002\u60a8\u53ea\u9700\u8981\u5b9e\u73b0\u548c\u60a8\u8bbe\u8ba1\u7684\u8f93\u5165\u6cd5\u6709\u5173\u7684\u5143\u7d20\u5373\u53ef\u3002\n<\/p>\n<h3> <span class=\"mw-headline\" id=\"Input_view-.E8.BE.93.E5.85.A5.E6.B3.95.E7.95.8C.E9.9D.A2\">Input view-\u8f93\u5165\u6cd5\u754c\u9762<\/span><\/h3>\n<p>The input view is the UI where the user inputs text, in the form of keyclicks, handwriting or gestures. When the iIME is displayed for the first time, the system calls the onCreateInputView() callback. In your implementation of this method, you create the layout you want to display in the IME window and return the layout to the system. This snippet is an example of implementing the onCreateInputView() method:\n<\/p><p><br \/>\n\u8f93\u5165\u754c\u9762\u662f\u7528\u6237\u8f93\u5165\u901a\u8fc7\u6309\u952e\uff0c\u624b\u5199\u6216\u8005\u624b\u52bf\u8f93\u5165\u6587\u672c\u7684\u754c\u9762\u3002\u5f53\u4e00\u4e2a\u81ea\u5b9a\u4e49\u7684\u8f93\u5165\u6cd5\u7b2c\u4e00\u6b21\u663e\u793a\u7684\u65f6\u5019\uff0c\u7cfb\u7edf\u5c06\u4f1a\u6267\u884conCreateInputView()\u65b9\u6cd5\u3002\u5728\u60a8\u5b9e\u73b0\u8fd9\u65b9\u6cd5\u7684\u65f6\u5019\uff0c\u60a8\u53ef\u4ee5\u521b\u5efa\u4e00\u4e2a\u60f3\u8981\u5728\u8f93\u5165\u6cd5\u7a97\u53e3\u663e\u793a\u7684\u5e03\u5c40\uff0c\u7136\u540e\u8fd4\u56de\u7ed9android\u7cfb\u7edf\u3002\u4e0b\u9762\u7684\u4ee3\u7801\u7247\u6bb5\u662f\u5b9e\u73b0onCreateInputView() \u65b9\u6cd5\u7684\u4e00\u4e2a\u4f8b\u5b50\u3002\n<\/p>\n<pre class=\"java\">&#160;\n    @Override \n    <span style=\"color: #000000; font-weight: bold;\">public<\/span> <a href=\"http:\/\/www.google.com\/search?hl=en&amp;q=allinurl%3AView+java.sun.com&amp;btnI=I%27m%20Feeling%20Lucky\"><span style=\"color: #aaaadd; font-weight: bold;\">View<\/span><\/a> onCreateInputView<span style=\"color: #66cc66;\">&#40;<\/span><span style=\"color: #66cc66;\">&#41;<\/span> <span style=\"color: #66cc66;\">&#123;<\/span> \n        MyKeyboardView inputView = \n            <span style=\"color: #66cc66;\">&#40;<\/span>MyKeyboardView<span style=\"color: #66cc66;\">&#41;<\/span> getLayoutInflater<span style=\"color: #66cc66;\">&#40;<\/span><span style=\"color: #66cc66;\">&#41;<\/span>.<span style=\"color: #006600;\">inflate<\/span><span style=\"color: #66cc66;\">&#40;<\/span> R.<span style=\"color: #006600;\">layout<\/span>.<span style=\"color: #006600;\">input<\/span>, <span style=\"color: #000000; font-weight: bold;\">null<\/span><span style=\"color: #66cc66;\">&#41;<\/span>;\n&#160;\n        inputView.<span style=\"color: #006600;\">setOnKeyboardActionListener<\/span><span style=\"color: #66cc66;\">&#40;<\/span><span style=\"color: #000000; font-weight: bold;\">this<\/span><span style=\"color: #66cc66;\">&#41;<\/span>; inputView.<span style=\"color: #006600;\">setKeyboard<\/span><span style=\"color: #66cc66;\">&#40;<\/span>mLatinKeyboard<span style=\"color: #66cc66;\">&#41;<\/span>; \n&#160;\n        <span style=\"color: #000000; font-weight: bold;\">return<\/span> mInputView; \n    <span style=\"color: #66cc66;\">&#125;<\/span> \n&#160;<\/pre>\n<p>In this example, MyKeyboardView is an instance of a custom implementation of KeyboardView that renders a Keyboard. If you\u2019re building a traditional QWERTY keyboard, see the Soft Keyboard sample app for an example of how to extend the KeyboardView class.\n<\/p><p>\u5728\u8fd9\u4e2a\u4f8b\u5b50\u4e2d\uff0cMyKeyboardView\u662f\u4e00\u4e2a\u7ee7\u627fKeyboardView\u7684\u81ea\u5b9a\u4e49\u63a5\u53e3\u540e\u5b9e\u73b0\u7684\u4e00\u4e2a\u5b9e\u4f8b\uff0c\u5b83\u5448\u73b0\u4e86\u4e00\u4e2a\u952e\u76d8\u3002\u5982\u679c\u60a8\u5728\u521b\u5efa\u4e00\u4e2aQWERTY\u952e\u76d8\uff0c\u60a8\u53ef\u4ee5\u53c2\u7167\u8f6f\u952e\u76d8\u7684\u7b80\u5355\u5b9e\u4f8b\uff08 Soft Keyboard sample app\uff09\u6765\u5b66\u4e60\u600e\u4e48\u7ee7\u627fKeyboardView \u7c7b\u3002\n<\/p>\n<h3> <span class=\"mw-headline\" id=\"Candidates_view-.E5.80.99.E9.80.89.E5.AD.97.E7.95.8C.E9.9D.A2\">Candidates view-\u5019\u9009\u5b57\u754c\u9762<\/span><\/h3>\n<p>The candidates view is the UI where the IME displays potential word corrections or suggestions for the user to select. In the IME lifecycle, the system calls onCreateCandidatesView() when it's ready to display the candidate view. In your implementation of this method, return a layout that shows word suggestions, or return null if you don\u2019t want to show anything (a null response is the default behavior, so you don\u2019t have to implement this if you don\u2019t provide suggestions).\n<\/p><p>\u5019\u9009\u5b57\u754c\u9762\u662f\u8f93\u5165\u6cd5\u663e\u793a\u5019\u9009\u5b57\u6216\u8005\u662f\u8054\u60f3\u5b57\u7684\u754c\u9762\u3002\u5728IME\u7684\u751f\u547d\u5468\u671f\u91cc\uff0c\u5f53IME\u51c6\u5907\u663e\u793a\u5019\u9009\u5b57\u754c\u9762\u7684\u65f6\u5019\uff0c\u7cfb\u7edf\u6216\u8c03\u7528onCreateCandidatesView()\u65b9\u6cd5\u3002\u5728\u60a8\u5b9e\u73b0\u8fd9\u4e2a\u65b9\u6cd5\u7684\u65f6\u5019\uff0c\u8bf7\u8fd4\u56de\u4e00\u4e2a\u663e\u793a\u5019\u9009\u5b57\u6216\u8005\u8054\u60f3\u5b57\u7684\u754c\u9762\uff0c\u6216\u8005\uff0c\u5982\u679c\u60a8\u4e0d\u884c\u663e\u793a\u4ec0\u4e48\u4e1c\u897f\uff0c\u90a3\u8fd4\u56de\u7a7a\u3002\uff08\u6ce8\u610f\uff0c\u8fd9\u4e2a\u65b9\u6cd5\u9ed8\u8ba4\u5c31\u662f\u8fd4\u56de\u7a7a\uff0c\u6240\u4ee5\u5982\u679c\u60a8\u4e0d\u60f3\u63d0\u4f9b\u5019\u9009\u5b57,\u90a3\u4f60\u4e0d\u7528\u5b9e\u73b0\u8fd9\u4e2a\u65b9\u6cd5\u3002\uff09\n<\/p><p>For an example implementation that provides user suggestions, see the Soft Keyboard sample app.\n<\/p><p>\u5b9e\u73b0\u5019\u9009\u5b57\u7684\u5b9e\u4f8b\u8bf7\u67e5\u770bSoft Keyboard sample app\u5de5\u7a0b\u3002\n<\/p>\n<h3> <span class=\"mw-headline\" id=\"UI_design_considerations-.E7.95.8C.E9.9D.A2.E8.AE.BE.E8.AE.A1.E8.A6.81.E7.82.B9\">UI design considerations-\u754c\u9762\u8bbe\u8ba1\u8981\u70b9<\/span><\/h3>\n<p>This section describes some specific UI design considerations for IMEs.\n<\/p><p>\u8fd9\u4e00\u8282\u4ecb\u7ecd\u8f93\u5165\u6cd5\u754c\u9762\u8bbe\u8ba1\u9700\u8981\u6ce8\u610f\u7684\u8981\u70b9\uff1a\n<\/p>\n<h3> <span class=\"mw-headline\" id=\"Handling_multiple_screen_sizes-.E5.A4.9A.E5.88.86.E8.BE.A8.E7.8E.87.E6.94.AF.E6.8C.81\">Handling multiple screen sizes-\u591a\u5206\u8fa8\u7387\u652f\u6301<\/span><\/h3>\n<p>The UI for your IME must be able to scale for different screen sizes, and it also must handle both landscape and portrait orientations. In non-fullscreen IME mode, leave sufficient space for the application to show the text field and any associated context, so that no more than half the screen is occupied by the IME. In fullscreen IME mode this is not an issue.\n<\/p><p>\u8f93\u5165\u6cd5\u754c\u9762\u5fc5\u987b\u53ef\u4ee5\u9002\u5408\u4e0d\u540c\u7684\u5206\u8fa8\u7387\uff0c\u5b83\u4e5f\u5fc5\u987b\u9002\u5e94\u6a2a\u5c4f\u548c\u7ad6\u5c4f\u3002\u5728\u975e\u5168\u5c4f\u6a21\u5f0f\uff0c\u8981\u4e3a\u5e94\u7528\u7559\u51fa\u8db3\u591f\u7684\u7a7a\u95f4\u6765\u663e\u793a\u6587\u672c\u8f93\u5165\u533a\u57df\u548c\u5176\u4ed6\u76f8\u5173\u60c5\u51b5\uff0c\u4ece\u800c\u662f\u8f93\u5165\u6cd5\u754c\u9762\u5360\u7528\u7684\u5c4f\u5e55\u7a7a\u95f4\u5c11\u4e8e\u5c4f\u5e55\u7684\u4e00\u534a\u3002\u5728\u5168\u5c4f\u8f93\u5165\u6cd5\u6a21\u5f0f\u4e0b\u5c31\u4e0d\u7528\u8003\u8651\u8fd9\u4e2a\u95ee\u9898\u4e86\u3002\n<\/p>\n<h3> <span class=\"mw-headline\" id=\"Handling_different_input_types-.E5.A4.84.E7.90.86.E4.B8.8D.E5.90.8C.E7.9A.84.E8.BE.93.E5.85.A5.E7.B1.BB.E5.9E.8B\">Handling different input types-\u5904\u7406\u4e0d\u540c\u7684\u8f93\u5165\u7c7b\u578b<\/span><\/h3>\n<p>Android text fields allow you to set a specific input type, such as free form text, numbers, URLs, email addresses, and search strings. When you implement a new IME, you need to detect the input type of each field and provide the appropriate interface for it. However, you don't have to set up your IME to check that the user entered text that's valid for the input type; that's the responsibility of the application that owns the text field.\n<\/p><p>android\u6587\u672c\u8f93\u5165\u57df\u5141\u8bb8\u7528\u6237\u8f93\u5165\u7279\u5b9a\u7684\u6587\u672c\u7c7b\u578b\uff0c\u6bd4\u5982\u4efb\u4f55\u6587\u672c\u8f93\u5165\u6570\u5b57\u8f93\u5165\uff0cURL\u8f93\u5165\uff0cemail\u8f93\u5165\uff0c\u641c\u7d22\u5b57\u7b26\u4e32\u8f93\u5165\u7b49\u3002\u521b\u5efa\u4e00\u4e2a\u65b0\u7684\u8f93\u5165\u6cd5\u7684\u65f6\u5019\uff0c\u60a8\u9700\u8981\u68c0\u6d4b\u6bcf\u4e00\u4e2a\u8f93\u5165\u6846\u7684\u7c7b\u578b\u5e76\u4e3a\u5b83\u63d0\u4f9b\u6b63\u786e\u7684\u8f93\u5165\uff0c\u7136\u800c\uff0c\u60a8\u4e0d\u5fc5\u8bbe\u7f6e\u60a8\u7684\u8f93\u5165\u6cd5\u6765\u68c0\u67e5\u7528\u6237\u8f93\u5165\u7684\u6587\u672c\u662f\u5426\u7b26\u5408\u6307\u5b9a\u7684\u7c7b\u578b\uff1b\u8fd9\u662f\u90a3\u4e2a\u8f93\u5165\u6846\u6240\u5728\u7684\u5e94\u7528\u7a0b\u5e8f\u7684\u5de5\u4f5c\u3002\n<\/p><p>For example, here are screenshots of the interfaces that the Latin IME provided with the Android platform provides for text and phone number inputs:\n<\/p><p>\u8fd9\u91cc\u662f\u62c9\u4e01\u8f93\u5165\u6cd5\u7684\u63d0\u4f9b\u6587\u672c\u8f93\u5165\u548c\u6570\u5b57\u8f93\u5165\u7684\u622a\u56fe\uff1a\n<\/p><p><img src=\"http:\/\/docs.eoeandroid.com\/resources\/articles\/images\/inputmethod_text_type_screenshot.png\" alt=\"inputmethod_text_type_screenshot.png\" \/>\n<\/p><p><img src=\"http:\/\/docs.eoeandroid.com\/resources\/articles\/images\/inputmethod_numeric_type_screenshot.png\" alt=\"inputmethod_numeric_type_screenshot.png\" \/>\n<\/p><p>Figure 2. Latin IME input types\n<\/p><p>When an input field receives focus and your IME starts, the system calls onStartInputView(), passing in an EditorInfo object that contains details about the input type and other attributes of the text field. In this object, the inputType field contains the text field's input type.\n<\/p><p>\u5f53\u4e00\u4e2a\u8f93\u5165\u57df\u83b7\u5f97\u7126\u70b9\u540e,\u60a8\u7684\u8f93\u5165\u6cd5\u5c31\u4f1a\u5f00\u59cb\u8fd0\u884c\u3002\u7cfb\u7edf\u4f1a\u8c03\u7528onStartInputView()\uff0c\u4f20\u9012\u4e00\u4e2a\u542b\u6709\u8f93\u5165\u7c7b\u578b\u548c\u8f93\u5165\u6846\u5176\u4ed6\u5c5e\u6027\u7684EditorInfo\u5b9e\u4f53\u3002\u5728\u8fd9\u4e2a\u5b9e\u4f53\u4e2d\uff0c\u8f93\u5165\u7c7b\u578b\u57df\u542b\u6709\u8f93\u5165\u57df\u7684\u8f93\u5165\u7c7b\u578b\u3002\n<\/p><p>The inputType field is an int that contains bit patterns for various input type settings. To test it for the text field's input type, mask it with the constant TYPE_MASK_CLASS, like this:\n<\/p><p>\u8f93\u5165\u7c7b\u578b\u57df\u662f\u4e00\u4e2aint\u7c7b\u578b\uff0c\u4ed6\u542b\u6709\u4e00\u4e2a\u6807\u5fd7\u5404\u79cd\u8f93\u5165\u7c7b\u578b\u7684\u4e8c\u8fdb\u5236\u6570\u503c\u3002\u5982\u679c\u60a8\u60f3\u6d4b\u8bd5\u8f93\u5165\u57df\u7c7b\u578b\uff0c\u60a8\u53ef\u4ee5\u4f7f\u7528TYPE_MASK_CLASS\u5e38\u91cf,\u5982\u4e0b\u6240\u793a\n<\/p>\n<pre>\ninputType &amp; InputType.TYPE_MASK_CLASS \n<\/pre>\n<p>The input type bit pattern can have one of several values, including:\n<\/p><p>\u6bcf\u4e00\u4e2a\u4e8c\u8fdb\u5236\u6570\u503c\u53ef\u4ee5\u662f\u4e0b\u9762\u51e0\u4e2a\u503c\u4e2d\u7684\u4e00\u4e2a:\n<\/p><p>TYPE_CLASS_NUMBER\n<\/p>\n<dl><dd>A text field for entering numbers. As illustrated in the previous screen shot, the Latin IME displays a number pad for fields of this type.\n<\/dd><dd>\u8f93\u5165\u6570\u5b57\u7684\u8f93\u5165\u57df\u3002\u5c31\u50cf\u4e0a\u9762\u4ecb\u7ecd\u4e2d\u7684\u622a\u5c4f\u90a3\u6837,\u62c9\u4e01\u8f93\u5165\u6cd5\u5c55\u793a\u8fd9\u6837\u4e00\u79cd\u5b57\u6bcd\u8f93\u5165\u6a21\u7248\u3002\n<\/dd><\/dl>\n<p>TYPE_CLASS_DATETIME\u3002\n<\/p>\n<dl><dd>A text field for entering a date and time.\n<\/dd><dd>\u4e00\u4e2a\u8f93\u5165\u65f6\u95f4\u548c\u65e5\u671f\u7684\u8f93\u5165\u57df\u3002\n<\/dd><\/dl>\n<p>TYPE_CLASS_PHONE\n<\/p>\n<dl><dd>A text field for entering telephone numbers.\n<\/dd><dd>\u4e00\u4e2a\u8f93\u5165\u7535\u8bdd\u53f7\u7801\u7684\u8f93\u5165\u57df\u3002\n<\/dd><\/dl>\n<p>TYPE_CLASS_TEXT\n<\/p>\n<dl><dd>A text field for entering all supported characters.\n<\/dd><dd>\u4e00\u4e2a\u8f93\u5165\u5b57\u7b26\u7684\u8f93\u5165\u57df\u3002\n<\/dd><\/dl>\n<p>These constants are described in more detail in the reference documentation for InputType.\n<\/p><p>\u5728\u8f93\u5165\u7c7b\u578b\u7684\u6587\u6863\u91cc\u9762\u6709\u66f4\u591a\u5173\u4e8e\u8fd9\u4e9b\u5e38\u91cf\u7684\u63cf\u8ff0\u3002\n<\/p><p>The inputType field can contain other bits that indicate a variant of the text field type, such as:\n<\/p><p>\u8f93\u5165\u7c7b\u578b\u6807\u5fd7\u4e5f\u53ef\u4ee5\u662f\u4ece\u8f93\u5165\u57df\u53d8\u5316\u800c\u6765\u7684\u5176\u4ed6\u5e38\u91cf\uff0c\u6bd4\u5982\uff1a\n<\/p><p>TYPE_TEXT_VARIATION_PASSWORD\n<\/p>\n<dl><dd>A variant of TYPE_CLASS_TEXT for entering passwords. The input method will display dingbats instead of the actual text.\n<\/dd><dd>\u4e00\u4e2aTYPE_CLASS_TEXT\u7684\u53d8\u79cd\uff0c\u7528\u6765\u8f93\u5165\u5bc6\u7801\u3002\u8f93\u5165\u7684\u5185\u5bb9\u5c06\u663e\u793a\u4e3a\u70b9\u70b9\u800c\u4e0d\u662f\u771f\u6b63\u7684\u6587\u672c\u3002\n<\/dd><\/dl>\n<p>TYPE_TEXT_VARIATION_URI\n<\/p>\n<dl><dd>A variant of TYPE_CLASS_TEXT for entering web URLs and other Uniform Resource Identifiers (URIs).\n<\/dd><dd>\u4e00\u4e2aTYPE_CLASS_TEXT \u7684\u53d8\u79cd\uff0c\u7528\u6765\u8f93\u5165web URL\u548c\u5176\u4ed6\u7edf\u4e00\u8d44\u6e90\u5b9a\u4f4d\u7b26\uff08URI\uff09\u3002\n<\/dd><\/dl>\n<p>TYPE_TEXT_FLAG_AUTO_COMPLETE\n<\/p><p>\uff1aA variant of TYPE_CLASS_TEXT for entering text that the application \"auto-completes\" from a dictionary, search, or other facility.\n\uff1a\u4e00\u4e2aTYPE_CLASS_TEXT \u7684\u53d8\u79cd\uff0c\u7528\u6765\u8f93\u5165\u5e94\u7528\u7a0b\u5e8f\u901a\u8fc7\u8bcd\u5178\uff0c\u641c\u7d22\u6216\u8005\u5176\u4ed6\u529f\u80fd\u53ef\u4ee5\u81ea\u52a8\u8865\u5168\u7684\u6587\u672c\u3002\n<\/p><p>Remember to mask inputType with the appropriate constant when you test for these variants. The available mask constants are listed in the reference documentation for InputType.\n<\/p><p>\u5f53\u60a8\u6d4b\u8bd5\u8fd9\u4e9b\u53d8\u79cd\u6807\u5fd7\u7684\u65f6\u5019\uff0c\u8bb0\u5f97\u4f7f\u7528\u6b63\u786e\u7684\u5e38\u91cf\u6807\u5fd7\u3002\u8fd9\u4e9b\u5e38\u91cf\u6807\u5fd7\u5728\u8f93\u5165\u7c7b\u578b\u6587\u6863\u91cc\u9762\u6709\u8be6\u7ec6\u8bf4\u660e\u3002\n<\/p>\n<div style=\"margin: 1em 0; padding: 10px; overflow: auto; background: #F7F7F7; border-left:4px solid; border-color:#FF7F00;\">\n<p>Caution: In your own IME, make sure you handle text correctly when you send it to a password field. Hide the password in your UI both in the input view and in the candidates view. Also remember that you shouldn't store passwords on a device. To learn more, see the Designing for Security guide.\n\u6ce8\u610f:\u5728\u60a8\u7684\u8f93\u5165\u6cd5\u4e2d,\u5982\u679c\u9700\u8981\u8f93\u5165\u4fe1\u606f\u5230\u5bc6\u7801\u6846,\u8bf7\u786e\u4fdd\u6587\u5b57\u5904\u7406\u7684\u6b63\u786e\u6027\uff0c\u5728\u60a8\u7684\u8f93\u5165\u754c\u9762\u548c\u5019\u9009\u5b57\u754c\u9762\u90fd\u8981\u9690\u85cf\u5bc6\u7801\u6587\u5b57\u3002\u8bb0\u4f4f\uff0c\u4e0d\u8981\u5728\u4e00\u4e2a\u8bbe\u5907\u4e0a\u50a8\u5b58\u5bc6\u7801\u3002\u66f4\u591a\u4fe1\u606f\u53c2\u9605\u8bbe\u8ba1\u7684\u5b89\u5168\u6027\uff08Designing for Security guide\uff09\u8fd9\u4e00\u8282\u3002\n<\/p>\n<\/div>\n<h2> <span class=\"mw-headline\" id=\"Sending_Text_to_the_Application-.E5.90.91.E5.BA.94.E7.94.A8.E5.8F.91.E9.80.81.E6.96.87.E6.9C.AC\">Sending Text to the Application-\u5411\u5e94\u7528\u53d1\u9001\u6587\u672c<\/span><\/h2>\n<p>As the user inputs text with your IME, you can send text to the application by sending individual key events or by editing the text around the cursor in the application's text field. In either case, you use an instance of InputConnection to deliver the text. To get this instance, call InputMethodService.getCurrentInputConnection().\n<\/p><p>\u5f53\u7528\u6237\u4f7f\u7528\u60a8\u7684\u8f93\u5165\u6cd5\u8f93\u5165\u6587\u672c\u7684\u65f6\u5019\uff0c\u60a8\u53ef\u4ee5\u901a\u8fc7\u4f7f\u7528\u53d1\u9001\u4e2a\u4eba\u6309\u952e\u4e8b\u4ef6\u6216\u8005\u5728\u5e94\u7528\u8f93\u5165\u57df\u7684\u5149\u6807\u5468\u56f4\u7f16\u8f91\u6587\u672c\u7684\u65b9\u5f0f\u6765\u5e94\u7528\u53d1\u9001\u6587\u672c\u3002\u6216\u8005\uff0c\u60a8\u53ef\u4ee5\u4f7f\u7528InputConnection \u7684\u4e00\u4e2a\u5b9e\u4f8b\u6765\u53d1\u9001\u6587\u672c\u3002\u60a8\u53ef\u4ee5\u901a\u8fc7InputMethodService.getCurrentInputConnection()\u6765\u83b7\u53d6\u8fd9\u4e2a\u5b9e\u4f8b\u3002\n<\/p>\n<h3> <span class=\"mw-headline\" id=\"Editing_the_text_around_the_cursor-.E5.9C.A8.E5.85.89.E6.A0.87.E5.91.A8.E5.9B.B4.E7.BC.96.E8.BE.91.E6.96.87.E6.9C.AC\">Editing the text around the cursor-\u5728\u5149\u6807\u5468\u56f4\u7f16\u8f91\u6587\u672c<\/span><\/h3>\n<p>When you're handling the editing of existing text in a text field, some of the more useful methods in BaseInputConnection are:\n<\/p><p>\u5f53\u60a8\u5904\u7406\u6587\u672c\u57df\u5b58\u5728\u7684\u6587\u672c\u7684\u65f6\u5019\uff0cBaseInputConnection\u91cc\u6709\u5f88\u591a\u975e\u5e38\u6709\u7528\u7684\u65b9\u6cd5\uff1a\n<\/p><p>getTextBeforeCursor()\n<\/p>\n<dl><dd>Returns a CharSequence containing the number of requested characters before the current cursor position.\n<\/dd><\/dl>\n<dl><dd>\u8fd4\u56de\u5149\u6807\u6240\u5728\u4f4d\u7f6e\u524d\u9762\u7684n\u4e2a\u5b57\u7b26\u3002\n<\/dd><\/dl>\n<p>getTextAfterCursor()\n<\/p>\n<dl><dd>Returns a CharSequence containing the number of requested characters following the current cursor position.\n<\/dd><\/dl>\n<dl><dd>\u8fd4\u56de\u5149\u6807\u6240\u5728\u4f4d\u7f6e\u540e\u9762\u7684n\u4e2a\u5b57\u7b26\u3002\n<\/dd><\/dl>\n<p>deleteSurroundingText()\n<\/p>\n<dl><dd>Deletes the specified number of characters before and following the current cursor position.\n<\/dd><\/dl>\n<dl><dd>\u5220\u9664\u5149\u6807\u6240\u5728\u4f4d\u7f6e\u5468\u56f4\u7684n\u4e2a\u5b57\u7b26\n<\/dd><\/dl>\n<p>commitText()\n<\/p>\n<dl><dd>Commit a CharSequence to the text field and set a new cursor position.\n<\/dd><\/dl>\n<dl><dd>\u628a\u4e00\u4e2a\u6587\u672c\u63d0\u4ea4\u5230\u6587\u672c\u57df\u5e76\u628a\u5149\u6807\u8bbe\u7f6e\u5230\u65b0\u7684\u4f4d\u7f6e\u3002\n<\/dd><\/dl>\n<p>For example, the following snippet shows how to replace the text \"Fell\" to the left of the with the text \"Hello!\":\n<\/p><p>\u4e0b\u9762\u7684\u4ee3\u7801\u7247\u6bb5\u5c55\u793a\u4e86\u600e\u4e48\u4f7f\u7528\u201cHello\u201d\u6587\u672c\u66ff\u6362\u201cFell\u201d\u7684\u5de6\u8fb9\u3002\n<\/p>\n<pre class=\"java\">&#160;\nInputConnection ic = getCurrentInputConnection<span style=\"color: #66cc66;\">&#40;<\/span><span style=\"color: #66cc66;\">&#41;<\/span>;\n&#160;\n    ic.<span style=\"color: #006600;\">deleteSurroundingText<\/span><span style=\"color: #66cc66;\">&#40;<\/span><span style=\"color: #cc66cc;\">4<\/span>, <span style=\"color: #cc66cc;\">0<\/span><span style=\"color: #66cc66;\">&#41;<\/span>;\n&#160;\n    ic.<span style=\"color: #006600;\">commitText<\/span><span style=\"color: #66cc66;\">&#40;<\/span><span style=\"color: #ff0000;\">&quot;Hello&quot;<\/span>, <span style=\"color: #cc66cc;\">1<\/span><span style=\"color: #66cc66;\">&#41;<\/span>;\n&#160;\n    ic.<span style=\"color: #006600;\">commitText<\/span><span style=\"color: #66cc66;\">&#40;<\/span><span style=\"color: #ff0000;\">&quot;!&quot;<\/span>, <span style=\"color: #cc66cc;\">1<\/span><span style=\"color: #66cc66;\">&#41;<\/span>;\n&#160;<\/pre>\n<h3> <span class=\"mw-headline\" id=\"Composing_text_before_committing-.E5.9C.A8.E6.8F.90.E4.BA.A4.E6.96.87.E6.9C.AC.E4.B9.8B.E5.89.8D.E7.9A.84.E6.92.B0.E5.86.99\">Composing text before committing-\u5728\u63d0\u4ea4\u6587\u672c\u4e4b\u524d\u7684\u64b0\u5199<\/span><\/h3>\n<p>If your IME does text prediction or requires multiple steps to compose a glyph or word, you can show the progress in the text field until the user commits the word, and then you can replace the partial composition with the completed text. You may give special treatment to the text by adding a \"span\" to it when you pass it to InputConnection#setComposingText().\n<\/p><p>\u5982\u679c\u60a8\u7684\u8f93\u5165\u6cd5\u901a\u8fc7\u9700\u8981\u5404\u79cd\u8ba1\u7b97\u6216\u8005\u5404\u79cd\u6309\u952e\u7684\u7ec4\u5408\u6765\u751f\u6210\u5b57\u7b26\u6216\u5355\u8bcd(\u6bd4\u5982\u4e2d\u6587),\u60a8\u53ef\u4ee5\u5148\u5728\u6587\u672c\u57df\u663e\u793a\u8fd9\u4e2a\u8f93\u5165\u8fdb\u5ea6\u76f4\u5230\u7528\u6237\u63d0\u4ea4\u4e86\u8fd9\u4e9b\u6587\u5b57\uff0c\u8fd9\u6837\u60a8\u53ef\u4ee5\u66ff\u6362\u5df2\u7ecf\u5b8c\u6210\u6587\u672c\u7684\u4e00\u90e8\u5206\u3002\u5f53\u60a8\u9700\u8981\u628a\u5b83\u4f20\u9001\u5230InputConnection#setComposingText()\u65f6,\u4f60\u53ef\u4ee5\u901a\u8fc7\u4f7f\u7528\u201c\u95f4\u9694\u201d\u6765\u533a\u522b\u5bf9\u5f85\u3002\n<\/p><p><br \/>\nThe following snippet shows how to show progress in a text field:\n<\/p><p>\u4e0b\u9762\u7684\u4ee3\u7801\u7247\u6bb5\u8bf4\u660e\u4e86\u600e\u4e48\u5728\u8f93\u5165\u57df\u663e\u793a\u8f93\u5165\u7684\u8fdb\u5ea6\u3002\n<\/p>\n<pre class=\"java\">&#160;\nInputConnection ic = getCurrentInputConnection<span style=\"color: #66cc66;\">&#40;<\/span><span style=\"color: #66cc66;\">&#41;<\/span>;\n&#160;\n    ic.<span style=\"color: #006600;\">setComposingText<\/span><span style=\"color: #66cc66;\">&#40;<\/span><span style=\"color: #ff0000;\">&quot;Composi&quot;<\/span>, <span style=\"color: #cc66cc;\">1<\/span><span style=\"color: #66cc66;\">&#41;<\/span>;\n...\n&#160;\n    <span style=\"color: #006600;\">ic<\/span>.<span style=\"color: #006600;\">setComposingText<\/span><span style=\"color: #66cc66;\">&#40;<\/span><span style=\"color: #ff0000;\">&quot;Composin&quot;<\/span>, <span style=\"color: #cc66cc;\">1<\/span><span style=\"color: #66cc66;\">&#41;<\/span>;\n&#160;\n...\n&#160;\n    <span style=\"color: #006600;\">ic<\/span>.<span style=\"color: #006600;\">commitText<\/span><span style=\"color: #66cc66;\">&#40;<\/span><span style=\"color: #ff0000;\">&quot;Composing &quot;<\/span>, <span style=\"color: #cc66cc;\">1<\/span><span style=\"color: #66cc66;\">&#41;<\/span>;\n&#160;<\/pre>\n<p>The following screenshots show how this appears to the user: \n<\/p><p>\u4e0b\u9762\u7684\u622a\u5c4f\u663e\u793a\u8fd9\u5982\u4f55\u5448\u73b0\u7ed9\u7528\u6237\n<\/p><p><img src=\"http:\/\/docs.eoeandroid.com\/resources\/articles\/images\/inputmethod_composing_text_1.png\" alt=\"inputmethod_composing_text_1.png\" \/>\n<img src=\"http:\/\/docs.eoeandroid.com\/resources\/articles\/images\/inputmethod_composing_text_2.png\" alt=\"inputmethod_composing_text_2.png\" \/>\n<img src=\"http:\/\/docs.eoeandroid.com\/resources\/articles\/images\/inputmethod_composing_text_3.png\" alt=\"inputmethod_composing_text_3.png\" \/>\n<\/p><p>Figure 3. Composing text before committing. \n<\/p>\n<h3> <span class=\"mw-headline\" id=\"Intercepting_hardware_key_events-.E6.8B.A6.E6.88.AA.E5.AE.9E.E4.BD.93.E9.94.AE.E7.9B.98.E6.8C.89.E9.92.AE.E4.BA.8B.E4.BB.B6\">Intercepting hardware key events-\u62e6\u622a\u5b9e\u4f53\u952e\u76d8\u6309\u94ae\u4e8b\u4ef6<\/span><\/h3>\n<p>Even though the input method window doesn't have explicit focus, it receives hardware key events first and can choose to consume them or forward them along to the application. For example, you may want to consume the directional keys to navigate within your UI for candidate selection during composition. You may also want to trap the back key to dismiss any popups originating from the input method window.\n<\/p><p>\u5c3d\u7ba1\u8f93\u5165\u6cd5\u7a97\u53e3\u4e0d\u4f1a\u4e89\u593a\u8f93\u5165\u7126\u70b9\uff0c\u4f46\u8f93\u5165\u6cd5\u8fd8\u662f\u4f1a\u5148\u63a5\u53d7\u6765\u81ea\u5b9e\u4f53\u952e\u76d8\u7684\u8f93\u5165\u5e76\u4e14\u53ef\u4ee5\u9009\u62e9\u5ffd\u7565\u4ed6\u4eec\u6216\u8005\u628a\u4ed6\u4eec\u8f6c\u53d1\u7ed9\u5e94\u7528\n<\/p><p><br \/>\nTo intercept hardware keys, override onKeyDown() and onKeyUp(). See the Soft Keyboard sample app for an example.\n<\/p><p>\u5982\u679c\u60a8\u60f3\u62e6\u622a\u5b9e\u4f53\u952e\u76d8\u7684\u8f93\u5165\uff0c\u8bf7\u91cd\u5199onKeyDown() \u548conKeyUp()\u65b9\u6cd5\uff0c\u8be6\u60c5\u53c2\u8003\u952e\u76d8\u8f93\u5165\u5e94\u7528\u3002\n<\/p><p>Remember to call the super() method for keys you don't want to handle yourself.\n<\/p><p>\u5982\u679c\u4e0d\u60f3\u81ea\u5df1\u5904\u7406\u4e00\u4e9b\u6309\u952e\u4e8b\u4ef6\uff0c\u8bb0\u5f97\u8c03\u7528\u6309\u952e\u7684super()\u65b9\u6cd5\u3002\n<\/p>\n<h2> <span class=\"mw-headline\" id=\"Creating_an_IME_Subtype-.E5.88.9B.E5.BB.BA.E4.B8.80.E4.B8.AA.E8.BE.93.E5.85.A5.E6.B3.95.E4.BA.9A.E7.A7.8D\">Creating an IME Subtype-\u521b\u5efa\u4e00\u4e2a\u8f93\u5165\u6cd5\u4e9a\u79cd<\/span><\/h2>\n<p>Subtypes allow the IME to expose multiple input modes and languages supported by an IME. A subtype can represent:\n<\/p><p>\u8f93\u5165\u6cd5\u4e9a\u79cd\u53ef\u4ee5\u662f\u8f93\u5165\u6cd5\u6267\u884c\u51e0\u79cd\u4e0d\u540c\u7684\u8f93\u5165\u6a21\u5f0f\u4e5f\u53ef\u4ee5\u652f\u6301\u591a\u79cd\u8bed\u8a00(\u6bd4\u5982\u641c\u72d7\u8f93\u5165\u6cd5\u7684\u4e2d\u82f1\u6587\u5207\u6362)\u3002\u4e00\u4e2a\u4e9a\u79cd\u53ef\u4ee5\u662f\uff1a\n<\/p>\n<ul><li>A locale such as en_US or fr_FR\n<\/li><\/ul>\n<ul><li>\u4e00\u79cd\u8bed\u8a00\u73af\u5883\u6bd4\u5982en_US\u6216\u8005fr_FR\n<\/li><\/ul>\n<p><br \/>\n<\/p>\n<ul><li>An input mode such as voice, keyboard, or handwriting\n<\/li><\/ul>\n<ul><li>\u4e00\u79cd\u8f93\u5165\u6a21\u5f0f\u6bd4\u5982\u58f0\u97f3\u952e\u76d8\u6216\u8005\u624b\u5199\u8f93\u5165\n<\/li><\/ul>\n<p><br \/>\n<\/p>\n<ul><li>Other input styles, forms, or properties specific to the IME, such as 10-key or qwerty keyboard layouts.\n<\/li><\/ul>\n<ul><li>\u5176\u4ed6\u8f93\u5165\u6837\u5f0f\uff0c\u8f93\u5165\u5f62\u5f0f\u6216\u8005\u8f93\u5165\u6cd5\u7684\u7279\u6b8a\u5c5e\u6027\uff0c\u6bd4\u598210\u6309\u952e\u6216\u8005qwerty\u952e\u76d8\u5e03\u5c40\u3002\n<\/li><\/ul>\n<p><br \/>\nBasically, the mode can be any text such as \"keyboard\", \"voice\", and so forth.\n<\/p><p>\u57fa\u672c\u4e0a\u8fd9\u4e9b\u6a21\u5f0f\u53ef\u4ee5\u662f\u952e\u76d8\u8f93\u5165\uff0c\u8bed\u97f3\u8f93\u5165\u7b49\u7b49\u3002\n<\/p><p>A subtype can also expose a combination of these.\n<\/p><p>\u4e00\u4e2a\u4e9a\u79cd\u4e5f\u53ef\u4ee5\u4e0a\u9762\u51e0\u79cd\u7684\u6df7\u5408\u3002\n<\/p><p>Subtype information is used for an IME switcher dialog that's available from the notification bar and also for IME settings. The information also allows the framework to bring up a specific subtype of an IME directly. When you build an IME, use the subtype facility, because it helps the user identify and switch between different IME languages and modes.\n<\/p><p>\u8f93\u5165\u6cd5\u5207\u6362\u7a97\u53e3\u9700\u8981\u8f93\u5165\u6cd5\u4e9a\u79cd\u4fe1\u606f\uff0c\u8fd9\u4e9b\u4fe1\u606f\u53ef\u4ee5\u4ece\u901a\u77e5\u680f\u6216\u8005\u8f93\u5165\u6cd5\u8bbe\u7f6e\u91cc\u5f97\u5230\u3002\u8fd9\u4e9b\u4fe1\u606f\u4e5f\u4f7f\u5f97\u7cfb\u7edf\u6846\u67b6\u53ef\u4ee5\u76f4\u63a5\u9009\u62e9\u5176\u4e2d\u7684\u4e00\u79cd\u7279\u5b9a\u7684\u8f93\u5165\u6cd5\u4e9a\u79cd\u3002\u5f53\u60a8\u521b\u5efa\u8f93\u5165\u6cd5\u7684\u65f6\u5019\uff0c\u8bf7\u4f7f\u7528\u4e9a\u79cd\u529f\u80fd\uff0c\u56e0\u4e3a\u4ed6\u53ef\u4ee5\u5e2e\u52a9\u7528\u6237\u66f2\u522b\u548c\u5207\u6362\u4e0d\u540c\u7684\u8bed\u8a00\u548c\u4e0d\u540c\u7684\u6a21\u5f0f\u3002\n<\/p><p>You define subtypes in one of the input method's XML resource files, using the &lt;subtype&gt; element. The following snippet defines an IME with two subtypes: a keyboard subtype for the US English locale, and another keyboard subtype for the French language locale for France:\n<\/p><p>\u4f60\u53ef\u4ee5\u4f7f\u7528&lt;subtype&gt;\u5728\u4e00\u4e2axml\u8d44\u6e90\u6587\u4ef6\u91cc\u5b9a\u4e49\u4e9a\u79cd\u3002\u4e0b\u9762\u7684\u4ee3\u7801\u7247\u6bb5\u5b9a\u4e49\u4e86\u4e24\u79cd\u8f93\u5165\u6cd5\u4e9a\u79cd\uff1a\u4e00\u79cd\u662f\u7f8e\u56fd\u82f1\u8bed\u8bed\u8a00\u73af\u5883\uff0c\u53e6\u4e00\u4e2d\u662f\u6cd5\u56fd\u6cd5\u8bed\u8bed\u8a00\u73af\u5883\u3002\n<\/p>\n<pre class=\"java\">&#160;\n&lt;input-method xmlns:android=<span style=\"color: #ff0000;\">&quot;http:\/\/schemas.android.com\/apk\/res\/android&quot;<\/span>\n        android:settingsActivity=<span style=\"color: #ff0000;\">&quot;com.example.softkeyboard.Settings&quot;<\/span>\n        android:icon=<span style=\"color: #ff0000;\">&quot;@drawable\/ime_icon&quot;<\/span>\n    &lt;subtype android:name=<span style=\"color: #ff0000;\">&quot;@string\/display_name_english_keyboard_ime&quot;<\/span>\n            android:icon=<span style=\"color: #ff0000;\">&quot;@drawable\/subtype_icon_english_keyboard_ime&quot;<\/span>\n            android:imeSubtypeLanguage=<span style=\"color: #ff0000;\">&quot;en_US&quot;<\/span>\n            android:imeSubtypeMode=<span style=\"color: #ff0000;\">&quot;keyboard&quot;<\/span>\n            android:imeSubtypeExtraValue=<span style=\"color: #ff0000;\">&quot;somePrivateOption=true&quot;<\/span>\n    \/&gt;\n    &lt;subtype android:name=<span style=\"color: #ff0000;\">&quot;@string\/display_name_french_keyboard_ime&quot;<\/span>\n            android:icon=<span style=\"color: #ff0000;\">&quot;@drawable\/subtype_icon_french_keyboard_ime&quot;<\/span>\n            android:imeSubtypeLanguage=<span style=\"color: #ff0000;\">&quot;fr_FR&quot;<\/span>\n            android:imeSubtypeMode=<span style=\"color: #ff0000;\">&quot;keyboard&quot;<\/span>\n            android:imeSubtypeExtraValue=<span style=\"color: #ff0000;\">&quot;foobar=30,someInternalOption=false&quot;<\/span>\n    \/&gt;\n    &lt;subtype android:name=<span style=\"color: #ff0000;\">&quot;@string\/display_name_german_keyboard_ime&quot;<\/span>\n            ...\n    \/&gt;\n\/&gt;\n&#160;<\/pre>\n<p>To ensure that your subtypes are labeled correctly in the UI, use&#160;%s to get a subtype label that is the same as the subtype\u2019s locale label. This is demonstrated in the next two snippets. The first snippet shows part of the input method's XML file:\n<\/p><p>\u4e3a\u4e86\u786e\u4fdd\u60a8\u7684\u8f93\u5165\u6cd5\u4e9a\u79cd\u5728\u754c\u9762\u4e0a\u7684\u6807\u7b7e\u6b63\u786e\uff0c\u8bf7\u4f7f\u7528%s\u6765\u83b7\u53d6\u4e00\u4e2a\u548c\u4e9a\u79cd\u672c\u5730\u6807\u7b7e\u76f8\u540c\u7684\u4e9a\u79cd\u6807\u7b7e\u3002\u5982\u4e0b\u9762\u7684\u4e24\u4e2a\u4ee3\u7801\u7247\u6bb5\uff1a\u7b2c\u4e00\u4e2a\u4ee3\u7801\u7247\u6bb5\u5c55\u793a\u4e86\u8f93\u5165\u6cd5xml\u6587\u4ef6\u7684\u4e00\u90e8\u5206\uff1a\n<\/p>\n<pre class=\"java\">&#160;\n&lt;subtype\n        android:label=<span style=\"color: #ff0000;\">&quot;@string\/label_subtype_generic&quot;<\/span>\n        android:imeSubtypeLocale=<span style=\"color: #ff0000;\">&quot;en_US&quot;<\/span>\n        android:icon=<span style=\"color: #ff0000;\">&quot;@drawable\/icon_en_us&quot;<\/span>\n        android:imeSubtypeMode=<span style=\"color: #ff0000;\">&quot;keyboard&quot;<\/span> \/&gt;\n&#160;<\/pre>\n<p>The next snippet is part of the IME's strings.xml file. The string resource label_subtype_generic, which is used by the input method UI definition to set the subtype's label, is defined as:\n<\/p><p>\u4e0b\u4e00\u4e2a\u7247\u6bb5\u662f\u8f93\u5165\u6cd5\u7684strings.xml\u6587\u4ef6\u7684\u4e00\u90e8\u5206\u3002\u8fd9\u4e2a\u5b57\u7b26\u4e32\u8d44\u6e90 \u201clabel_subtype_generic\u201d\u88ab\u8f93\u5165\u6cd5\u754c\u9762\u7528\u6765\u5b9a\u4e49\u4e9a\u79cd\u6807\u7b7e\uff0c\u4ed6\u8fd9\u6837\u88ab\u5b9a\u4e49\uff1a\n<\/p>\n<pre>\n&lt;string name=&quot;label_subtype_generic&quot;&gt;%s&lt;\/string&gt;\n<\/pre>\n<p>This sets the subtype\u2019s display name to \u201cEnglish (United States)\u201d in any English language locale, or to the appropriate localization in other locales.\n<\/p><p>\u8fd9\u4e2a\u8bbe\u7f6e\u4e86\u5728\u4efb\u4f55\u82f1\u6587\u8bed\u8a00\u73af\u5883\u4f7f\u7528\u201c\u7f8e\u5f0f\u82f1\u8bed\u201d\u6216\u8005\u5728\u5176\u4ed6\u8bed\u8a00\u73af\u5883\u4f7f\u7528\u6070\u5f53\u7684\u8bed\u8a00\u3002\n<\/p>\n<h3> <span class=\"mw-headline\" id=\"Choosing_IME_subtypes_from_the_notification_bar-.E9.80.9A.E8.BF.87.E9.80.9A.E7.9F.A5.E6.A0.8F.E9.80.89.E6.8B.A9.E8.BE.93.E5.85.A5.E6.B3.95.E7.9A.84.E4.BA.9A.E7.A7.8D\">Choosing IME subtypes from the notification bar-\u901a\u8fc7\u901a\u77e5\u680f\u9009\u62e9\u8f93\u5165\u6cd5\u7684\u4e9a\u79cd<\/span><\/h3>\n<p>The Android system manages all subtypes exposed by all IMEs. IME subtypes are treated as modes of the IME they belong to. In the notification bar, a user can select an available subtype for the currently-set IME, as shown in the following screenshot:\n<\/p><p>android\u7cfb\u7edf\u53ef\u4ee5\u7ba1\u7406\u8f93\u5165\u6cd5\u66b4\u9732\u7684\u6240\u6709\u8f93\u5165\u6cd5\u4e9a\u79cd\u3002\u8f93\u5165\u6cd5\u4e9a\u79cd\u88ab\u770b\u4f5c\u662f\u4ed6\u4eec\u6240\u5c5e\u8f93\u5165\u6cd5\u7684\u4e00\u79cd\u6a21\u5f0f\u3002\u5728\u901a\u77e5\u680f\uff0c\u4e00\u4e2a\u7528\u6237\u53ef\u4ee5\u5f53\u524d\u8f93\u5165\u6cd5\u7684\u9009\u62e9\u4e00\u79cd\u8f93\u5165\u6a21\u5f0f\uff0c\u5c31\u4e0b\u9762\u7684\u622a\u56fe\uff1a\n<\/p><p><img src=\"http:\/\/docs.eoeandroid.com\/resources\/articles\/images\/inputmethod_subtype_notification.png\" alt=\"inputmethod_subtype_notification.png\" \/>\n<\/p><p>Figure 4. Choosing an IME subtype from the notification bar\n<\/p><p><img src=\"http:\/\/docs.eoeandroid.com\/resources\/articles\/images\/inputmethod_subtype_preferences.png\" alt=\"inputmethod_subtype_preferences.png\" \/>\n<\/p><p>Figure 5. Setting subtype preferences in System Settings\n<\/p>\n<h3> <span class=\"mw-headline\" id=\"Choosing_IME_subtypes_from_System_Settings-.E9.80.9A.E8.BF.87.E7.B3.BB.E7.BB.9F.E8.AE.BE.E7.BD.AE.E9.80.89.E6.8B.A9.E8.BE.93.E5.85.A5.E6.B3.95.E4.BA.9A.E7.A7.8D\">Choosing IME subtypes from System Settings-\u901a\u8fc7\u7cfb\u7edf\u8bbe\u7f6e\u9009\u62e9\u8f93\u5165\u6cd5\u4e9a\u79cd<\/span><\/h3>\n<p>A user can control how subtypes are used in the \u201cLanguage &amp; input\u201d settings panel in the System Settings area. In the Soft Keyboard sample, the file InputMethodSettingsFragment.java contains an implementation that facilitates a subtype enabler in the IME settings. Please refer to the SoftKeyboard sample in the Android SDK for more information about how to support Input Method Subtypes in your IME.\n<\/p><p>\u7528\u6237\u53ef\u4ee5\u5728\u8bbe\u7f6e\u7684\"\u8bed\u8a00\u548c\u8f93\u5165\"\u8bbe\u7f6e\u680f\u91cc\u8bbe\u7f6e\u8f93\u5165\u6cd5\u4e9a\u79cd\u3002\u5728\u8f6f\u952e\u76d8\u4f8b\u5b50\u4e2d\uff0cInputMethodSettingsFragment.java \u6587\u4ef6\u5b9e\u73b0\u4e86\u5728\u8f93\u5165\u6cd5\u8bbe\u7f6e\u4e2d\u663e\u793a\u8f93\u5165\u6cd5\u4e9a\u79cd\u8fd9\u4e2a\u529f\u80fd\u3002\u8bf7\u66f4\u591a\u4fe1\u606f\u8bf7\u53c2\u9605android SDK\u7684\u8f6f\u952e\u76d8\u4f8b\u5b50\u3002\n<\/p><p><img src=\"http:\/\/docs.eoeandroid.com\/resources\/articles\/images\/inputmethod_subtype_settings.png\" alt=\"inputmethod_subtype_settings.png\" \/>\n<\/p><p>Figure 6. Choosing a language for the IME\n<\/p>\n<h2> <span class=\"mw-headline\" id=\"General_IME_Considerations-.E5.88.9B.E5.BB.BA.E8.BE.93.E5.85.A5.E6.B3.95.E5.BA.94.E7.94.A8.E7.9A.84.E6.B3.A8.E6.84.8F.E4.BA.8B.E9.A1.B9\">General IME Considerations-\u521b\u5efa\u8f93\u5165\u6cd5\u5e94\u7528\u7684\u6ce8\u610f\u4e8b\u9879<\/span><\/h2>\n<p>Here are some other things to consider as you're implementing your IME:\n<\/p><p>\u8fd9\u91cc\u662f\u60a8\u521b\u5efa\u8f93\u5165\u6cd5\u5e94\u7528\u9700\u8981\u6ce8\u610f\u7684\u5176\u4ed6\u4e8b\u9879\uff1a\n<\/p>\n<ul><li>Provide a way for users to set options directly from the IME's UI.\n<\/li><\/ul>\n<ul><li>\u4e3a\u7528\u6237\u63d0\u4f9b\u4e00\u4e2a\u53ef\u4ee5\u5728\u8f93\u5165\u6cd5\u754c\u9762\u76f4\u63a5\u8bbe\u7f6e\u8f93\u5165\u6cd5\u7684\u65b9\u6cd5\u3002\n<\/li><\/ul>\n<p><br \/>\n<\/p>\n<ul><li>Because multiple IMEs may be installed on the device, provide a way for the user to switch to a different IME directly from the input method UI.\n<\/li><\/ul>\n<ul><li>\u7531\u4e8e\u8f93\u5165\u6cd5\u53ef\u80fd\u9700\u8981\u5b89\u88c5\u5230\u8bbe\u5907\u4e0a\uff0c\u8bf7\u4e3a\u7528\u6237\u63d0\u4f9b\u4e00\u4e2a\u65b9\u6cd5\u6765\u76f4\u63a5\u5728\u8f93\u5165\u754c\u9762\u5207\u6362\u4e0d\u540c\u7684\u8f93\u5165\u6cd5\n<\/li><\/ul>\n<p><br \/>\n<\/p>\n<ul><li>Bring up the IME's UI quickly. Preload or load on demand any large resources so that users see the IME as soon as they tap on a text field. Cache resources and views for subsequent invocations of the input method.\n<\/li><\/ul>\n<ul><li>\u8f93\u5165\u6cd5\u754c\u9762\u9700\u8981\u53cd\u5e94\u8fc5\u901f\u3002\u63d0\u524d\u8f7d\u5165\u6216\u8005\u53ea\u8f7d\u5165\u9700\u8981\u7684\u5927\u7684\u754c\u9762\u8d44\u6e90\uff0c\u8fd9\u6837\u7528\u6237\u4e00\u70b9\u51fb\u6587\u672c\u6846\u5c31\u53ef\u4ee5\u770b\u5230\u3002\u4e3a\u4e86\u540c\u6837\u7684\u76ee\u7684\uff0c\u53ef\u4ee5\u5bf9\u8f93\u5165\u6cd5\u540e\u7eed\u7528\u5230\u7684\u8d44\u6e90\u548c\u89c6\u56fe\u8fdb\u884c\u7f13\u5b58\u3002\n<\/li><\/ul>\n<p><br \/>\n<\/p>\n<ul><li>Conversely, you should release large memory allocations soon after the input method window is hidden, so that applications can have sufficient memory to run. Consider using a delayed message to release resources if the IME is in a hidden state for a few seconds.\n<\/li><\/ul>\n<ul><li>\u76f8\u53cd\u7684\uff0c\u5f53\u8f93\u5165\u6cd5\u7a97\u53e3\u9690\u85cf\u7684\u65f6\u5019\uff0c\u60a8\u5e94\u8be5\u91ca\u653e\u4e3a\u8f93\u5165\u6cd5\u5206\u914d\u7684\u5185\u5b58\uff0c\u8fd9\u6837\u5e94\u7528\u53ef\u4ee5\u6709\u8db3\u591f\u7684\u5185\u5b58\u6765\u8fd0\u884c\u3002\u5982\u679c\u8f93\u5165\u6cd5\u5904\u4e8e\u9690\u85cf\u72b6\u6001\u9700\u8981\u51e0\u79d2\u949f\uff0c\u90a3\u60a8\u9700\u8981\u8003\u8651\u4f7f\u7528\u4e00\u4e2a\u5ef6\u8fdf\u6d88\u606f\u6765\u91ca\u653e\u8d44\u6e90\u3002\n<\/li><\/ul>\n<p><br \/>\n<\/p>\n<ul><li>Make sure that users can enter as many characters as possible for the language or locale associated with the IME. Remember that users may use punctuation in passwords or user names, so your IME has to provide many different characters to allow users to enter a password and get access to the device.\n<\/li><\/ul>\n<ul><li>\u8bf7\u786e\u4fdd\u7528\u6237\u53ef\u4ee5\u5c3d\u53ef\u80fd\u591a\u7684\u8f93\u5165\u8fd9\u79cd\u8f93\u5165\u6cd5\u9700\u8981\u8f93\u5165\u7684\u8bed\u8a00\u7684\u5b57\u7b26\u3002\u8bb0\u4f4f\uff0c\u7528\u6237\u53ef\u80fd\u9700\u8981\u8f93\u5165\u7528\u6237\u540d\u548c\u5bc6\u7801\uff0c\u6240\u4ee5\u60a8\u7684\u8f93\u5165\u6cd5\u5fc5\u987b\u63d0\u4f9b\u5404\u79cd\u4e0d\u540c\u7684\u5b57\u7b26\uff0c\u4f7f\u7528\u6237\u53ef\u4ee5\u60f3\u8bbe\u5907\u8f93\u5165\u5bc6\u7801\u3002\n<\/li><\/ul>"}