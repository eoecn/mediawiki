{"title":"App Widgets","text":"<p>\u8d1f\u8d23\u4eba\uff1a\u02cb\u25c7Aduil\ufe4e\n<\/p><p>\u539f\u6587\u5730\u5740\uff1a<a rel=\"nofollow\" target=\"_blank\" class=\"external free\" href=\"http:\/\/docs.eoeandroid.com\/guide\/topics\/appwidgets\/index.html\">http:\/\/docs.eoeandroid.com\/guide\/topics\/appwidgets\/index.html<\/a>\n<\/p>\n<table id=\"toc\" class=\"toc\"><tr><td><div id=\"toctitle\"><h2>\u76ee\u5f55<\/h2><\/div>\n<ul>\n<li class=\"toclevel-1 tocsection-1\"><a href=\"#.E5.BE.AE.E5.B0.8F.E7.9A.84.E5.BA.94.E7.94.A8.E7.A8.8B.E5.BA.8F.E8.A7.86.E5.9B.BE-App_Widgets\"><span class=\"tocnumber\">1<\/span> <span class=\"toctext\">\u5fae\u5c0f\u7684\u5e94\u7528\u7a0b\u5e8f\u89c6\u56fe-App Widgets<\/span><\/a>\n<ul>\n<li class=\"toclevel-2 tocsection-2\"><a href=\"#.E5.9F.BA.E7.A1.80.E7.9F.A5.E8.AF.86-The_Basics\"><span class=\"tocnumber\">1.1<\/span> <span class=\"toctext\">\u57fa\u7840\u77e5\u8bc6-The Basics<\/span><\/a><\/li>\n<li class=\"toclevel-2 tocsection-3\"><a href=\"#Declaring_an_App_Widget_in_the_Manifest\"><span class=\"tocnumber\">1.2<\/span> <span class=\"toctext\">Declaring an App Widget in the Manifest<\/span><\/a><\/li>\n<li class=\"toclevel-2 tocsection-4\"><a href=\"#Adding_the_AppWidgetProviderInfo_Metadata\"><span class=\"tocnumber\">1.3<\/span> <span class=\"toctext\">Adding the AppWidgetProviderInfo Metadata<\/span><\/a><\/li>\n<li class=\"toclevel-2 tocsection-5\"><a href=\"#Creating_the_App_Widget_Layout\"><span class=\"tocnumber\">1.4<\/span> <span class=\"toctext\">Creating the App Widget Layout<\/span><\/a>\n<ul>\n<li class=\"toclevel-3 tocsection-6\"><a href=\"#Adding_margins_to_App_Widgets\"><span class=\"tocnumber\">1.4.1<\/span> <span class=\"toctext\">Adding margins to App Widgets<\/span><\/a><\/li>\n<\/ul>\n<\/li>\n<li class=\"toclevel-2 tocsection-7\"><a href=\"#Using_the_AppWidgetProvider_Class\"><span class=\"tocnumber\">1.5<\/span> <span class=\"toctext\">Using the AppWidgetProvider Class<\/span><\/a>\n<ul>\n<li class=\"toclevel-3 tocsection-8\"><a href=\"#Receiving_App_Widget_broadcast_Intents\"><span class=\"tocnumber\">1.5.1<\/span> <span class=\"toctext\">Receiving App Widget broadcast Intents<\/span><\/a><\/li>\n<\/ul>\n<\/li>\n<li class=\"toclevel-2 tocsection-9\"><a href=\"#Creating_an_App_Widget_Configuration_Activity\"><span class=\"tocnumber\">1.6<\/span> <span class=\"toctext\">Creating an App Widget Configuration Activity<\/span><\/a>\n<ul>\n<li class=\"toclevel-3 tocsection-10\"><a href=\"#Updating_the_App_Widget_from_the_configuration_Activity\"><span class=\"tocnumber\">1.6.1<\/span> <span class=\"toctext\">Updating the App Widget from the configuration Activity<\/span><\/a><\/li>\n<\/ul>\n<\/li>\n<li class=\"toclevel-2 tocsection-11\"><a href=\"#Setting_a_Preview_Image\"><span class=\"tocnumber\">1.7<\/span> <span class=\"toctext\">Setting a Preview Image<\/span><\/a><\/li>\n<li class=\"toclevel-2 tocsection-12\"><a href=\"#Using_App_Widgets_with_Collections\"><span class=\"tocnumber\">1.8<\/span> <span class=\"toctext\">Using App Widgets with Collections<\/span><\/a>\n<ul>\n<li class=\"toclevel-3 tocsection-13\"><a href=\"#Sample_application\"><span class=\"tocnumber\">1.8.1<\/span> <span class=\"toctext\">Sample application<\/span><\/a><\/li>\n<li class=\"toclevel-3 tocsection-14\"><a href=\"#Implementing_app_widgets_with_collections\"><span class=\"tocnumber\">1.8.2<\/span> <span class=\"toctext\">Implementing app widgets with collections<\/span><\/a><\/li>\n<li class=\"toclevel-3 tocsection-15\"><a href=\"#Manifest_for_app_widgets_with_collections\"><span class=\"tocnumber\">1.8.3<\/span> <span class=\"toctext\">Manifest for app widgets with collections<\/span><\/a><\/li>\n<li class=\"toclevel-3 tocsection-16\"><a href=\"#Layout_for_app_widgets_with_collections\"><span class=\"tocnumber\">1.8.4<\/span> <span class=\"toctext\">Layout for app widgets with collections<\/span><\/a><\/li>\n<li class=\"toclevel-3 tocsection-17\"><a href=\"#AppWidgetProvider_class_for_app_widgets_with_collections\"><span class=\"tocnumber\">1.8.5<\/span> <span class=\"toctext\">AppWidgetProvider class for app widgets with collections<\/span><\/a><\/li>\n<li class=\"toclevel-3 tocsection-18\"><a href=\"#RemoteViewsService_class\"><span class=\"tocnumber\">1.8.6<\/span> <span class=\"toctext\">RemoteViewsService class<\/span><\/a><\/li>\n<li class=\"toclevel-3 tocsection-19\"><a href=\"#RemoteViewsFactory_interface\"><span class=\"tocnumber\">1.8.7<\/span> <span class=\"toctext\">RemoteViewsFactory interface<\/span><\/a><\/li>\n<li class=\"toclevel-3 tocsection-20\"><a href=\"#Adding_behavior_to_individual_items\"><span class=\"tocnumber\">1.8.8<\/span> <span class=\"toctext\">Adding behavior to individual items<\/span><\/a><\/li>\n<li class=\"toclevel-3 tocsection-21\"><a href=\"#Setting_up_the_pending_intent_template\"><span class=\"tocnumber\">1.8.9<\/span> <span class=\"toctext\">Setting up the pending intent template<\/span><\/a><\/li>\n<li class=\"toclevel-3 tocsection-22\"><a href=\"#Setting_the_fill-in_Intent\"><span class=\"tocnumber\">1.8.10<\/span> <span class=\"toctext\">Setting the fill-in Intent<\/span><\/a><\/li>\n<li class=\"toclevel-3 tocsection-23\"><a href=\"#Keeping_Collection_Data_Fresh\"><span class=\"tocnumber\">1.8.11<\/span> <span class=\"toctext\">Keeping Collection Data Fresh<\/span><\/a><\/li>\n<\/ul>\n<\/li>\n<\/ul>\n<\/li>\n<\/ul>\n<\/td><\/tr><\/table>\n<h1> <span class=\"mw-headline\" id=\".E5.BE.AE.E5.B0.8F.E7.9A.84.E5.BA.94.E7.94.A8.E7.A8.8B.E5.BA.8F.E8.A7.86.E5.9B.BE-App_Widgets\">\u5fae\u5c0f\u7684\u5e94\u7528\u7a0b\u5e8f\u89c6\u56fe-App Widgets<\/span><\/h1>\n<div style=\"width:310px; float:right; background-color: white; margin: 0px 0 2px 0; padding: 0 0 20px 35px;\">\n<div style=\"width:292px; float:right;border:4px solid #DEE8F1; padding:0 10px 10px\">\n<p>\u5feb\u901f\u6d4f\u89c8\n<\/p>\n<hr \/>\n<ul><li>App Widgets\u63d0\u4f9b\u4e00\u4e9b\u7528\u6237\u76f4\u63a5\u4ece\u4e3b\u5c4f\u5e55\u8bbf\u95ee\u60a8\u7684\u5e94\u7528\u7a0b\u5e8f\u529f\u80fd(\u800c\u4e0d\u9700\u8981\u542f\u52a8\u4e00\u4e2aActivity) \n<\/li><li>App Widgets\u652f\u6301\u4e86\u4e00\u79cd\u7279\u6b8a\u7684\u5e7f\u64ad\u63a5\u6536\u673a\u5904\u7406AppWidget\u751f\u547d\u5468\u671f\n<\/li><\/ul>\n<p>\u5728\u672c\u6587\u6863\n<\/p>\n<hr \/>\n<p><a href=\"#.E5.9F.BA.E7.A1.80.E7.9F.A5.E8.AF.86-The_Basics\">\u57fa\u7840\u77e5\u8bc6-The Basics<\/a><br \/>\n<a href=\"#Declaring_an_App_Widget_in_the_Manifest\">Declaring an App Widget in the Manifest<\/a><br \/>\n<a href=\"#Adding_the_AppWidgetProviderInfo_Metadata\">Adding the AppWidgetProviderInfo Metadata<\/a><br \/>\n<a href=\"#Creating_the_App_Widget_Layout\">Creating the App Widget Layout<\/a><br \/>\n<a href=\"#Using_the_AppWidgetProvider_Class\">Using the AppWidgetProvider Class<\/a><br \/>\n<\/p>\n<dl><dd><a href=\"#Receiving_App_Widget_broadcast_Intents\">Receiving App Widget broadcast Intents<\/a><br \/>\n<\/dd><\/dl>\n<p><a href=\"#Creating_an_App_Widget_Configuration_Activity\">Creating an App Widget Configuration Activity <\/a><br \/>\n<\/p>\n<dl><dd><a href=\"#Updating_the_App_Widget_from_the_configuration_Activity\">Updating the App Widget from the configuration Activity<\/a><br \/>\n<\/dd><\/dl>\n<p><a href=\"#Setting_a_Preview_Image\">Setting a Preview Image<\/a><br \/>\n<a href=\"#Using_App_Widgets_with_Collections\">Using App Widgets with Collections <\/a><br \/>\n<\/p>\n<dl><dd><a href=\"#Sample_application\">Sample application<\/a><br \/>\n<\/dd><dd><a href=\"#Implementing_app_widgets_with_collections\">Implementing app widgets with collections <\/a><br \/>\n<\/dd><dd><a href=\"#Keeping_Collection_Data_Fresh\">Keeping Collection Data Fresh<\/a><br \/>\n<\/dd><\/dl>\n<p>\u5173\u952e\u7c7b\n<\/p>\n<hr \/>\n<p><a rel=\"nofollow\" target=\"_blank\" class=\"external text\" href=\"http:\/\/docs.eoeandroid.com\/reference\/android\/appwidget\/AppWidgetProvider.html\">AppWidgetProvider<\/a><br \/>\n<a rel=\"nofollow\" target=\"_blank\" class=\"external text\" href=\"http:\/\/docs.eoeandroid.com\/reference\/android\/appwidget\/AppWidgetProviderInfo.html\">AppWidgetProviderInfo<\/a><br \/>\n<a rel=\"nofollow\" target=\"_blank\" class=\"external text\" href=\"http:\/\/docs.eoeandroid.com\/reference\/android\/appwidget\/AppWidgetManager.html\">AppWidgetManager<\/a><br \/>\n\u53c2\u89c1\n<\/p>\n<hr \/>\n<p><a rel=\"nofollow\" target=\"_blank\" class=\"external text\" href=\"http:\/\/docs.eoeandroid.com\/guide\/practices\/ui_guidelines\/widget_design.html\">App Widget Design Guidelines<\/a><br \/>\n<a rel=\"nofollow\" target=\"_blank\" class=\"external text\" href=\"http:\/\/android-developers.blogspot.com\/2009\/04\/introducing-home-screen-widgets-and.html\">Introducing home screen widgets and the AppWidget framework <\/a><br \/>\n<\/p>\n<\/div>\n<\/div>\n<p>App Widgets\u662f\u4e00\u4e2a\u5e94\u7528\u7a0b\u5e8f\u7684\u5c0f\u89c6\u56fe\uff0c\u53ef\u4ee5\u5d4c\u5165\u5230\u5176\u4ed6\u5e94\u7528\u7a0b\u5e8f\uff08\u5982\u4e3b\u5c4f\u5e55\uff09\u5e76\u4e14\u80fd\u591f\u5b9a\u671f\u66f4\u65b0\u3002\u4f60\u53ef\u4ee5\u53d1\u5e03\u4e00\u4e2a\u5e94\u7528\u7a0b\u5e8f\u7684App Widget\uff0c\u800c\u8fd9\u4e9b\u89c6\u56fe\u79f0\u4e3a\u7a97\u53e3\u7684\u7528\u6237\u754c\u9762\u3002\u4e00\u4e2a\u5e94\u7528\u7a0b\u5e8f\u91cc\uff0c\u53ef\u4ee5\u652f\u6301\u5176\u4ed6\u5e94\u7528\u7a0b\u5e8f\u7684App Widgets\u79f0\u4e3aApp Widget\u7684\u4e3b\u673a\u3002\u4e0b\u9762\u7684\u622a\u56fe\u662f\u663e\u793a\u97f3\u4e50\u7684App Widget\u3002<br \/>\n<br \/>\n<img src=\"http:\/\/docs.eoeandroid.com\/images\/appwidget.png\" alt=\"appwidget.png\" \/><br \/>\n<br \/>\n\u8be5\u6587\u6863\u5c06\u4ecb\u7ecd\u5982\u4f55\u5728\u5e94\u7528\u7a0b\u5e8f\u91cc\u53d1\u5e03\u4f7f\u7528App Widget\u3002\n<\/p>\n<h2> <span class=\"mw-headline\" id=\".E5.9F.BA.E7.A1.80.E7.9F.A5.E8.AF.86-The_Basics\">\u57fa\u7840\u77e5\u8bc6-The Basics<\/span><\/h2>\n<p>\u8981\u521b\u5efa\u4e00\u4e2aApp Widget\uff0c\u60a8\u9700\u8981\u4e86\u89e3\u4ee5\u4e0b\u51e0\u70b9\uff1a\n<\/p><p><b><a rel=\"nofollow\" target=\"_blank\" class=\"external text\" href=\"http:\/\/docs.eoeandroid.com\/reference\/android\/appwidget\/AppWidgetProviderInfo.html\">AppWidgetProviderInfo<\/a><\/b>\n\u5bf9\u8c61\uff1a<br \/>\n&#160;&#160;&#160;&#160;&#160;&#160;\u63cf\u8ff0\u4e86\u4e00\u4e2aApp Widget\u7684\u5143\u6570\u636e\uff0c\u5982\u5728App Widget\u7684\u5e03\u5c40\uff0c\u66f4\u65b0\u9891\u7387\uff0c\u548cAppWidgetProvider\u7c7b\u3002\u90fd\u5e94\u5728XML\u4e2d\u5b9a\u4e49\u3002<br \/> \n<b><a rel=\"nofollow\" target=\"_blank\" class=\"external text\" href=\"http:\/\/docs.eoeandroid.com\/reference\/android\/appwidget\/AppWidgetProvider.html\">AppWidgetProvider<\/a><\/b>\u7c7b\u7684\u5b9e\u73b0\uff1a<br \/>\n&#160;&#160;&#160;&#160;&#160;&#160;\u5b9a\u4e49\u4e00\u4e2a\u57fa\u4e8e\u5e7f\u64ad\u4e8b\u4ef6\u4e0eApp Widget\u7684\u63a5\u53e3\u65b9\u6cd5\u3002\u901a\u8fc7\u5b83\uff0c\u60a8\u5c06\u6536\u5230\u5e7f\u64ad\u5bf9App Widget\u8fdb\u884c\u66f4\u65b0\uff0c\u542f\u7528\uff0c\u7981\u7528\u548c\u5220\u9664\u3002<br \/>\n\u89c6\u56fe\u5e03\u5c40\uff1a<br \/>\n&#160;&#160;&#160;&#160;&#160;&#160;\u5728XML\u4e2d\u521d\u6b65\u5b9a\u4e49App Widget\u5e03\u5c40\u3002<br \/>\n\u6b64\u5916\uff0c\u8fd8\u53ef\u4ee5\u5b9e\u73b0App Widget\u53ef\u914d\u7f6e\u7684<b><a rel=\"nofollow\" target=\"_blank\" class=\"external text\" href=\"http:\/\/docs.eoeandroid.com\/reference\/android\/app\/Activity.html\">Activity<\/a><\/b>\u3002\u5f53\u7528\u6237\u6dfb\u52a0\u60a8\u7684App Widget\uff0c\u5e76\u5141\u8bb8\u4ed6\u6216\u5979\u5728\u521b\u5efa\u65f6\u4fee\u6539\u8bbe\u7f6e\u65f6\u542f\u52a8\u8fd9\u4e2a\u53ef\u914d\u7f6e\u7684Activity\u3002<br \/>\n<br \/>\n\u4ee5\u4e0b\u5404\u8282\u63cf\u8ff0\u5982\u4f55\u8bbe\u7f6e\u8fd9\u4e9b\u7ec4\u4ef6\u3002\n<\/p>\n<h2> <span class=\"mw-headline\" id=\"Declaring_an_App_Widget_in_the_Manifest\">Declaring an App Widget in the Manifest<\/span><\/h2>\n<p>\u9996\u5148\uff0c\u5728\u60a8\u7684\u5e94\u7528\u7a0b\u5e8f\u7684<span style=\"color:green\">AndroidManifest.xml<\/span>\u6587\u4ef6\u4e2d\u58f0\u660e<b><a rel=\"nofollow\" target=\"_blank\" class=\"external text\" href=\"http:\/\/docs.eoeandroid.com\/reference\/android\/appwidget\/AppWidgetProvider.html\">AppWidgetProvider<\/a><\/b>\u7c7b\u3002\u4f8b\u5982\uff1a\n<\/p>\n<pre class=\"java\">&#160;\n&lt;receiver android:name=<span style=\"color: #ff0000;\">&quot;ExampleAppWidgetProvider&quot;<\/span> &gt;    \n      &lt;intent-filter&gt;        \n           &lt;action android:name=<span style=\"color: #ff0000;\">&quot;android.appwidget.action.APPWIDGET_UPDATE&quot;<\/span> \/&gt;    \n      &lt;\/intent-filter&gt;    \n      &lt;meta-data android:name=<span style=\"color: #ff0000;\">&quot;android.appwidget.provider&quot;<\/span>\n                 android:resource=<span style=\"color: #ff0000;\">&quot;@xml\/example_appwidget_info&quot;<\/span> \/&gt;\n&lt;\/receiver&gt;\n&#160;<\/pre>\n<p><span style=\"color:green\">&lt;receiver&gt;<\/span>\u5143\u7d20\u9700\u8981\u7684<span style=\"color:green\">android\uff1aname<\/span>\u5c5e\u6027\uff0c\u5728App Widget\u4e2d\u6307\u5b9a\u4f7f\u7528<b><a rel=\"nofollow\" target=\"_blank\" class=\"external text\" href=\"http:\/\/docs.eoeandroid.com\/reference\/android\/appwidget\/AppWidgetProvider.html\">AppWidgetProvider<\/a><\/b>\u3002\n<span style=\"color:green\">intent-filter<\/span>\u5143\u7d20\u5fc5\u987b\u5305\u542b\u4e00\u4e2a\u4e0e<span style=\"color:green\">&lt;action&gt;<\/span>\u5143\u7d20\u7684<span style=\"color:green\">android\uff1aname<\/span>\u5c5e\u6027\u3002\u6b64\u5c5e\u6027\u6307\u5b9a<b><a rel=\"nofollow\" target=\"_blank\" class=\"external text\" href=\"http:\/\/docs.eoeandroid.com\/reference\/android\/appwidget\/AppWidgetProvider.html\">AppWidgetProvider<\/a><\/b>\u63a5\u53d7<a rel=\"nofollow\" target=\"_blank\" class=\"external text\" href=\"http:\/\/docs.eoeandroid.com\/reference\/android\/appwidget\/AppWidgetManager.html#ACTION_APPWIDGET_UPDATE\">ACTION_APPWIDGET_UPDATE<\/a>\u5e7f\u64ad\u3002\u8fd9\u662f\u552f\u4e00\u7684\u5e7f\u64ad\uff0c\u4f60\u5fc5\u987b\u660e\u786e\u58f0\u660e\u3002\u5728<b><a rel=\"nofollow\" target=\"_blank\" class=\"external text\" href=\"http:\/\/docs.eoeandroid.com\/reference\/android\/appwidget\/AppWidgetManager.html\">AppWidgetManager<\/a><\/b>\u81ea\u52a8\u53d1\u9001\u5176\u4ed6App widget\u5e7f\u64adAppWidgetProvider\u662f\u5fc5\u8981\u7684\u3002\n<span style=\"color:green\">&lt;meta-data&gt;<\/span>\u5143\u7d20\u6307\u5b9a\u7684<b><a rel=\"nofollow\" target=\"_blank\" class=\"external text\" href=\"http:\/\/docs.eoeandroid.com\/reference\/android\/appwidget\/AppWidgetProviderInfo.html\">AppWidgetProviderInfo<\/a><\/b>\u7684\u8d44\u6e90\uff0c\u9700\u8981\u4ee5\u4e0b\u5c5e\u6027\uff1a\n<\/p>\n<ul><li><span style=\"color:green\">android\uff1aname<\/span> - \u6307\u5b9a\u7684\u5143\u6570\u636e\u7684\u540d\u79f0\u3002\u4f7f\u7528<span style=\"color:green\">android.appwidget.provider<\/span>\u8bc6\u522b\u4f5c\u4e3a<b><a rel=\"nofollow\" target=\"_blank\" class=\"external text\" href=\"http:\/\/docs.eoeandroid.com\/reference\/android\/appwidget\/AppWidgetProviderInfo.html\">AppWidgetProviderInfo<\/a><\/b>\u63cf\u8ff0\u7b26\u7684\u6570\u636e\u3002\n<\/li><li><span style=\"color:green\">android:resource <\/span>- \u6307\u5b9a<b><a rel=\"nofollow\" target=\"_blank\" class=\"external text\" href=\"http:\/\/docs.eoeandroid.com\/reference\/android\/appwidget\/AppWidgetProviderInfo.html\">AppWidgetProviderInfo<\/a><\/b>\u7684\u8d44\u6e90\u4f4d\u7f6e\u3002\n<\/li><\/ul>\n<h2> <span class=\"mw-headline\" id=\"Adding_the_AppWidgetProviderInfo_Metadata\">Adding the AppWidgetProviderInfo Metadata<\/span><\/h2>\n<p><b><a rel=\"nofollow\" target=\"_blank\" class=\"external text\" href=\"http:\/\/docs.eoeandroid.com\/reference\/android\/appwidget\/AppWidgetProviderInfo.html\">AppWidgetProviderInfo<\/a><\/b>\u5b9a\u4e49App Widget\u7684\u57fa\u672c\u7d20\u8d28\uff0c\u4f8b\u5982\u5176\u6700\u5c0f\u7684\u5e03\u5c40\u5c3a\u5bf8\uff0c\u5176\u521d\u59cb\u5e03\u5c40\u8d44\u6e90\uff0c\u5982\u4f55\u7ecf\u5e38\u66f4\u65b0App Widget\uff0c\u548c\uff08\u53ef\u9009\uff09\u914d\u7f6eActivity\uff0c\u5728\u521b\u5efa\u65f6\u53d1\u8d77\u3002\u5728XML\u8d44\u6e90\u6587\u4ef6\u4e2d\u5b9a\u4e49AppWidgetProviderInfo\u5bf9\u8c61\uff0c\u4f7f\u7528<span style=\"color:green\">&lt;appwidget-provider&gt;<\/span>\u5143\u7d20\u548c\u5728\u9879\u76ee\u7684RES \/ XML\/\u6587\u4ef6\u5939\u4e2d\u4fdd\u5b58\u3002\n<\/p><p>\u4f8b\u5982\uff1a\n<\/p>\n<pre class=\"java\">&#160;\n&lt;appwidget-provider xmlns:android=<span style=\"color: #ff0000;\">&quot;http:\/\/schemas.android.com\/apk\/res\/android&quot;<\/span>    \n    android:minWidth=<span style=\"color: #ff0000;\">&quot;294dp&quot;<\/span>    \n    android:minHeight=<span style=\"color: #ff0000;\">&quot;72dp&quot;<\/span>    \n    android:updatePeriodMillis=<span style=\"color: #ff0000;\">&quot;86400000&quot;<\/span>    \n    android:previewImage=<span style=\"color: #ff0000;\">&quot;@drawable\/preview&quot;<\/span>    \n    android:initialLayout=<span style=\"color: #ff0000;\">&quot;@layout\/example_appwidget&quot;<\/span>\n    android:configure=<span style=\"color: #ff0000;\">&quot;com.example.android.ExampleAppWidgetConfigure&quot;<\/span>       \n    android:resizeMode=<span style=\"color: #ff0000;\">&quot;horizontal|vertical&quot;<\/span>&gt;\n&lt;\/appwidget-provider&gt;\n&#160;<\/pre>\n<p>\u4ee5\u4e0b\u662f<span style=\"color:green\">&lt;appwidget-provider&gt;<\/span>\u5c5e\u6027\u7684\u6458\u8981\uff1a\n<\/p>\n<ul><li>App Widget\u9ed8\u8ba4\u7684\u60c5\u51b5\u4e0b<span style=\"color:green\">minWidth<\/span>\u548c<span style=\"color:green\">MinHeight<\/span>\u5c5e\u6027\u503c\u6307\u5b9a\u6d88\u8017\u6700\u5c0f\u7684\u7a7a\u95f4\uff0cAppWidgets\u9ed8\u8ba4\u4e3b\u9875\u7684\u5c4f\u5e55\u4f4d\u7f6e\uff0c\u5728\u5176\u7a97\u53e3\u57fa\u7840\u4e0a\u7684\u5355\u5143\u683c\u6709\u4e00\u4e2a\u660e\u786e\u9ad8\u5ea6\u548c\u5bbd\u5ea6\u7684\u7f51\u683c\u3002\u5982\u679c\u4e00\u4e2aApp Widget\u7684\u6700\u5c0f\u5bbd\u5ea6\u6216\u9ad8\u5ea6\u503c\u4e0d\u5339\u914d\u5355\u5143\u683c\u7684\u5c3a\u5bf8\uff0c\u5219App Widget\u5c3a\u5bf8\u56db\u820d\u4e94\u5165\u5230\u6700\u63a5\u8fd1\u7684\u5355\u5143\u683c\u5927\u5c0f\u3002\n<\/li><\/ul>\n<p>&#160;&#160;&#160;&#160;&#160;\u5728<b><a rel=\"nofollow\" target=\"_blank\" class=\"external text\" href=\"http:\/\/docs.eoeandroid.com\/guide\/practices\/ui_guidelines\/widget_design.html#anatomy_determining_size\">App Widget Design Guidelines<\/a><\/b>\u91cc\u4e86\u89e3\u66f4\u591a\u5173\u4e8eApp Widget\u7684\u7a97\u53e3\u5927\u5c0f\u3002\n<\/p>\n<div style=\"margin: 1em;margin-left: 2em;padding: 0 0 0 .5em;border-left: 4px solid;border-color: #258AAF;\">\n\u6ce8\uff1a\u4e3a\u4e86\u4f7fApp Widget\u66f4\u5bb9\u6613\u5728\u8de8\u8bbe\u5907\u4e2d\u643a\u5e26\uff0cApp Widget\u7684\u6700\u5c0f\u5c3a\u5bf8\u4e0d\u5e94\u5927\u4e8e4\u00d74\u5355\u5143\u683c<\/div>\n<ul><li><span style=\"color:green\">minResizeWidth<\/span>\u548c<span style=\"color:green\">minResizeHeight<\/span>\u5c5e\u6027\u6307\u5b9aApp Widget\u7684\u7edd\u5bf9\u6700\u5c0f\u5c3a\u5bf8\u3002\u8fd9\u4e9b\u503c\u5e94\u8be5\u6307\u5b9a\u5c3a\u5bf8\u4e0b\uff0c\u5426\u5219\u5e94\u7528\u7a0b\u5e8f\u7ec4\u4ef6\u5c06\u65e0\u6cd5\u8fa8\u8ba4\u6216\u4ee5\u5176\u4ed6\u65b9\u5f0f\u4f7f\u7528\u3002\u5728android3.1\uff0c\u5141\u8bb8\u7528\u6237\u4f7f\u7528\u8fd9\u4e9b\u5c5e\u6027\u8c03\u6574\u63a7\u4ef6\u5927\u5c0f\uff0c\u53ef\u80fd\u662f\u5c0f\u4e8e\u9ed8\u8ba4\u5c3a\u5bf8\u754c\u5b9a\u7684<span style=\"color:green\">minWidth<\/span>\u548c<span style=\"color:green\">MinHeight<\/span>\u5c5e\u6027\u3002\n<\/li><\/ul>\n<ul><li>\u5728<b><a rel=\"nofollow\" target=\"_blank\" class=\"external text\" href=\"http:\/\/docs.eoeandroid.com\/guide\/practices\/ui_guidelines\/widget_design.html#anatomy_determining_size\">App Widget Design Guidelines<\/a><\/b>\u91cc\u4e86\u89e3\u66f4\u591a\u5173\u4e8eApp Widget\u7684\u7a97\u53e3\u5927\u5c0f\u3002\n<\/li><\/ul>\n<p><span style=\"color:green\">updateperiodmillis<\/span>\u5c5e\u6027\u5b9a\u4e49\uff0c\u5f80\u5f80\u5728App Widget\u6846\u67b6\uff0c\u5e94\u4ece<b><a rel=\"nofollow\" target=\"_blank\" class=\"external text\" href=\"http:\/\/docs.eoeandroid.com\/reference\/android\/appwidget\/AppWidgetProvider.html\">Appwidgetprovider<\/a><\/b>\u8bf7\u6c42\u901a\u8fc7\u8c03\u7528onUpdate()\u56de\u8c03\u65b9\u6cd5\u66f4\u65b0\u3002\u5b9e\u9645\u4e0a\u4e0d\u80fd\u4fdd\u8bc1\u66f4\u65b0\u7684\u51c6\u786e\u6027\uff0c\u6211\u4eec\u5efa\u8bae\u5c3d\u53ef\u80fd\u7684\u5c11\u66f4\u65b0\u6216\u8005\u4e0d\u8d85\u8fc7\u6bcf\u5c0f\u65f6\u4e00\u6b21\uff0c\u4ee5\u6b64\u6765\u8282\u7701\u7535\u6c60\u3002\u4f60\u4e5f\u53ef\u4ee5\u5728configuration-some\u4e2d\u5141\u8bb8\u7528\u6237\u8c03\u6574\u9891\u7387\uff0c\u6bd4\u5982\u8bc1\u52b5\u62a5\u4ef7\u673a\uff0c\u4e00\u4e9b\u7528\u6237\u53ef\u80fd\u60f3\u898115\u5206\u949f\u66f4\u65b0\u4e00\u6b21\uff0c\u4e00\u4e9b\u5219\u60f3\u8981\u6bcf\u5929\u53ea\u66f4\u65b0\u56db\u6b21\n<\/p>\n<div style=\"margin: 1em;margin-left: 2em;padding: 0 0 0 .5em;border-left: 4px solid;border-color: #258AAF;\">\n\u6ce8\uff1a\u5982\u679c\u8be5\u8bbe\u5907\u662f\u7761\u7740\u7684\uff0c\u800c\u5b83\u662f\u4e00\u4e2a\u66f4\u65b0\u7684\u65f6\u95f4\uff08\u5b9a\u4e49updatePeriodMillis\uff09\u65f6\uff0c\u5219\u8be5\u8bbe\u5907\u5c06\u88ab\u5524\u9192\u4ee5\u6267\u884c\u66f4\u65b0\u3002\u5982\u679c\u4f60\u4e0d\u8d85\u8fc7\u6bcf\u5c0f\u65f6\u66f4\u65b0\u4e00\u6b21\uff0c\u8fd9\u53ef\u80fd\u4e0d\u4f1a\u5bf9\u7535\u6c60\u5bff\u547d\u9020\u6210\u91cd\u5927\u7684\u95ee\u9898\u3002\u4f46\u662f\uff0c\u5982\u679c\u60a8\u9700\u8981\u9891\u7e41\u66f4\u65b0\u6216\u4f60\u5e76\u4e0d\u9700\u8981\u66f4\u65b0\uff0c\u800c\u8bbe\u5907\u662f\u7761\u7740\u7684\uff0c\u4f60\u5c31\u53ef\u4ee5\u6839\u636e\u62a5\u8b66\u4ee3\u66ff\u6267\u884c\uff0c\u5219\u4e0d\u4f1a\u5524\u9192\u8bbe\u5907\u6267\u884c\u66f4\u65b0\u3002\u8981\u505a\u5230\u8fd9\u4e00\u70b9\uff0c\u8bbe\u7f6e\u4e00\u4e2aIntent\uff0c\u5f53\u60a8\u7684AppWidgetProvider\u6536\u5230\u7684\u62a5\u8b66\u65f6\uff0c\u4f7f\u7528<b><a rel=\"nofollow\" target=\"_blank\" class=\"external text\" href=\"http:\/\/docs.eoeandroid.com\/reference\/android\/app\/AlarmManager.html\">AlarmManager<\/a><\/b>\u3002\u8bbe\u7f6e\u62a5\u8b66\u7c7b\u578b\u6709<b><a rel=\"nofollow\" target=\"_blank\" class=\"external text\" href=\"http:\/\/docs.eoeandroid.com\/reference\/android\/app\/AlarmManager.html#ELAPSED_REALTIME\">ELAPSED_REALTIME<\/a><\/b>\u6216RTC\uff0c\u8fd9\u5728\u6536\u5230\u62a5\u8b66\u65f6\uff0c\u8be5\u8bbe\u5907\u88ab\u5524\u9192\u3002\u7136\u540e\u8bbe\u7f6eupdatePeriodMillis\u4e3a\u96f6\uff08<span style=\"color:green\">\"0\"<\/span>\uff09\u3002<\/div>\n<ul><li><span style=\"color:green\">initialLayout<\/span>\u7684\u5c5e\u6027\u6307\u5411\u5e03\u5c40\u8d44\u6e90,\u5b83\u5b9a\u4e49\u4e86App Widget\u7684\u5e03\u5c40\u3002\n<\/li><li>\u5728<b><a rel=\"nofollow\" target=\"_blank\" class=\"external text\" href=\"http:\/\/docs.eoeandroid.com\/reference\/android\/app\/Activity.html\">Activity<\/a><\/b>\u542f\u52a8\u65f6\u5bf9<span style=\"color:green\">configure<\/span>\u5c5e\u6027\u8fdb\u884c\u914d\u7f6e\u5b9a\u4e49\uff0c\u7528\u6237\u6dfb\u52a0App Widget\uff0c\u4ee5\u4fbf\u4ed6\u6216\u5979\u914d\u7f6eApp Widget\u5c5e\u6027\u3002\u8fd9\u662f\u53ef\u9009\u7684\uff08\u9605\u8bfb\u4e0b\u9762\u521b\u5efa\u4e00\u4e2aApp Widget\u914d\u7f6e\u7684Activity\uff09\u3002\n<\/li><li>\u5728\u914d\u7f6e<span style=\"color:green\">previewImage<\/span>\u5c5e\u6027\u540e\u5c06\u6307\u5b9a\u4e00\u4e2aApp Widget\u56fe\u6807\u662f\u4ec0\u4e48\u6837\u5b50\uff0c\u5f53\u9009\u62e9\u8fd9\u4e2aApp Widget\u65f6\u7528\u6237\u53ef\u4ee5\u8fdb\u884c\u9884\u89c8\u3002\u5982\u679c\u6ca1\u6709\u63d0\u4f9b\u56fe\u6807,\u7528\u6237\u5374\u8ba4\u4e3alaucher\u662f\u60a8\u7684\u5e94\u7528\u7a0b\u5e8f\u56fe\u6807\u3002\u8fd9\u4e2a\u5b57\u6bb5\u5bf9\u5e94<span style=\"color:green\">android:previewImage<\/span>\u8fdb\u884c\u5728<span style=\"color:green\">&lt;receiver&gt;<\/span>\u5143\u7d20\u7684<span style=\"color:green\">AndroidManifest.xml<\/span>\u6587\u4ef6\u4e2d\u3002\u5728android3.0\u6709\u76f8\u5173\u4ecb\u7ecd\u4e2d\u3002\u66f4\u591a\u7684\u8ba8\u8bba\u4f7f\u7528<span style=\"color:green\">previewImage<\/span>\uff0c\u8bf7\u53c2\u9605\u8bbe\u7f6e\u9884\u89c8\u56fe\u6807\u3002\n<\/li><li>\u5728Android 3.0\u7684\u4ecb\u7ecd\uff0c\u8be5<span style=\"color:green\">autoAdvanceViewId<\/span>\u5c5e\u6027\u6307\u5b9a\u7684App Widget\u5b50\u89c6\u56fe\u7684\u89c6\u56feID\uff0c\u5e94\u8be5\u662fauto-advanced\u90e8\u4ef6\u7684\u4e3b\u673a\u3002\n<\/li><li>\u5728Android 3.1\u7684\u4ecb\u7ecd\uff0c\u8be5<span style=\"color:green\">resizeMode<\/span>\u5c5e\u6027\u6307\u5b9a\u5176\u4e2d\u4e00\u4e2a\u53ef\u4ee5\u8c03\u6574\u89c4\u5219\u7684\u90e8\u4ef6\u3002\u60a8\u53ef\u4ee5\u4f7f\u7528\u6b64\u5c5e\u6027\u4f7f\u4e3b\u5c4f\u5e55\u5c0f\u90e8\u4ef6\u7684<span style=\"color:green\">resizeMode<\/span>\uff0c\u6c34\u5e73\uff0c\u5782\u76f4\uff0c\u6216\u4e24\u8f74\u3002\u7528\u6237touch-hold\u4e00\u4e2a\u5c0f\u5de5\u5177,\u4ee5\u663e\u793a\u5176\u8c03\u6574\u624b\u67c4,\u7136\u540e\u62d6\u52a8\u6c34\u5e73\u548c\/\u6216\u5782\u76f4\u624b\u67c4\uff0c\u6539\u53d8\u5e03\u5c40\u7f51\u683c\u7684\u5927\u5c0f\u3002resizemode\u5c5e\u6027\u503c\u5305\u62ec\"horizontal\", \"vertical\", \u548c\"none\"\u3002\u58f0\u660e\u4e00\u4e2a\u90e8\u4ef6\u4f5c\u4e3aresizeable\u6a2a\u5411\u3001\u7eb5\u5411\u3001\u4ee5\u53ca\u201c\u6a2a\u5411|\u5782\u76f4\u201d\u7684\u503c\u3002\n<\/li><\/ul>\n<p>\u53c2\u8003AppWidgetProviderInfo\u7c7b\u67e5\u770b\u66f4\u591a\u4fe1\u606f\uff0c\u5173\u4e8e\u88abAppWidgetProviderInfo\u7c7b\u7684<span style=\"color:green\">&lt;appwidget-provider&gt;<\/span>  \u5143\u7d20\u63a5\u6536\u7684\u6807\u793a\u3002\n<\/p>\n<h2> <span class=\"mw-headline\" id=\"Creating_the_App_Widget_Layout\">Creating the App Widget Layout<\/span><\/h2>\n<p>\u5fc5\u987b\u4e3a\u4f60\u7684App widget\u5b9a\u4e49\u521d\u59cb\u5e03\u5c40\u7684XML\u548c\u5c06\u5176\u4fdd\u5b58\u5728\u9879\u76ee\u7684<span style=\"color:green\">res\/layout\/<\/span>\u76ee\u5f55\u4e2d\u3002\u4f7f\u7528\u4e0b\u5217\u7684\u89c6\u56fe\u5bf9\u8c61\u53ef\u4ee5\u8bbe\u8ba1\u4f60\u7684App widget\uff0c\u4f46\u5728\u4f60\u5f00\u59cb\u8bbe\u8ba1\u4f60\u7684App widget\u4e4b\u524d\uff0c\u8bf7\u9605\u8bfb\u548c\u7406\u89e3App widget\u7684\u8bbe\u8ba1\u51c6\u5219\u3002\n\u5982\u679c\u4f60\u719f\u6089XML\u7684\u5e03\u5c40\uff0c\u521b\u5efaApp widget\u7684\u5e03\u5c40\u5f88\u7b80\u5355\u3002\u7136\u800c,\u4f60\u4eec\u5fc5\u987b\u77e5\u9053App widget\u7684\u5e03\u5c40\u90fd\u662f\u57fa\u4e8eRemoteViews,\u4e0d\u652f\u6301\u5404\u79cd\u5e03\u5c40\u6216\u89c6\u56fe\u63a7\u4ef6\u3002<br \/>\n\u4e00\u4e2aRemoteViews\u5bf9\u8c61(and, consequently, an App Widget)\u53ef\u4ee5\u652f\u6301\u4ee5\u4e0b\u5e03\u5c40\u7c7b:<br \/>\n<\/p>\n<dl><dd><dl><dd>FrameLayout<br \/>\n<\/dd><dd>LinearLayout<br \/>\n<\/dd><dd>RelativeLayout<br \/>\n<\/dd><\/dl>\n<\/dd><\/dl>\n<p>\u53ca\u4ee5\u4e0b\u7684\u5c0f\u90e8\u4ef6\u7c7b\uff1a<br \/>\n<\/p>\n<dl><dd><dl><dd>AnalogClock<br \/>\n<\/dd><dd>Button<br \/>\n<\/dd><dd>Chronometer<br \/>\n<\/dd><dd>ImageButton<br \/>\n<\/dd><dd>ImageView<br \/>\n<\/dd><dd>ProgressBar<br \/>\n<\/dd><dd>TextView<br \/>\n<\/dd><dd>ViewFlipper<br \/>\n<\/dd><dd>ListView<br \/>\n<\/dd><dd>GridView<br \/>\n<\/dd><dd>StackView<br \/>\n<\/dd><dd>AdapterViewFlipper<br \/>\n<\/dd><\/dl>\n<\/dd><\/dl>\n<p>\u8fd9\u4e9b\u7c7b\u7684\u5b50\u7c7b\u90fd\u4e0d\u652f\u6301\u7684\u3002<br \/>\n<\/p>\n<h3> <span class=\"mw-headline\" id=\"Adding_margins_to_App_Widgets\">Adding margins to App Widgets<\/span><\/h3>\n<p>widget\u901a\u5e38\u4e0d\u5e94\u8be5\u6269\u5c55\u5230\u5c4f\u5e55\u8fb9\u7f18,\u4e0d\u5e94\u4e0e\u5176\u4ed6widget\u89c6\u56fe\u5171\u540c\u5237\u65b0,\u6240\u4ee5\u4f60\u5e94\u8be5\u589e\u52a0\u8fb9\u7f18\u56f4\u7ed5\u4f60\u7684widget\u6846\u67b6\u3002\n\u4f5c\u4e3aAndroid 4.0,App widget\u63d0\u4f9b\u4e86\u5c0f\u90e8\u4ef6\u4e4b\u95f4\u7684\u81ea\u52a8\u586b\u5145\u6846\u67b6\u548cApp widget\u7684\u5305\u56f4\u76d2,\u4ee5\u4fbf\u7528\u6237\u5728\u4e3b\u5c4f\u5e55\u66f4\u597d\u7684\u8c03\u6574\u5176\u4ed6\u5c0f\u90e8\u4ef6\u548c\u56fe\u6807\u3002\u4f7f\u7528\u8fd9\u79cd\u63a8\u8350\u5e94\u7528\u7a0b\u5e8f\u7684<span style=\"color:green\">targetSdkVersion<\/span>\u8bbe\u7f6e14\u6216\u66f4\u9ad8\u3002<br \/>\n\u5b83\u5f88\u5bb9\u6613\u7f16\u5199\u4e00\u4e2a\u5e03\u5c40\uff0c\u9002\u7528\u4e8e\u65e9\u671f\u7248\u672c\u7684\u5e73\u53f0\uff0c\u5177\u6709\u81ea\u5b9a\u4e49\u8fb9\u8ddd\uff0c\u5728Android4.0\u5e76\u6ca1\u6709\u989d\u5916\u7684\u8fb9\u8ddd\u6216\u8005\u66f4\u9ad8\uff1a<br \/>\n1.\u8bbe\u7f6e\u5e94\u7528\u7a0b\u5e8f\u7684targetsdkversion\u503c\u4e3a14\u6216\u66f4\u9ad8\u3002<br \/>\n2.\u521b\u5efa\u4e00\u4e2a\u5982\u4e0b\u5e03\u5c40\uff0c\u5f15\u7528\u5176\u4ed6\u5c3a\u5bf8\u8d44\u6e90:<br \/>\n<\/p>\n<pre class=\"java\">&#160;\n&lt;FrameLayout  \n   android:layout_width=<span style=\"color: #ff0000;\">&quot;match_parent&quot;<\/span>  \n   android:layout_height=<span style=\"color: #ff0000;\">&quot;match_parent&quot;<\/span>  \n   android:padding=<span style=\"color: #ff0000;\">&quot;@dimen\/widget_margin&quot;<\/span>&gt;  \n   &lt;LinearLayout    \n      android:layout_width=<span style=\"color: #ff0000;\">&quot;match_parent&quot;<\/span>    \n      android:layout_height=<span style=\"color: #ff0000;\">&quot;match_parent&quot;<\/span>    \n      android:orientation=<span style=\"color: #ff0000;\">&quot;horizontal&quot;<\/span>    \n      android:background=<span style=\"color: #ff0000;\">&quot;@drawable\/my_widget_background&quot;<\/span>&gt;    \n      \u2026  \n   &lt;\/LinearLayout&gt;\n&lt;\/FrameLayout&gt;\n&#160;<\/pre>\n<p>3.\u521b\u5efa\u4e24\u4e2a\u7ef4\u5ea6\u7684\u8d44\u6e90,\u4e00\u4e2a\u5728<span style=\"color:green\">res \/values\/<\/span>\u63d0\u4f9bpre-Android 4.0\u81ea\u5b9a\u4e49\u8fb9\u8ddd,\u4e00\u4e2a\u5728<span style=\"color:green\">res\/values-v14\/<\/span>\u6ca1\u6709\u4e3aAndroid4.0\u5c0f\u90e8\u4ef6\u63d0\u4f9b\u989d\u5916\u7684\u586b\u5145\uff1a<br \/>\n<b>res\/values\/dimens.xml:<\/b><br \/>\n<\/p>\n<pre class=\"java\">&#160;\n&lt;dimen name=<span style=\"color: #ff0000;\">&quot;widget_margin&quot;<\/span>&gt;8dp&lt;\/dimen&gt;\n&#160;<\/pre>\n<p><b>res\/values-v14\/dimens.xml:<\/b><br \/>\n<\/p>\n<pre class=\"java\">&#160;\n&lt;dimen name=<span style=\"color: #ff0000;\">&quot;widget_margin&quot;<\/span>&gt;0dp&lt;\/dimen&gt;\n&#160;<\/pre>\n<p>\u53e6\u4e00\u4e2a\u9009\u62e9\u662f\u5728\u9ed8\u8ba4\u60c5\u51b5\u4e0b\u7b80\u5355\u5730\u6784\u5efa\u989d\u5916\u7684\u8fb9\u8ddd\u5728\u4f60\u7684nine-patch\u80cc\u666f\u7684assets,\u800c\u6ca1\u6709\u8fb9\u8ddd\u5728API\u7ea7\u522b14\u6216\u4e4b\u540e\u5e76\u63d0\u4f9b\u4e0d\u540c\u7684nine-patches\u3002\n<\/p>\n<h2> <span class=\"mw-headline\" id=\"Using_the_AppWidgetProvider_Class\">Using the AppWidgetProvider Class<\/span><\/h2>\n<div style=\"width:310px; float:right; background-color: white; margin: 0px 0 2px 10px;padding: 0 0 0 10px;border-left: 4px solid;border-color: #ADFF2F;\">\n<p>\u4f60\u5fc5\u987b\u5728AndroidManifest&lt;receiver&gt;\u5143\u7d20\u91cc\u58f0\u660e\u5e7f\u64ad\u63a5\u6536\u5668\u4f7f\u7528\u7684\u60a8\u7684AppWidgetProvider\u7c7b\u7684\u5b9e\u73b0\uff08\u53c2\u89c1\u5728\u4e0a\u8ff0\u6e05\u5355\u58f0\u660e\u7684\u4e00\u4e2aAppWidget\uff09\u3002\n<\/p>\n<\/div>\n<p>appwidgetprovider\u4f5c\u4e3a\u4e00\u4e2a\u65b9\u4fbf\u7684\u7c7b\u6765\u7ee7\u627fbroadcastreceiver\u5904\u7406App widget\u5e7f\u64ad\u3002 AppWidgetProvider\u63a5\u6536\u4e8b\u4ef6\u5e7f\u64ad\uff0c\u5982App widget\u8fdb\u884c\u66f4\u65b0\u65f6\uff0c\u76f8\u5173\u7684App widget\u8fdb\u884c\u5220\u9664\uff0c\u542f\u7528\u548c\u7981\u7528\u3002\u8fd9\u4e9b\u5e7f\u64ad\u4e8b\u4ef6\u53d1\u751f\u65f6\uff0cAppWidgetProvider\u5c06\u8c03\u7528\u4ee5\u4e0b\u7684\u65b9\u6cd5\uff1a<br \/>\n<br \/>\nonUpdate() <br \/>\n<\/p>\n<dl><dd><dl><dd>\u8fd9\u79cd\u5728AppWidgetProviderInfo\u7531<span style=\"color:green\">updatePeriodMillis<\/span>\u5c5e\u6027\u5b9a\u4e49\u7684\u65f6\u95f4\u95f4\u9694\u53eb\u505aAppWidget\u66f4\u65b0\u3002\uff08\u8bf7\u53c2\u9605\u4e0a\u9762\u6dfb\u52a0AppWidgetProviderInfo\u5143\u6570\u636e\uff09\u8fd9\u79cd\u65b9\u6cd5\u4e5f\u88ab\u79f0\u4e3a\u7528\u6237\u6dfb\u52a0App widget\uff0c\u6240\u4ee5\u5b83\u5e94\u8be5\u8fdb\u884c\u5fc5\u8981\u7684\u8bbe\u7f6e\uff0c\u5982\u89c6\u56fe\u5b9a\u4e49\u4e8b\u4ef6\u5904\u7406\u7a0b\u5e8f\uff0c\u5982\u679c\u6709\u5fc5\u8981\uff0c\u5e94\u542f\u52a8\u4e34\u65f6\u670d\u52a1\u3002\u4e0d\u8fc7\uff0c\u5982\u679c\u4f60\u5df2\u7ecf\u5ba3\u5e03\u914d\u7f6e\u7684Activity\uff0c\u8fd9\u79cd\u65b9\u6cd5\u5219\u4e0d\u53eb\u7528\u6237\u6dfb\u52a0App widget\uff0c\u800c\u662f\u540e\u7eed\u66f4\u65b0\u8c03\u7528\u3002\u914d\u7f6e\u7684Activity\u5b8c\u6210\u540e\uff0c\u5b83\u7684\u4f5c\u7528\u5c31\u662f\u6267\u884c\u7b2c\u4e00\u6b21\u66f4\u65b0\u3002\uff08\u53c2\u89c1\u4e0b\u9762\u521b\u5efa\u4e00\u4e2aAppWidget\u914d\u7f6e\u7684Activity\u3002\uff09<br \/>\n<\/dd><\/dl>\n<\/dd><\/dl>\n<p><br \/>\nonDeleted(Context, int[])<br \/>\n<\/p>\n<dl><dd><dl><dd>\u4e00\u4e2aApp Widget\u4eceApp Widget\u4e3b\u673a\u4e2d\u5220\u9664\u3002<br \/>\n<\/dd><\/dl>\n<\/dd><\/dl>\n<p><br \/>\nonEnabled(Context)<br \/>\n<\/p>\n<dl><dd><dl><dd>\u9996\u6b21\u521b\u5efa\u5f53\u4e00\u4e2a\u5b9e\u4f8bApp widget\u3002\u4f8b\u5982\uff0c\u5982\u679c\u7528\u6237\u6dfb\u52a0\u4e86\u4e24\u4e2a\u5b9e\u4f8bApp widget,\u8fd9\u4e5f\u53ea\u80fd\u79f0\u4e3a\u7b2c\u4e00\u6b21\u521b\u5efa\u3002\u5982\u679c\u4f60\u9700\u8981\u6253\u5f00\u4e00\u4e2a\u65b0\u7684\u6570\u636e\u5e93\u6216\u8fdb\u884c\u5176\u4ed6\u7684\u8bbe\u7f6e\uff0c\u53ea\u9700\u8981\u6267\u884c\u4e00\u6b21App widget\u5b9e\u4f8b\uff0c\u90a3\u4e48\u5728\u8fd9\u4e2a\u5730\u65b9\u5b9e\u4f8b\u662f\u975e\u5e38\u597d\u7684\u3002<br \/>\n<\/dd><\/dl>\n<\/dd><\/dl>\n<p><br \/>\nonDisabled(Context)<br \/>\n<\/p>\n<dl><dd><dl><dd>\u8fd9\u662f\u6700\u540e\u4e00\u4e2a\u5b9e\u4f8b\u65f6\u8c03\u7528App widget,\u4ece\u5e94\u7528\u7a0b\u5e8f\u4e2d\u5220\u9664\u4e3b\u673a\u4e2d\u7684App widget\u3002\u4f7f\u7528onDisabled(Context)\u65b9\u6cd5\u8fdb\u884c\u6e05\u7406,\u6bd4\u5982\u5220\u9664\u4e34\u65f6\u6570\u636e\u5e93\u3002<br \/>\n<\/dd><\/dl>\n<\/dd><\/dl>\n<p><br \/>\nonReceive(Context, Intent)<br \/>\n<\/p>\n<dl><dd><dl><dd>\u8fd9\u662f\u547c\u5401\u6bcf\u4e2a\u5e7f\u64ad\u4e4b\u524d,\u4e0a\u9762\u7684\u6bcf\u4e2a\u56de\u8c03\u65b9\u6cd5\u3002\u4f60\u901a\u5e38\u4e0d\u9700\u8981\u5b9e\u73b0\u8fd9\u4e2a\u65b9\u6cd5,\u56e0\u4e3a\u9ed8\u8ba4\u7684AppWidgetProvider\u5b9e\u73b0\u8fc7\u6ee4\u5668\u6240\u6709App widget\u5e7f\u64ad\uff0c\u5e76\u9002\u5f53\u8c03\u7528\u4e0a\u9762\u7684\u65b9\u6cd5\u3002<br \/>\n<\/dd><\/dl>\n<\/dd><\/dl>\n<p><br \/>\n<\/p>\n<div style=\"margin: 1em;margin-left: 2em;padding: 0 0 0 .5em;border-left: 4px solid;border-color: #ff0000;\">\n\u6ce8\uff1a\u5728Android1.5\u4e2d\uff0c\u6709\u4e00\u4e2a\u5df2\u77e5\u7684\u95ee\u9898,\u5c31\u662fonDeleted()\u65b9\u6cd5\u5c06\u4e0d\u4f1a\u88ab\u8c03\u7528\u3002\u4e3a\u89e3\u51b3\u6b64\u95ee\u9898\uff0c\u60a8\u53ef\u4ee5\u5b9e\u73b0<span style=\"color:green\">onreceive()<\/span>\u65b9\u6cd5\u6765\u63a5\u6536<span style=\"color:green\">onDeleted()<\/span>\u65b9\u6cd5\u7684\u56de\u8c03\u3002<\/div>\n<p>\u5f53\u6bcf\u4e2aApp widget\u6dfb\u52a0\u5230\u4e00\u4e2a\u4e3b\u673a\u65f6\uff0c\u6700\u91cd\u8981\u7684\u662fAppWidgetProvider onUpdate()\u65b9\u6cd5\u56de\u8c03(\u9664\u975e\u4f60\u4f7f\u7528\u4e00\u4e2a\u914d\u7f6e\u7684Activity)\u3002\u5982\u679c\u4f60\u7684App widget\u63a5\u53d7\u4efb\u4f55\u7528\u6237\u4ea4\u4e92\u4e8b\u4ef6\uff0c\u5728\u56de\u8c03\u65f6\uff0c\u4f60\u9700\u8981\u6ce8\u518c\u4e8b\u4ef6\u6765\u5904\u7406\u7a0b\u5e8f\u3002\u5982\u679c\u4f60\u7684App widget\u4e0d\u80fd\u521b\u5efa\u4e34\u65f6\u6587\u4ef6\u6216\u6570\u636e\u5e93,\u6216\u8005\u6267\u884c\u5176\u4ed6\u7684\u5de5\u4f5c,\u9700\u8981\u6e05\u7406,\u60a8\u9700\u8981\u5b9a\u4e49onUpdate()\u65b9\u6cd5\uff0c\u5b83\u53ef\u80fd\u662f\u552f\u4e00\u7684\u56de\u8c03\u65b9\u6cd5\u3002\u4f8b\u5982,\u5982\u679c\u4f60\u60f3\u8981\u4e00\u4e2aApp widget\u7a97\u53e3\u6309\u94ae,\u5f53\u70b9\u51fb\u65f6\u542f\u52a8\u4e00\u4e2aActivity,\u4f60\u53ef\u4ee5\u4f7f\u7528\u4ee5\u4e0b\u5b9e\u73b0\u7684AppWidgetProvider:\n<\/p>\n<pre class=\"java\">&#160;\n<span style=\"color: #000000; font-weight: bold;\">public<\/span> <span style=\"color: #000000; font-weight: bold;\">class<\/span> ExampleAppWidgetProvider <span style=\"color: #000000; font-weight: bold;\">extends<\/span> AppWidgetProvider <span style=\"color: #66cc66;\">&#123;<\/span>\n&#160;\n    <span style=\"color: #000000; font-weight: bold;\">public<\/span> <span style=\"color: #993333;\">void<\/span> onUpdate<span style=\"color: #66cc66;\">&#40;<\/span><a href=\"http:\/\/www.google.com\/search?hl=en&amp;q=allinurl%3AContext+java.sun.com&amp;btnI=I%27m%20Feeling%20Lucky\"><span style=\"color: #aaaadd; font-weight: bold;\">Context<\/span><\/a> context, AppWidgetManager appWidgetManager, <span style=\"color: #993333;\">int<\/span><span style=\"color: #66cc66;\">&#91;<\/span><span style=\"color: #66cc66;\">&#93;<\/span> appWidgetIds<span style=\"color: #66cc66;\">&#41;<\/span> <span style=\"color: #66cc66;\">&#123;<\/span>\n        <span style=\"color: #000000; font-weight: bold;\">final<\/span> <span style=\"color: #993333;\">int<\/span> N = appWidgetIds.<span style=\"color: #006600;\">length<\/span>;\n&#160;\n        <span style=\"color: #808080; font-style: italic;\">\/\/ Perform this loop procedure for each App Widget that belongs to this provider<\/span>\n        <span style=\"color: #b1b100;\">for<\/span> <span style=\"color: #66cc66;\">&#40;<\/span><span style=\"color: #993333;\">int<\/span> i=<span style=\"color: #cc66cc;\">0<\/span>; i&lt;N; i++<span style=\"color: #66cc66;\">&#41;<\/span> <span style=\"color: #66cc66;\">&#123;<\/span>\n            <span style=\"color: #993333;\">int<\/span> appWidgetId = appWidgetIds<span style=\"color: #66cc66;\">&#91;<\/span>i<span style=\"color: #66cc66;\">&#93;<\/span>;\n&#160;\n            <span style=\"color: #808080; font-style: italic;\">\/\/ Create an Intent to launch ExampleActivity<\/span>\n            Intent intent = <span style=\"color: #000000; font-weight: bold;\">new<\/span> Intent<span style=\"color: #66cc66;\">&#40;<\/span>context, ExampleActivity.<span style=\"color: #000000; font-weight: bold;\">class<\/span><span style=\"color: #66cc66;\">&#41;<\/span>;\n            PendingIntent pendingIntent = PendingIntent.<span style=\"color: #006600;\">getActivity<\/span><span style=\"color: #66cc66;\">&#40;<\/span>context, <span style=\"color: #cc66cc;\">0<\/span>, intent, <span style=\"color: #cc66cc;\">0<\/span><span style=\"color: #66cc66;\">&#41;<\/span>;\n&#160;\n            <span style=\"color: #808080; font-style: italic;\">\/\/ Get the layout for the App Widget and attach an on-click listener<\/span>\n            <span style=\"color: #808080; font-style: italic;\">\/\/ to the button<\/span>\n            RemoteViews views = <span style=\"color: #000000; font-weight: bold;\">new<\/span> RemoteViews<span style=\"color: #66cc66;\">&#40;<\/span>context.<span style=\"color: #006600;\">getPackageName<\/span><span style=\"color: #66cc66;\">&#40;<\/span><span style=\"color: #66cc66;\">&#41;<\/span>, R.<span style=\"color: #006600;\">layout<\/span>.<span style=\"color: #006600;\">appwidget_provider_layout<\/span><span style=\"color: #66cc66;\">&#41;<\/span>;\n            views.<span style=\"color: #006600;\">setOnClickPendingIntent<\/span><span style=\"color: #66cc66;\">&#40;<\/span>R.<span style=\"color: #006600;\">id<\/span>.<span style=\"color: #006600;\">button<\/span>, pendingIntent<span style=\"color: #66cc66;\">&#41;<\/span>;\n&#160;\n            <span style=\"color: #808080; font-style: italic;\">\/\/ Tell the AppWidgetManager to perform an update on the current app widget<\/span>\n            appWidgetManager.<span style=\"color: #006600;\">updateAppWidget<\/span><span style=\"color: #66cc66;\">&#40;<\/span>appWidgetId, views<span style=\"color: #66cc66;\">&#41;<\/span>;\n        <span style=\"color: #66cc66;\">&#125;<\/span>\n    <span style=\"color: #66cc66;\">&#125;<\/span>\n<span style=\"color: #66cc66;\">&#125;<\/span>\n&#160;<\/pre>\n<p>\u8fd9appwidgetprovider\u53ea\u5b9a\u4e49onupdate()\u65b9\u6cd5,\u5176\u76ee\u7684\u662f\u5b9a\u4e49\u4e00\u4e2apendingintent\u542f\u52a8\u4e00\u4e2aActivity\u548c\u9644\u52a0\u5230App widget\u4f7f\u7528setonclickpendingintent\uff08int\uff0cpendingintent\uff09\u65b9\u6cd5\u7684\u6309\u94ae\u3002\u6ce8\u610f\uff0c\u5728<span style=\"color:green\">appwidgetids<\/span>\u5b83\u5305\u62ec\u4e00\u4e2a\u5faa\u73af\u904d\u5386\u6bcf\u4e2a\u6761\u76ee\uff0c\u8fd9\u662f\u4e00\u4e2a\u6570\u7ec4\u7684id\u6807\u8bc6\uff0c\u786e\u5b9a\u6bcf\u4e2aApp widget\u7684\u521b\u5efa\u3002\u8fd9\u6837\uff0c\u5982\u679c\u7528\u6237\u521b\u5efa\u591a\u4e2a\u5b9e\u4f8b\u7684App widget\uff0c\u7136\u540e\u4ed6\u4eec\u90fd\u540c\u65f6\u66f4\u65b0\u3002\u7136\u800c\uff0c\u53ea\u6709\u4e00\u4e2a<span style=\"color:green\">updateperiodmillis<\/span>\u65f6\u95f4\u8868\u5c06\u7ba1\u7406\u6240\u6709\u7684App widget\u3002\u4f8b\u5982\uff0c\u5982\u679c\u66f4\u65b0\u8ba1\u5212\u88ab\u5b9a\u4e49\u4e3a\u6bcf\u4e24\u4e2a\u5c0f\u65f6,\u5728\u7b2c\u4e00\u4e2a\u540e\u6dfb\u52a0\u7b2c\u4e8c\u4e2a\u5b9e\u4f8b\u7684App widget\u5e76\u6bcf\u5c0f\u65f6\u66f4\u65b0\u4e00\u6b21\uff0c\u90a3\u4e48\u5b83\u4eec\u90fd\u5c06\u88ab\u5b9a\u4e49\u4e3a\u7b2c\u4e00\u4e2a\u800c\u7b2c\u4e8c\u4e2a\u66f4\u65b0\u5468\u671f\u4f1a\u88ab\u5ffd\u7565\uff08\u4ed6\u4eec\u4f1a\u6bcf\u4e24\u5c0f\u65f6\u66f4\u65b0\uff0c\u800c\u4e0d\u662f\u6bcf\u9694\u4e00\u5c0f\u65f6\uff09\u3002\n<\/p>\n<div style=\"margin: 1em;margin-left: 2em;padding: 0 0 0 .5em;border-left: 4px solid;border-color: #4169e1;\">\n\u6ce8\uff1a\u7531\u4e8eAppWidgetProvider\u662f\u7ee7\u627fBroadcastReceiver\uff0c\u4e0d\u80fd\u4fdd\u8bc1\u4f60\u7684\u8fdb\u7a0b\u4fdd\u6301\u8fd0\u884c\u540e\u7684\u56de\u8c03\u65b9\u6cd5\u7684\u8fd4\u56de\uff08\u89c1BroadcastReceiver\u5e7f\u64ad\u5468\u671f\u7684\u4fe1\u606f\uff09\u3002\u5982\u679c\u60a8\u7684App widget\u8bbe\u7f6e\u8fc7\u7a0b\u53ef\u80fd\u8981\u82b1\u8d39\u51e0\u79d2\uff08\u4e5f\u8bb8\u540c\u65f6\u6267\u884cWeb\u8bf7\u6c42\uff09\uff0c\u5e76\u4e14\u8981\u6c42\u4f60\u7684\u8fdb\u7a0b\u4ecd\u5728\u7ee7\u7eed\uff0c\u53ef\u4ee5\u8003\u8651\u5728OnUpdate()\u65b9\u6cd5\u4e2d\u542f\u52a8\u4e00\u4e2aService\u3002\u4ece\u5185\u7684\u670d\u52a1\uff0c\u60a8\u53ef\u4ee5\u6267\u884c\u66f4\u65b0\u81ea\u5df1\u7684App widget\uff0c\u4e0d\u7528\u62c5\u5fc3\u7531\u4e8eAppWidgetProvider\u5173\u95ed\u5e94\u7528\u7a0b\u5e8f\u800c\u51fa\u73b0\"Application Not Responding\"\u7684(ANR)\u9519\u8bef\u3002\u53c2\u770bWiktionary sample's AppWidgetProvider\u4e00\u4e2aApp widget\u4f7f\u7528\u540e\u53f0\u670d\u52a1\u7684\u793a\u4f8b\u3002<\/div>\n<p>\u4e5f\u53c2\u8003ExampleAppWidgetProvider.java\u7684\u793a\u4f8b\u7c7b\u3002\n<\/p>\n<h3> <span class=\"mw-headline\" id=\"Receiving_App_Widget_broadcast_Intents\">Receiving App Widget broadcast Intents<\/span><\/h3>\n<p>AppWidgetProvider\u4ec5\u4ec5\u662f\u4e00\u4e2a\u65b9\u4fbf\u7684\u7c7b\u3002\u5982\u679c\u4f60\u60f3\u76f4\u63a5\u63a5\u6536App widget\u5e7f\u64ad\uff0c\u4f60\u53ef\u4ee5\u5b9e\u73b0\u81ea\u5df1\u7684BroadcastReceiver\u6216\u8986\u76d6\u7684onReceive(Context, Intent) \u65b9\u6cd5\u3002\u4f60\u9700\u8981\u77e5\u9053\u4ee5\u4e0b\u56db\u4e2a\u610f\u56fe\uff1a\n<br \/>\n<\/p>\n<ul><li>ACTION_APPWIDGET_UPDATE<br \/>\n<\/li><\/ul>\n<ul><li>ACTION_APPWIDGET_DELETED<br \/>\n<\/li><\/ul>\n<ul><li>ACTION_APPWIDGET_ENABLED<br \/>\n<\/li><\/ul>\n<ul><li>ACTION_APPWIDGET_DISABLED<br \/>\n<\/li><\/ul>\n<h2> <span class=\"mw-headline\" id=\"Creating_an_App_Widget_Configuration_Activity\">Creating an App Widget Configuration Activity<\/span><\/h2>\n<p>\u5982\u679c\u4f60\u60f3\u8bbe\u5b9a\u7684\u7528\u6237\uff0c\u5f53\u4ed6\u6216\u5979\u589e\u52a0\u4e86\u4e00\u4e2a\u65b0\u7684App widget\u65f6\uff0c\u4f60\u53ef\u4ee5\u521b\u5efa\u4e00\u4e2aApp widget\u914d\u7f6eActivity\u3002\u5f53\u524d\u7684Acitivity\u5c06\u81ea\u52a8\u542f\u52a8\u7684App widget\u7684\u4e3b\u673a\uff0c\u5e76\u5141\u8bb8\u7528\u6237\u5728\u521b\u5efa\u65f6\u914d\u7f6eApp widget\u7684\u989c\u8272\uff0c\u5927\u5c0f\uff0c\u66f4\u65b0\u5468\u671f\u6216\u5176\u4ed6\u529f\u80fd\u7684\u8bbe\u7f6e\u3002\n\u8fd9\u4e2a\u914d\u7f6e\u7684Activity\u5e94\u8be5\u5728Android manifest\u6587\u4ef6\u4e2d\u58f0\u660e\u662f\u4e00\u4e2a\u6807\u51c6\u7684Activity\u3002\u7136\u800c,\u5b83\u5c06\u53d1\u8d77\u8fd9\u4e2aApp widget\u4e3b\u673aACTION_APPWIDGET_CONFIGURE\u7684\u4e00\u4e2aAction,\u6240\u4ee5Activity\u9700\u8981\u63a5\u53d7\u8fd9\u79cd\u610f\u56fe\u3002\u4f8b\u5982:\n<\/p>\n<pre class=\"java\">&#160;\n&lt;activity android:name=<span style=\"color: #ff0000;\">&quot;.ExampleAppWidgetConfigure&quot;<\/span>&gt;\n    &lt;intent-filter&gt;\n        &lt;action android:name=<span style=\"color: #ff0000;\">&quot;android.appwidget.action.APPWIDGET_CONFIGURE&quot;<\/span>\/&gt;\n    &lt;\/intent-filter&gt;\n&lt;\/activity&gt;\n&#160;<\/pre>\n<p>\u6b64\u5916\uff0cActivity\u5fc5\u987b\u5728AppWidgetProviderInfo XML\u6587\u4ef6\u4e2d\u58f0\u660eandroid:configure\u5c5e\u6027(\u53c2\u89c1\u524d\u9762\u6dfb\u52a0AppWidgetProviderInfo\u7684\u5143\u6570\u636e)\u3002\u4f8b\u5982,\u53ef\u914d\u7f6e\u7684Activity\u58f0\u660e\u5982\u4e0b\uff1a\n<\/p>\n<pre class=\"java\">&#160;\n&lt;appwidget-provider xmlns:android=<span style=\"color: #ff0000;\">&quot;http:\/\/schemas.android.com\/apk\/res\/android&quot;<\/span>\n    ...\n    <span style=\"color: #006600;\">android<\/span>:configure=<span style=\"color: #ff0000;\">&quot;com.example.android.ExampleAppWidgetConfigure&quot;<\/span> \n    ... &gt;\n&lt;\/appwidget-provider&gt;\n&#160;<\/pre>\n<p>\u6ce8\u610f,\u8fd9\u4e2aActivity\u662f\u58f0\u660e\u5b8c\u5168\u9650\u5b9a\u7684\u547d\u540d\u7a7a\u95f4,\u56e0\u4e3a\u5b83\u662f\u4ece\u5305\u8303\u56f4\u4e4b\u5916\u5f15\u7528\u7684\u3002<br \/>\n\u4f60\u9700\u8981\u7684\u662f\u5f00\u59cb\u4f7f\u7528\u4e00\u4e2a\u914d\u7f6eActivity\u3002\u73b0\u5728\u4f60\u6240\u9700\u8981\u7684\u662f\u5b9e\u9645\u7684Activity\u3002\u7136\u800c,\u5f53\u4f60\u5b9e\u73b0Activity\u6709\u4e24\u4e2a\u91cd\u8981\u7684\u4e8b\u60c5\u8981\u8bb0\u4f4f:\n<\/p>\n<ul><li>\u8fd9\u4e2aApp widget\u4e3b\u673a\u8c03\u7528\u914d\u7f6eActivity\uff0c\u800c\u914d\u7f6eActivity\u5e94\u8be5\u603b\u662f\u8fd4\u56de\u4e00\u4e2a\u7ed3\u679c\u7801\u3002\u8fd9\u4e2a\u7ed3\u679c\u7801\u5e94\u8be5\u5305\u62ecApp widget ID\u6240\u901a\u8fc7\u7684\u610f\u56fe\u53d1\u8d77\u8fd9\u4e00Activity(\u8fd9\u4e2a\u610f\u56fe\u4f5c\u4e3aEXTRA_APPWIDGET_ID\u8fdb\u884c\u989d\u5916\u4fdd\u5b58)\u3002\n<\/li><li>\u5f53\u521b\u5efaApp widget\u65f6OnUpdate\uff08\uff09\u65b9\u6cd5\u5c06\u4e0d\u4f1a\u88ab\u8c03\u7528\uff08\u914d\u7f6eActivity\u542f\u52a8\u65f6\uff0c\u7cfb\u7edf\u5c06\u4e0d\u53d1\u9001ACTION_APPWIDGET_UPDATE\u5e7f\u64ad\uff09\u3002\n<\/li><\/ul>\n<p>\u8fd9\u662f\u914d\u7f6eActivity\u7684\u4f5c\u7528\uff0c\u8bf7\u6c42\u4eceApp widget\u9996\u6b21\u521b\u5efaAppWidgetManager\u65f6\u66f4\u65b0\u3002\u7136\u800c,onUpdate()\u65b9\u6cd5\u5c06\u547c\u5401\u540e\u7eed\u66f4\u65b0,\u5b83\u53ea\u662f\u8df3\u8fc7\u7b2c\u4e00\u6b21\u3002<br \/>\n<br \/>\n\u8bf7\u53c2\u9605\u4ee5\u4e0b\u90e8\u5206\u4e2d\u7684\u4e00\u4e2a\u4f8b\u5b50\uff0c\u4ece\u914d\u7f6e\u548c\u66f4\u65b0\u7684App widget\u7684\u4ee3\u7801\u7247\u6bb5\u4e2d\u5982\u4f55\u8fd4\u56de\u7ed3\u679c\u3002\n<\/p>\n<h3> <span class=\"mw-headline\" id=\"Updating_the_App_Widget_from_the_configuration_Activity\">Updating the App Widget from the configuration Activity<\/span><\/h3>\n<p>\u5f53\u4e00\u4e2aApp widget\u4f7f\u7528\u914d\u7f6eActivity\uff0c\u8fd9\u4e2aActivity\u914d\u7f6e\u5b8c\u6210\u540e\u8d1f\u8d23\u66f4\u65b0App widget\u3002\u4f60\u53ef\u4ee5\u4eceappwidgetmanager\u901a\u8fc7\u8bf7\u6c42\u76f4\u63a5\u66f4\u65b0.<br \/>\n\u4ee5\u4e0b\u603b\u7ed3\u4e86\u6b63\u786e\u7684\u66f4\u65b0App widget\u5e76\u5173\u95ed\u8be5\u914d\u7f6eActivity:<br \/>\n1.\u7b2c\u4e00\u6b65,\u628aApp widget\u7684ID\u901a\u8fc7\u610f\u56fe\u53d1\u8d77\u8fd9\u4e00Activity:\n<\/p>\n<pre class=\"java\">&#160;\nIntent intent = getIntent<span style=\"color: #66cc66;\">&#40;<\/span><span style=\"color: #66cc66;\">&#41;<\/span>;\nBundle extras = intent.<span style=\"color: #006600;\">getExtras<\/span><span style=\"color: #66cc66;\">&#40;<\/span><span style=\"color: #66cc66;\">&#41;<\/span>;\n<span style=\"color: #b1b100;\">if<\/span> <span style=\"color: #66cc66;\">&#40;<\/span>extras&#160;!= <span style=\"color: #000000; font-weight: bold;\">null<\/span><span style=\"color: #66cc66;\">&#41;<\/span> <span style=\"color: #66cc66;\">&#123;<\/span>\n    mAppWidgetId = extras.<span style=\"color: #006600;\">getInt<\/span><span style=\"color: #66cc66;\">&#40;<\/span>\n            AppWidgetManager.<span style=\"color: #006600;\">EXTRA_APPWIDGET_ID<\/span>, \n            AppWidgetManager.<span style=\"color: #006600;\">INVALID_APPWIDGET_ID<\/span><span style=\"color: #66cc66;\">&#41;<\/span>;\n<span style=\"color: #66cc66;\">&#125;<\/span>\n&#160;<\/pre>\n<p>2.\u7b2c\u4e8c\u6b65,\u6267\u884c\u4f60\u7684App widget\u914d\u7f6e.<br \/>\n3.\u7b2c\u4e09\u90e8,\u5f53\u914d\u7f6e\u5b8c\u6210\u540e,\u901a\u8fc7\u8c03\u7528getInstance(context)\u83b7\u5f97\u4e00\u4e2a\u5b9e\u4f8b\u7684AppWidgetManager:\n<\/p>\n<pre class=\"java\">&#160;\nAppWidgetManager appWidgetManager = AppWidgetManager.<span style=\"color: #006600;\">getInstance<\/span><span style=\"color: #66cc66;\">&#40;<\/span>context<span style=\"color: #66cc66;\">&#41;<\/span>;\n&#160;<\/pre>\n<p>4.\u7b2c\u56db\u6b65,\u901a\u8fc7\u8c03\u7528updateAppWidget(int,RemoteViews)\u66f4\u65b0App widget\u4e0eRemoteViews\u5e03\u5c40:\n<\/p>\n<pre class=\"java\">&#160;\nRemoteViews views = <span style=\"color: #000000; font-weight: bold;\">new<\/span> RemoteViews<span style=\"color: #66cc66;\">&#40;<\/span>context.<span style=\"color: #006600;\">getPackageName<\/span><span style=\"color: #66cc66;\">&#40;<\/span><span style=\"color: #66cc66;\">&#41;<\/span>,\nR.<span style=\"color: #006600;\">layout<\/span>.<span style=\"color: #006600;\">example_appwidget<\/span><span style=\"color: #66cc66;\">&#41;<\/span>;\nappWidgetManager.<span style=\"color: #006600;\">updateAppWidget<\/span><span style=\"color: #66cc66;\">&#40;<\/span>mAppWidgetId, views<span style=\"color: #66cc66;\">&#41;<\/span>;\n&#160;<\/pre>\n<p>5.\u6700\u540e,\u521b\u5efa\u8fd4\u56de\u7684\u610f\u56fe\uff0c\u5176\u8bbe\u7f6eActivity\u7684\u7ed3\u679c\u7801\uff0c\u5e76\u7ec8\u6b62\u8be5Activity\uff1a\n<\/p>\n<pre class=\"java\">&#160;\nIntent resultValue = <span style=\"color: #000000; font-weight: bold;\">new<\/span> Intent<span style=\"color: #66cc66;\">&#40;<\/span><span style=\"color: #66cc66;\">&#41;<\/span>;\nresultValue.<span style=\"color: #006600;\">putExtra<\/span><span style=\"color: #66cc66;\">&#40;<\/span>AppWidgetManager.<span style=\"color: #006600;\">EXTRA_APPWIDGET_ID<\/span>, mAppWidgetId<span style=\"color: #66cc66;\">&#41;<\/span>;\nsetResult<span style=\"color: #66cc66;\">&#40;<\/span>RESULT_OK, resultValue<span style=\"color: #66cc66;\">&#41;<\/span>;\nfinish<span style=\"color: #66cc66;\">&#40;<\/span><span style=\"color: #66cc66;\">&#41;<\/span>;\n&#160;<\/pre>\n<div style=\"margin: 1em;margin-left: 2em;padding: 0 0 0 .5em;border-left: 4px solid;border-color: #4169e1;\">\n\u63d0\u793a:\u5f53\u4f60\u7684\u914d\u7f6eActivity\u9996\u6b21\u6253\u5f00\u65f6,\u5728\u8be5Activity\u4f7f\u7528RESULT_CANCELED\u8bbe\u7f6e\u7ed3\u679c\u7801\u3002\u8fd9\u6837,\u5982\u679c\u7528\u6237\u9009\u62e9\u9000\u51fa\u4e4b\u524d\u80fd\u591f\u8fbe\u5230\u76ee\u7684,App widget\u901a\u77e5\u914d\u7f6e\u88ab\u53d6\u6d88,\u5e76\u4e0d\u4f1a\u518d\u6dfb\u52a0\u3002<\/div>\n<p>\u8bf7\u53c2\u89c1ApiDemos ExampleAppWidgetConfigure.java\u7684\u793a\u4f8b\u7c7b\u3002\n<\/p>\n<h2> <span class=\"mw-headline\" id=\"Setting_a_Preview_Image\">Setting a Preview Image<\/span><\/h2>\n<p>Android 3.0\u5f15\u5165\u4e86previewImage\u5b57\u6bb5,\u5b83\u6307\u5b9a\u4e00\u4e2aAppwidget\u9884\u89c8\u3002\u8fd9\u4e2a\u9884\u89c8\u662f\u7ed9\u7528\u6237\u663e\u793a\u5c0f\u90e8\u4ef6\u7684\u9009\u62e9\u5668\u3002\u5982\u679c\u6ca1\u6709\u63d0\u4f9b\u8fd9\u4e2a\u5b57\u6bb5,\u5219\u8fd9\u4e2aAppwidget\u7684\u56fe\u6807\u53ea\u7528\u4e8e\u9884\u89c8\u3002<br \/>\n\u5982\u4f55\u5728XML\u4e2d\u6307\u5b9a\u6b64\u8bbe\u7f6e\uff1a\n<\/p>\n<pre class=\"java\">&#160;\n&lt;appwidget-provider xmlns:android=<span style=\"color: #ff0000;\">&quot;http:\/\/schemas.android.com\/apk\/res\/android&quot;<\/span>\n  ...\n  <span style=\"color: #006600;\">android<\/span>:previewImage=<span style=\"color: #ff0000;\">&quot;@drawable\/preview&quot;<\/span>&gt;\n&lt;\/appwidget-provider&gt;\n&#160;<\/pre>\n<p>\u4e3a\u4e86\u5e2e\u52a9\u60a8\u7684Appwidget\uff08\u6307\u5b9a\u5728previewImage\u9886\u57df\uff09\u521b\u5efa\u9884\u89c8\u56fe\u50cf\uff0c\u5728Android\u6a21\u62df\u5668\u4e2d\u5305\u542b\u4e00\u4e2a\u5e94\u7528\u7a0b\u5e8f\u88ab\u79f0\u4e3a\u201c\u5c0f\u5de5\u5177\u9884\u89c8\u201d\u3002\u8981\u521b\u5efa\u9884\u89c8\u56fe\u50cf\uff0c\u5219\u8981\u542f\u52a8\u8be5\u5e94\u7528\u7a0b\u5e8f\uff0c\u9009\u62e9\u60a8\u7684\u5e94\u7528\u7a0b\u5e8f\u7684Appwidget\uff0c\u5e76\u8bbe\u7f6e\u60a8\u5e0c\u671b\u7684\u9884\u89c8\u56fe\u50cf\uff0c\u7136\u540e\u5c06\u5b83\u4fdd\u5b58\uff0c\u5e76\u5c06\u5176\u653e\u7f6e\u5728\u60a8\u7684\u5e94\u7528\u7a0b\u5e8f\u7684\u7ed8\u5236\u8d44\u6e90\u3002\n<\/p>\n<h2> <span class=\"mw-headline\" id=\"Using_App_Widgets_with_Collections\">Using App Widgets with Collections<\/span><\/h2>\n<p>Android 3.0\u5f15\u5165\u4e86Appwidget\u96c6\u5408\u3002\u8fd9\u4e9b\u7c7b\u578b\u7684Appwidget\u4f7f\u7528RemoteViewsService\u663e\u793a\u96c6\u5408,\u652f\u6301\u4e86\u8fdc\u7a0b\u6570\u636e.\u6bd4\u5982\u4ece\u4e00\u4e2acontent provider,\u5b83\u6240\u63d0\u4f9b\u7684\u6570\u636eRemoteViewsService\u63d0\u51faAppwidget\u901a\u8fc7\u4f7f\u7528\u4ee5\u4e0b\u89c6\u56fe\u7c7b\u578b,\u6211\u4eec\u79f0\u4e4b\u4e3a\"\u96c6\u5408\u89c6\u56fe.\"  <br \/>\n<br \/>\nListView<br \/>\n<\/p>\n<dl><dd><dl><dd>\u4e00\u4e2a\u89c6\u56fe\u6765\u663e\u793a\u9879\u76ee\u5728\u4e00\u4e2a\u5782\u76f4\u6eda\u52a8\u5217\u8868\u9879\u3002\u4f8b\u5982\uff0c\u67e5\u770bGmail\u7684Appwidget\u3002 <br \/>\n<\/dd><\/dl>\n<\/dd><\/dl>\n<p>GridView<br \/>\n<\/p>\n<dl><dd><dl><dd>\u4e00\u4e2a\u89c6\u56fe\u6765\u663e\u793a\u9879\u76ee\u5728\u53cc\u5411\u6eda\u52a8\u7684\u7f51\u683c\u3002\u4f8b\u5982,\u67e5\u770b\u4e66\u7b7e\u7684Appwidget\u3002<br \/>\n<\/dd><\/dl>\n<\/dd><\/dl>\n<p>StackView<br \/>\n<\/p>\n<dl><dd><dl><dd>\u4e00\u5806\u5361\u7247\u89c6\u56fe(\u6709\u70b9\u50cf\u4e00\u76d2\u540d\u7247), \u7528\u6237\u53ef\u5728\u5176\u4e2d\u6ed1\u52a8\u524d\u63d2\u5361\u4e0a\u6216\u4e0b\u770b\u5230\u4e0a\u4e00\u5f20\u6216\u4e0b\u4e00\u5f20\u5361.\u4f8b\u5982,YouTube\u548c\u4e66\u7c4d\u7684Appwidget\u3002<br \/>\n<\/dd><\/dl>\n<\/dd><\/dl>\n<p>AdapterViewFlipper<br \/>\n<\/p>\n<dl><dd><dl><dd>\u4e00\u4e2a\u9002\u914d\u5668\u652f\u6301\u7b80\u5355\u7684ViewAnimator\u4e0d\u4f1a\u82df\u540c,\u5728\u4e24\u4e2a\u6216\u591a\u4e2a\u89c6\u56fe\u3002\u53ea\u6709\u4e00\u4e2a\u5b69\u5b50\u4f1a\u663e\u793a\u3002 <br \/>\n<\/dd><\/dl>\n<\/dd><\/dl>\n<p><br \/>\n\u5982\u4e0a\u6240\u8ff0,\u8fd9\u4e9b\u96c6\u5408\u89c6\u56fe\u7531\u8fdc\u7a0b\u6570\u636e\u96c6\u5408\u8fdb\u884c\u663e\u793a\u3002\u8fd9\u610f\u5473\u7740\u4ed6\u4eec\u4f7f\u7528\u4e00\u4e2aAdapter\u4ee5\u4ed6\u4eec\u7684\u6570\u636e\u6765\u7ed1\u5b9a\u4ed6\u4eec\u7684View\u3002\u4e00\u4e2aAdapter\u4ece\u4e00\u7ec4\u6570\u636e\u4e3a\u5355\u72ec\u7684\u89c6\u56fe\u5bf9\u8c61\u7ed1\u5b9a\u5230\u4e2a\u522b\u9879\u76ee\u3002\u56e0\u4e3a\u8fd9\u4e9b\u96c6\u5408\u89c6\u56fe\u662f\u7531Adapter,Android\u6846\u67b6\u5fc5\u987b\u5305\u62ec\u989d\u5916\u7684\u67b6\u6784\u6765\u652f\u6301\u4ed6\u4eec\u7684\u4f7f\u7528\u5728Appwidget\u3002\u4e00\u4e2a\u5e94\u7528\u7a0b\u5e8f\u4e0a\u4e0b\u6587\u4e2d\u7684\u5c0f\u90e8\u4ef6,\u800c\u9002\u914d\u5668\u662f\u4e00\u4e2aRemoteViewsFactory\u6240\u53d6\u4ee3,\u8fd9\u662f\u4e00\u4e2a\u7b80\u5355\u7684\u7626\u5305\u88c5\u5668\u7684Adapter\u63a5\u53e3\u3002\u5f53\u8bf7\u6c42\u4e00\u4e2a\u7279\u5b9a\u7684\u9879\u76ee\u5728\u6536\u96c6\u3001RemoteViewsFactory\u521b\u5efa\u5e76\u8fd4\u56de\u6761\u76ee\u7684\u96c6\u5408\u4f5c\u4e3a\u4e00\u4e2aRemoteViews\u5bf9\u8c61\u3002\u4e3a\u4e86\u5c06\u4e00\u4e2a\u96c6\u5408\u89c6\u56fe\u5728\u4f60\u7684Appwidget,\u60a8\u5fc5\u987b\u5b9e\u73b0RemoteViewsService\u548cRemoteViewsFactory\u3002<br \/>\n<br \/>\nRemoteViewsService\u662f\u4e00\u4e2a\u670d\u52a1,\u5141\u8bb8\u8fdc\u7a0b\u9002\u914d\u5668\u8bf7\u6c42RemoteViews\u5bf9\u8c61\u3002<br \/>\nRemoteViewsFactory\u662f\u4e00\u4e2a\u63a5\u53e3\u4e4b\u95f4\u7684\u9002\u914d\u5668\u96c6\u5408\u89c6\u56fe(\u5982\u5217ListView,GridView,\u7b49\u7b49)\u548c\u5e95\u5c42\u7684\u6570\u636e\u89c6\u56fe\u3002\u4eceStackView Widget sample,\u4e0b\u9762\u662f\u4e00\u4e2a\u793a\u4f8b\u6837\u677f\u4ee3\u7801\u4f7f\u7528\u6765\u5b9e\u73b0\u8fd9\u4e2a\u670d\u52a1\u548c\u63a5\u53e3:\n<\/p>\n<pre class=\"java\">&#160;\n<span style=\"color: #000000; font-weight: bold;\">public<\/span> <span style=\"color: #000000; font-weight: bold;\">class<\/span> StackWidgetService <span style=\"color: #000000; font-weight: bold;\">extends<\/span> RemoteViewsService <span style=\"color: #66cc66;\">&#123;<\/span>\n    @Override\n    <span style=\"color: #000000; font-weight: bold;\">public<\/span> RemoteViewsFactory onGetViewFactory<span style=\"color: #66cc66;\">&#40;<\/span>Intent intent<span style=\"color: #66cc66;\">&#41;<\/span> <span style=\"color: #66cc66;\">&#123;<\/span>\n        <span style=\"color: #000000; font-weight: bold;\">return<\/span> <span style=\"color: #000000; font-weight: bold;\">new<\/span> StackRemoteViewsFactory<span style=\"color: #66cc66;\">&#40;<\/span><span style=\"color: #000000; font-weight: bold;\">this<\/span>.<span style=\"color: #006600;\">getApplicationContext<\/span><span style=\"color: #66cc66;\">&#40;<\/span><span style=\"color: #66cc66;\">&#41;<\/span>, intent<span style=\"color: #66cc66;\">&#41;<\/span>;\n    <span style=\"color: #66cc66;\">&#125;<\/span>\n<span style=\"color: #66cc66;\">&#125;<\/span>\n&#160;\n<span style=\"color: #000000; font-weight: bold;\">class<\/span> StackRemoteViewsFactory <span style=\"color: #000000; font-weight: bold;\">implements<\/span> RemoteViewsService.<span style=\"color: #006600;\">RemoteViewsFactory<\/span> <span style=\"color: #66cc66;\">&#123;<\/span>\n&#160;\n<span style=\"color: #808080; font-style: italic;\">\/\/... include adapter-like methods here. See the StackView Widget sample.<\/span>\n&#160;\n<span style=\"color: #66cc66;\">&#125;<\/span>\n&#160;<\/pre>\n<h3> <span class=\"mw-headline\" id=\"Sample_application\">Sample application<\/span><\/h3>\n<p>\u8fd9\u4e00\u8282\u7684\u4ee3\u7801\u6458\u5f55\u6765\u81eaStackView Widget sample:<br \/>\n<img src=\"http:\/\/docs.eoeandroid.com\/resources\/samples\/images\/StackWidget.png\" alt=\"StackWidget.png\" \/><br \/>\n\u8fd9\u4e2a\u793a\u4f8b\u5305\u62ec\u4e00\u580610\u89c6\u56fe,\u5b83\u663e\u793a\u503c<span style=\"color:green\">\"0!\"<\/span>\u5230<span style=\"color:green\">\"9!\"<\/span>\u7684\u6837\u4f8bAppwidget,\u5176\u5177\u6709\u8fd9\u4e9b\u4e3b\u8981\u7684\u884c\u4e3a:<br \/>\n<\/p>\n<ul><li>\u7528\u6237\u53ef\u4ee5\u5782\u76f4\u4e0a\u629b\u89c6\u56fe\u7684\u5e94\u7528\u7a0b\u5e8f\u7a97\u53e3\u663e\u793a\u4e0b\u4e00\u4e2a\u6216\u524d\u89c6\u56fe\u3002\u8fd9\u662f\u4e00\u4e2a\u5185\u7f6e\u7684Stack View\u884c\u4e3a\u3002\n<\/li><li>\u5728\u65e0\u9700\u4efb\u4f55\u7528\u6237\u4ea4\u4e92,Appwidget\u901a\u8fc7\u5176\u89c6\u56fe\u81ea\u52a8\u8fdb\u6b65\u5e8f\u5217,\u5c31\u50cf\u4e00\u4e2a\u5e7b\u706f\u7247\u3002\u8fd9\u662f\u7531\u4e8e\u8bbe\u7f6e<span style=\"color:green\">android:autoAdvanceViewId= \"@id\/stack_view\"<\/span>\u5728<span style=\"color:green\">res \/ xml \/ stackwidgetinfo.xml<\/span>\u6587\u4ef6\u3002\u8fd9\u4e2a\u8bbe\u7f6e\u9002\u7528\u4e8e\u89c6\u56feID(\u5728\u672c\u4f8b\u4e2d\u662f\u89c6\u56feID\u7684\u5806\u6808\u89c6\u56fe)\u3002\n<\/li><li>\u5982\u679c\u7528\u6237\u89e6\u6478\u7684\u9876\u89c6\u56fe\uff0cAppwidget\u663e\u793aToast\u6d88\u606f\u201c\u611f\u52a8\u89c6\u56fen\uff0c\u5176\u4e2dn\u662f\u89e6\u6478\u7684\u89c6\u56fe\u7d22\u5f15\uff08\u4f4d\u7f6e\uff09\u3002\u8fd9\u662f\u5982\u4f55\u5b9e\u73b0\u7684\u66f4\u591a\u8ba8\u8bba\uff0c\u8bf7\u53c2\u9605 Adding behavior to individual items\u3002\n<\/li><\/ul>\n<h3> <span class=\"mw-headline\" id=\"Implementing_app_widgets_with_collections\">Implementing app widgets with collections<\/span><\/h3>\n<p>\u5b9e\u73b0\u4e00\u4e2aAppwidget\u96c6\u5408,\u60a8\u9075\u5faa\u76f8\u540c\u7684\u57fa\u672c\u6b65\u9aa4\u7528\u4e8e\u5b9e\u73b0\u4efb\u4f55Appwidget\u3002\u4ee5\u4e0b\u90e8\u5206\u63cf\u8ff0\u4e86\u60a8\u9700\u8981\u6267\u884c\u989d\u5916\u7684\u6b65\u9aa4\u6765\u5b9e\u73b0\u4e00\u4e2aAppwidget\u96c6\u5408\u3002\n<\/p>\n<h3> <span class=\"mw-headline\" id=\"Manifest_for_app_widgets_with_collections\">Manifest for app widgets with collections<\/span><\/h3>\n<p>\u9664\u4e86\u5728Declaring an App Widget in the Manifest\u5217\u51fa\u7684\u8981\u6c42,\u6709\u53ef\u80fd\u5bf9\u5e94\u7528\u7a0b\u5e8f\u7ec4\u4ef6\u7ed1\u5b9a\u5230\u4f60\u7684RemoteViewsService\u96c6\u5408,\u5fc5\u987b\u58f0\u660e\u670d\u52a1\u5728\u4f60\u7684Manifest\u6587\u4ef6\u4e0eBIND_REMOTEVIEWS\u8bb8\u53ef\u3002\u8fd9\u53ef\u4ee5\u9632\u6b62\u5176\u4ed6\u5e94\u7528\u7a0b\u5e8f\u4ece\u81ea\u7531\u8bbf\u95ee\u60a8\u7684\u5e94\u7528\u7a0b\u5e8f\u5c0f\u90e8\u4ef6\u7684\u6570\u636e\u3002\u4f8b\u5982,\u5f53\u521b\u5efa\u4e00\u4e2aAppwidget,\u4f7f\u7528RemoteViewsService\u586b\u5145\u4e00\u4e2a\u96c6\u5408\u89c6\u56fe,\u6e05\u5355\u6761\u76ee\u53ef\u80fd\u770b\u8d77\u6765\u50cf\u8fd9\u6837:\n<\/p>\n<pre class=\"java\">&#160;\n&lt;service android:name=<span style=\"color: #ff0000;\">&quot;MyWidgetService&quot;<\/span>\n...\n<span style=\"color: #006600;\">android<\/span>:permission=<span style=\"color: #ff0000;\">&quot;android.permission.BIND_REMOTEVIEWS&quot;<\/span> \/&gt;\n&#160;<\/pre>\n<p><span style=\"color:green\">android:name = \" MyWidgetService\"<\/span>\u662f\u6307\u4f60RemoteViewsService\u7684\u5b50\u7c7b\u3002\n<\/p>\n<h3> <span class=\"mw-headline\" id=\"Layout_for_app_widgets_with_collections\">Layout for app widgets with collections<\/span><\/h3>\n<p>\u4e3b\u8981\u7684\u8981\u6c42Appwidget\u5e03\u5c40\u7684XML\u6587\u4ef6,\u5b83\u5305\u542b\u4e00\u4e2a\u96c6\u5408\u7684\u89c2\u70b9:ListView, GridView, StackView,\u6216AdapterViewFlipper\u3002\u8fd9\u662f<span style=\"color:green\">widget_layout.xml<\/span>\u7684StackView Widget sample:\n<\/p>\n<pre class=\"java\">&#160;\n&lt;?xml version=<span style=\"color: #ff0000;\">&quot;1.0&quot;<\/span> encoding=<span style=\"color: #ff0000;\">&quot;utf-8&quot;<\/span>?&gt;\n&#160;\n&lt;FrameLayout xmlns:android=<span style=\"color: #ff0000;\">&quot;http:\/\/schemas.android.com\/apk\/res\/android&quot;<\/span>\n    android:layout_width=<span style=\"color: #ff0000;\">&quot;match_parent&quot;<\/span>\n    android:layout_height=<span style=\"color: #ff0000;\">&quot;match_parent&quot;<\/span>&gt;\n    &lt;StackView xmlns:android=<span style=\"color: #ff0000;\">&quot;http:\/\/schemas.android.com\/apk\/res\/android&quot;<\/span>\n        android:id=<span style=\"color: #ff0000;\">&quot;@+id\/stack_view&quot;<\/span>\n        android:layout_width=<span style=\"color: #ff0000;\">&quot;match_parent&quot;<\/span>\n        android:layout_height=<span style=\"color: #ff0000;\">&quot;match_parent&quot;<\/span>\n        android:gravity=<span style=\"color: #ff0000;\">&quot;center&quot;<\/span>\n        android:loopViews=<span style=\"color: #ff0000;\">&quot;true&quot;<\/span> \/&gt;\n    &lt;TextView xmlns:android=<span style=\"color: #ff0000;\">&quot;http:\/\/schemas.android.com\/apk\/res\/android&quot;<\/span>\n        android:id=<span style=\"color: #ff0000;\">&quot;@+id\/empty_view&quot;<\/span>\n        android:layout_width=<span style=\"color: #ff0000;\">&quot;match_parent&quot;<\/span>\n        android:layout_height=<span style=\"color: #ff0000;\">&quot;match_parent&quot;<\/span>\n        android:gravity=<span style=\"color: #ff0000;\">&quot;center&quot;<\/span>\n        android:background=<span style=\"color: #ff0000;\">&quot;@drawable\/widget_item_background&quot;<\/span>\n        android:textColor=<span style=\"color: #ff0000;\">&quot;#ffffff&quot;<\/span>\n        android:textStyle=<span style=\"color: #ff0000;\">&quot;bold&quot;<\/span>\n        android:text=<span style=\"color: #ff0000;\">&quot;@string\/empty_view_text&quot;<\/span>\n        android:textSize=<span style=\"color: #ff0000;\">&quot;20sp&quot;<\/span> \/&gt;\n&lt;\/FrameLayout&gt;\n&#160;<\/pre>\n<p>\u9700\u8981\u6ce8\u610f\u7684\u662f\u7a7a\u89c6\u56fe\uff0c\u5fc5\u987b\u6536\u96c6\u5144\u5f1f\u59d0\u59b9\u7684\u96c6\u5408\u89c6\u56fe\uff0c\u8fd9\u7a7a\u89c6\u56fe\u8868\u793a\u7a7a\u72b6\u6001\u3002<br \/>\n<br \/>\n\u9664\u4e86\u5e03\u5c40\u6587\u4ef6\u4e3a\u6574\u4e2aAppwidget,\u60a8\u5fc5\u987b\u521b\u5efa\u53e6\u4e00\u4e2a\u5e03\u5c40\u6587\u4ef6,\u5b83\u5b9a\u4e49\u4e86\u5e03\u5c40\u4e2d\u6bcf\u4e00\u9879\u7684\u96c6\u5408(\u4f8b\u5982,\u6bcf\u672c\u4e66\u7684\u85cf\u4e66\u5e03\u5c40)\u3002\u4f8b\u5982,StackView Widget sample\u53ea\u6709\u4e00\u4e2a\u5e03\u5c40\u6587\u4ef6,<span style=\"color:green\">widget_item.xml<\/span>,\u56e0\u4e3a\u6240\u6709\u9879\u76ee\u4f7f\u7528\u76f8\u540c\u7684\u5e03\u5c40\u3002\u4f46WeatherList Widget\u793a\u4f8b\u6709\u4e24\u4e2a\u5e03\u5c40\u6587\u4ef6:<span style=\"color:green\">dark_widget_item.xml<\/span>\u548c<span style=\"color:green\">light_widget_item.xml<\/span>\u3002\n<\/p>\n<h3> <span class=\"mw-headline\" id=\"AppWidgetProvider_class_for_app_widgets_with_collections\">AppWidgetProvider class for app widgets with collections<\/span><\/h3>\n<p>\u4e0e\u5e38\u89c4Appwidget,\u5927\u90e8\u5206\u4ee3\u7801\u5728\u60a8\u7684AppWidgetProvider\u5b50\u7c7b\u4e2d\u4e00\u822c\u4f1a\u5728onUpdate()\u65b9\u6cd5\u3002\u5728\u60a8\u7684\u5b9e\u73b0\u7684\u4e3b\u8981\u533a\u522b\u4e3aonUpdate()\u65b9\u6cd5\u5728\u521b\u5efa\u4e00\u4e2aAppwidget\u96c6\u5408,\u60a8\u5fc5\u987b\u8c03\u7528setRemoteAdapter()\u65b9\u6cd5\u3002\u8fd9\u544a\u8bc9\u96c6\u5408\u89c6\u56fe\u4ece\u54ea\u91cc\u5f97\u5230\u6570\u636e\u3002\u7136\u540e\u8fd4\u56de\u4f60\u7684RemoteViewsService\u53ef\u4ee5\u5b9e\u73b0RemoteViewsFactory,\u548c\u5c0f\u90e8\u4ef6\u53ef\u4ee5\u63d0\u4f9b\u9002\u5f53\u7684\u6570\u636e\u3002 \u5f53\u4f60\u8c03\u7528\u8fd9\u4e2a\u65b9\u6cd5,\u60a8\u5fc5\u987b\u901a\u8fc7\u4e00\u4e2aintent\u6307\u5411\u60a8\u7684\u5b9e\u73b0\u548c\u5e94\u7528\u7a0b\u5e8f\u7684\u5c0f\u90e8\u4ef6ID RemoteViewsService\u6307\u5b9aAppwidget\u66f4\u65b0\u3002<br \/>\n<br \/>\n\u4f8b\u5982,\u8fd9\u91cc\u7684StackView\u7684\u5c0f\u90e8\u4ef6\u793a\u4f8b\u5b9e\u73b0\u4e86onUpdate()\u56de\u8c03\u65b9\u6cd5\u6765\u8bbe\u7f6eRemoteViewsService\u4f5c\u4e3a\u8fdc\u7a0b\u9002\u914d\u5668\u7684Appwidget\u96c6\u5408:\n<\/p>\n<pre class=\"java\">&#160;\n<span style=\"color: #000000; font-weight: bold;\">public<\/span> <span style=\"color: #993333;\">void<\/span> onUpdate<span style=\"color: #66cc66;\">&#40;<\/span><a href=\"http:\/\/www.google.com\/search?hl=en&amp;q=allinurl%3AContext+java.sun.com&amp;btnI=I%27m%20Feeling%20Lucky\"><span style=\"color: #aaaadd; font-weight: bold;\">Context<\/span><\/a> context, AppWidgetManager appWidgetManager,\n<span style=\"color: #993333;\">int<\/span><span style=\"color: #66cc66;\">&#91;<\/span><span style=\"color: #66cc66;\">&#93;<\/span> appWidgetIds<span style=\"color: #66cc66;\">&#41;<\/span> <span style=\"color: #66cc66;\">&#123;<\/span>\n    <span style=\"color: #808080; font-style: italic;\">\/\/ update each of the app widgets with the remote adapter<\/span>\n    <span style=\"color: #b1b100;\">for<\/span> <span style=\"color: #66cc66;\">&#40;<\/span><span style=\"color: #993333;\">int<\/span> i = <span style=\"color: #cc66cc;\">0<\/span>; i &lt; appWidgetIds.<span style=\"color: #006600;\">length<\/span>; ++i<span style=\"color: #66cc66;\">&#41;<\/span> <span style=\"color: #66cc66;\">&#123;<\/span>\n&#160;\n        <span style=\"color: #808080; font-style: italic;\">\/\/ Set up the intent that starts the StackViewService, which will<\/span>\n        <span style=\"color: #808080; font-style: italic;\">\/\/ provide the views for this collection.<\/span>\n        Intent intent = <span style=\"color: #000000; font-weight: bold;\">new<\/span> Intent<span style=\"color: #66cc66;\">&#40;<\/span>context, StackWidgetService.<span style=\"color: #000000; font-weight: bold;\">class<\/span><span style=\"color: #66cc66;\">&#41;<\/span>;\n        <span style=\"color: #808080; font-style: italic;\">\/\/ Add the app widget ID to the intent extras.<\/span>\n        intent.<span style=\"color: #006600;\">putExtra<\/span><span style=\"color: #66cc66;\">&#40;<\/span>AppWidgetManager.<span style=\"color: #006600;\">EXTRA_APPWIDGET_ID<\/span>, appWidgetIds<span style=\"color: #66cc66;\">&#91;<\/span>i<span style=\"color: #66cc66;\">&#93;<\/span><span style=\"color: #66cc66;\">&#41;<\/span>;\n        intent.<span style=\"color: #006600;\">setData<\/span><span style=\"color: #66cc66;\">&#40;<\/span>Uri.<span style=\"color: #006600;\">parse<\/span><span style=\"color: #66cc66;\">&#40;<\/span>intent.<span style=\"color: #006600;\">toUri<\/span><span style=\"color: #66cc66;\">&#40;<\/span>Intent.<span style=\"color: #006600;\">URI_INTENT_SCHEME<\/span><span style=\"color: #66cc66;\">&#41;<\/span><span style=\"color: #66cc66;\">&#41;<\/span><span style=\"color: #66cc66;\">&#41;<\/span>;\n        <span style=\"color: #808080; font-style: italic;\">\/\/ Instantiate the RemoteViews object for the App Widget layout.<\/span>\n        RemoteViews rv = <span style=\"color: #000000; font-weight: bold;\">new<\/span> RemoteViews<span style=\"color: #66cc66;\">&#40;<\/span>context.<span style=\"color: #006600;\">getPackageName<\/span><span style=\"color: #66cc66;\">&#40;<\/span><span style=\"color: #66cc66;\">&#41;<\/span>, R.<span style=\"color: #006600;\">layout<\/span>.<span style=\"color: #006600;\">widget_layout<\/span><span style=\"color: #66cc66;\">&#41;<\/span>;\n        <span style=\"color: #808080; font-style: italic;\">\/\/ Set up the RemoteViews object to use a RemoteViews adapter. <\/span>\n        <span style=\"color: #808080; font-style: italic;\">\/\/ This adapter connects<\/span>\n        <span style=\"color: #808080; font-style: italic;\">\/\/ to a RemoteViewsService  through the specified intent.<\/span>\n        <span style=\"color: #808080; font-style: italic;\">\/\/ This is how you populate the data.<\/span>\n        rv.<span style=\"color: #006600;\">setRemoteAdapter<\/span><span style=\"color: #66cc66;\">&#40;<\/span>appWidgetIds<span style=\"color: #66cc66;\">&#91;<\/span>i<span style=\"color: #66cc66;\">&#93;<\/span>, R.<span style=\"color: #006600;\">id<\/span>.<span style=\"color: #006600;\">stack_view<\/span>, intent<span style=\"color: #66cc66;\">&#41;<\/span>;\n&#160;\n        <span style=\"color: #808080; font-style: italic;\">\/\/ The empty view is displayed when the collection has no items. <\/span>\n        <span style=\"color: #808080; font-style: italic;\">\/\/ It should be in the same layout used to instantiate the RemoteViews<\/span>\n        <span style=\"color: #808080; font-style: italic;\">\/\/ object above.<\/span>\n        rv.<span style=\"color: #006600;\">setEmptyView<\/span><span style=\"color: #66cc66;\">&#40;<\/span>R.<span style=\"color: #006600;\">id<\/span>.<span style=\"color: #006600;\">stack_view<\/span>, R.<span style=\"color: #006600;\">id<\/span>.<span style=\"color: #006600;\">empty_view<\/span><span style=\"color: #66cc66;\">&#41;<\/span>;\n&#160;\n        <span style=\"color: #808080; font-style: italic;\">\/\/<\/span>\n        <span style=\"color: #808080; font-style: italic;\">\/\/ Do additional processing specific to this app widget...<\/span>\n        <span style=\"color: #808080; font-style: italic;\">\/\/<\/span>\n&#160;\n        appWidgetManager.<span style=\"color: #006600;\">updateAppWidget<\/span><span style=\"color: #66cc66;\">&#40;<\/span>appWidgetIds<span style=\"color: #66cc66;\">&#91;<\/span>i<span style=\"color: #66cc66;\">&#93;<\/span>, rv<span style=\"color: #66cc66;\">&#41;<\/span>;   \n    <span style=\"color: #66cc66;\">&#125;<\/span>\n    <span style=\"color: #000000; font-weight: bold;\">super<\/span>.<span style=\"color: #006600;\">onUpdate<\/span><span style=\"color: #66cc66;\">&#40;<\/span>context, appWidgetManager, appWidgetIds<span style=\"color: #66cc66;\">&#41;<\/span>;\n<span style=\"color: #66cc66;\">&#125;<\/span>\n&#160;<\/pre>\n<h3> <span class=\"mw-headline\" id=\"RemoteViewsService_class\">RemoteViewsService class<\/span><\/h3>\n<div style=\"width:310px; float:right; background-color: white; margin: 0px 0 2px 10px;padding: 0 0 0 10px;border-left: 4px solid;border-color: #ADFF2F;\">\n<p>\u6301\u4e45\u5316\u6570\u636e<br \/>\n<\/p>\n\u4f60\u4e0d\u80fd\u4f9d\u8d56\u4e00\u4e2a\u5355\u4e00\u5b9e\u4f8b\u7684\u670d\u52a1,\u6216\u4efb\u4f55\u5b83\u6240\u5305\u542b\u7684\u6570\u636e\u3002\u4f60\u4e0d\u5e94\u5728\u4f60\u7684RemoteViewsService\u5b58\u50a8\u4efb\u4f55\u6570\u636e(\u9664\u975e\u5b83\u662f\u9759\u6001\u7684)\u3002\u5982\u679c\u4f60\u60f3\u8ba9\u4f60\u7684Appwidget\u7684\u6570\u636e\u6301\u4e45\u5316,\u6700\u597d\u7684\u65b9\u6cd5\u662f\u4f7f\u7528\u4e00\u4e2aContentProvider\u4f7f\u5176\u6570\u636e\u6301\u7eed\u8d85\u8d8a\u8fc7\u7a0b\u4e2d\u7684\u751f\u547d\u5468\u671f<\/div>\n<p>\u5982\u4e0a\u6240\u8ff0,\u4f60RemoteViewsFactory RemoteViewsService\u5b50\u7c7b\u63d0\u4f9b\u4e86\u7528\u4e8e\u586b\u5145\u8fdc\u7a0b\u96c6\u5408\u89c6\u56fe\u3002\n\u5177\u4f53\u6765\u8bf4,\u60a8\u9700\u8981\u6267\u884c\u4ee5\u4e0b\u6b65\u9aa4:<br \/>\n<br \/>\n1.RemoteViewsService\u5b50\u7c7b\u3002 \u901a\u8fc7RemoteViewsService\u662f\u670d\u52a1\u8fdc\u7a0b\u9002\u914d\u5668\u53ef\u4ee5\u8bf7\u6c42RemoteViews\u3002<br \/>\n2.\u5728\u4f60RemoteViewsService\u5b50\u7c7b,\u5305\u62ec\u4e00\u4e2a\u7c7b,\u5b83\u5b9e\u73b0\u4e86RemoteViewsFactory\u63a5\u53e3\u3002 RemoteViewsFactory\u662f\u4e00\u4e2a\u63a5\u53e3\u7684\u9002\u914d\u5668\u4e4b\u95f4\u4e00\u4e2a\u8fdc\u7a0b\u96c6\u5408\u89c6\u56fe(\u5982\u5217ListView,GridView,\u7b49\u7b49)\u548c\u5e95\u5c42\u7684\u6570\u636e\u89c6\u56fe\u3002\u60a8\u7684\u5b9e\u73b0\u8d1f\u8d23\u505a\u51fa\u4e00\u4e2aRemoteViews\u5bf9\u8c61\u4e2d\u6bcf\u4e2a\u9879\u76ee\u7684\u6570\u636e\u96c6\u3002\u8fd9\u4e2a\u63a5\u53e3\u662f\u4e00\u4e2a\u7626\u5305\u88c5\u5668\u7684Adapter\u3002<br \/>\n<br \/>\n\u4e3b\u8981\u5185\u5bb9\u662f\u5176RemoteViewsFactory\u7684RemoteViewsService\u5b9e\u73b0\uff0c\u5982\u4e0b\u6240\u8ff0\u3002\n<\/p>\n<h3> <span class=\"mw-headline\" id=\"RemoteViewsFactory_interface\">RemoteViewsFactory interface<\/span><\/h3>\n<p>\u60a8\u7684\u81ea\u5b9a\u4e49\u7c7b,\u5b83\u5b9e\u73b0\u4e86RemoteViewsFactory\u63a5\u53e3\u63d0\u4f9b\u4e86Appwidget\u7684\u6570\u636e\u9879\u7684\u96c6\u5408\u3002\u8981\u505a\u5230\u8fd9\u4e00\u70b9,\u5b83\u7ed3\u5408\u4e86\u4f60\u7684Appwidget\u6761\u76eeXML\u5e03\u5c40\u6587\u4ef6\u4e0e\u4e00\u4e2a\u6e90\u7684\u6570\u636e\u3002\u8fd9\u4e2a\u6570\u636e\u6e90\u53ef\u4ee5\u662f\u4efb\u4f55\u5185\u5bb9,\u4ece\u6570\u636e\u5e93\u5230\u4e00\u4e2a\u7b80\u5355\u7684\u6570\u7ec4\u3002\u5728StackView Widget sample,\u6570\u636e\u6e90\u662f<span style=\"color:green\">WidgetItems<\/span>\u6570\u7ec4\u3002 \u8fd9\u4e2aRemoteViewsFactory\u51fd\u6570\u4f5c\u4e3a\u4e00\u4e2a\u9002\u914d\u5668\u80f6\u6570\u636e\u5230\u8fdc\u7a0b\u96c6\u5408\u89c6\u56fe\u3002<br \/>\n<br \/>\n\u6700\u91cd\u8981\u7684\u4e24\u4e2a\u65b9\u6cd5,\u4f60\u9700\u8981\u4e3a\u4f60\u7684RemoteViewsFactory\u5b50\u7c7b\u5b9e\u73b0\u662fonCreate()\u548cgetViewAt()\u3002<br \/>\n<br \/>\n\u5728\u7cfb\u7edf\u8c03\u7528onCreate\uff08\uff09\u65b9\u6cd5\u4e2d\u521b\u5efa\u60a8\u7684factory \u3002\u8fd9\u662f\u4f60\u5efa\u7acb\u4efb\u4f55\u8fde\u63a5\u548c\/\u6216\u6e38\u6807\u5230\u6570\u636e\u6e90\u3002\u4f8b\u5982,StackView Widget sample\u4f7f\u7528onCreate()\u6765\u521d\u59cb\u5316<span style=\"color:green\">WidgetItem<\/span>\u5bf9\u8c61\u7684\u6570\u7ec4\u3002 \u5f53\u4f60\u7684Appwidget\u662f\u6d3b\u8dc3\u7684,\u7cfb\u7edf\u8bbf\u95ee\u8fd9\u4e9b\u5bf9\u8c61\u4f7f\u7528\u6570\u7ec4\u4e2d\u7684\u7d22\u5f15\u4f4d\u7f6e\u548c\u5b83\u4eec\u6240\u5305\u542b\u7684\u6587\u672c\u663e\u793a\u3002\n\u4ee5\u4e0b\u662f\u6458\u81eaStackView Widget sample\u7684RemoteViewsFactory\u5b9e\u73b0,\u5c55\u793a\u4e86\u90e8\u5206\u7684onCreate()\u65b9\u6cd5:\n<\/p>\n<pre class=\"java\">&#160;\n<span style=\"color: #000000; font-weight: bold;\">class<\/span> StackRemoteViewsFactory <span style=\"color: #000000; font-weight: bold;\">implements<\/span>\nRemoteViewsService.<span style=\"color: #006600;\">RemoteViewsFactory<\/span> <span style=\"color: #66cc66;\">&#123;<\/span>\n    <span style=\"color: #000000; font-weight: bold;\">private<\/span> <span style=\"color: #000000; font-weight: bold;\">static<\/span> <span style=\"color: #000000; font-weight: bold;\">final<\/span> <span style=\"color: #993333;\">int<\/span> mCount = <span style=\"color: #cc66cc;\">10<\/span>;\n    <span style=\"color: #000000; font-weight: bold;\">private<\/span> List&lt;WidgetItem&gt; mWidgetItems = <span style=\"color: #000000; font-weight: bold;\">new<\/span> ArrayList&lt;WidgetItem&gt;<span style=\"color: #66cc66;\">&#40;<\/span><span style=\"color: #66cc66;\">&#41;<\/span>;\n    <span style=\"color: #000000; font-weight: bold;\">private<\/span> <a href=\"http:\/\/www.google.com\/search?hl=en&amp;q=allinurl%3AContext+java.sun.com&amp;btnI=I%27m%20Feeling%20Lucky\"><span style=\"color: #aaaadd; font-weight: bold;\">Context<\/span><\/a> mContext;\n    <span style=\"color: #000000; font-weight: bold;\">private<\/span> <span style=\"color: #993333;\">int<\/span> mAppWidgetId;\n&#160;\n    <span style=\"color: #000000; font-weight: bold;\">public<\/span> StackRemoteViewsFactory<span style=\"color: #66cc66;\">&#40;<\/span><a href=\"http:\/\/www.google.com\/search?hl=en&amp;q=allinurl%3AContext+java.sun.com&amp;btnI=I%27m%20Feeling%20Lucky\"><span style=\"color: #aaaadd; font-weight: bold;\">Context<\/span><\/a> context, Intent intent<span style=\"color: #66cc66;\">&#41;<\/span> <span style=\"color: #66cc66;\">&#123;<\/span>\n        mContext = context;\n        mAppWidgetId = intent.<span style=\"color: #006600;\">getIntExtra<\/span><span style=\"color: #66cc66;\">&#40;<\/span>AppWidgetManager.<span style=\"color: #006600;\">EXTRA_APPWIDGET_ID<\/span>,\n                AppWidgetManager.<span style=\"color: #006600;\">INVALID_APPWIDGET_ID<\/span><span style=\"color: #66cc66;\">&#41;<\/span>;\n    <span style=\"color: #66cc66;\">&#125;<\/span>\n&#160;\n    <span style=\"color: #000000; font-weight: bold;\">public<\/span> <span style=\"color: #993333;\">void<\/span> onCreate<span style=\"color: #66cc66;\">&#40;<\/span><span style=\"color: #66cc66;\">&#41;<\/span> <span style=\"color: #66cc66;\">&#123;<\/span>\n        <span style=\"color: #808080; font-style: italic;\">\/\/ In onCreate() you setup any connections \/ cursors to your data source. Heavy lifting,<\/span>\n        <span style=\"color: #808080; font-style: italic;\">\/\/ for example downloading or creating content etc, should be deferred to onDataSetChanged()<\/span>\n        <span style=\"color: #808080; font-style: italic;\">\/\/ or getViewAt(). Taking more than 20 seconds in this call will result in an ANR.<\/span>\n        <span style=\"color: #b1b100;\">for<\/span> <span style=\"color: #66cc66;\">&#40;<\/span><span style=\"color: #993333;\">int<\/span> i = <span style=\"color: #cc66cc;\">0<\/span>; i &lt; mCount; i++<span style=\"color: #66cc66;\">&#41;<\/span> <span style=\"color: #66cc66;\">&#123;<\/span>\n            mWidgetItems.<span style=\"color: #006600;\">add<\/span><span style=\"color: #66cc66;\">&#40;<\/span><span style=\"color: #000000; font-weight: bold;\">new<\/span> WidgetItem<span style=\"color: #66cc66;\">&#40;<\/span>i + <span style=\"color: #ff0000;\">&quot;!&quot;<\/span><span style=\"color: #66cc66;\">&#41;<\/span><span style=\"color: #66cc66;\">&#41;<\/span>;\n        <span style=\"color: #66cc66;\">&#125;<\/span>\n        ...\n    <span style=\"color: #66cc66;\">&#125;<\/span>\n...\n&#160;<\/pre>\n<p>RemoteViewsFactory\u7684\u65b9\u6cd5getViewAt()\u8fd4\u56de\u4e00\u4e2aRemoteViews\u5bf9\u8c61\u5bf9\u5e94\u4e8e\u6307\u5b9a<span style=\"color:green\">position<\/span>\u7684\u6570\u636e\u7684\u6570\u636e\u96c6\u3002\u4ee5\u4e0b\u662fStackView Widget sample\u7684RemoteViewsFactory\u5b9e\u73b0:\n<\/p>\n<pre class=\"java\">&#160;\n<span style=\"color: #000000; font-weight: bold;\">public<\/span> RemoteViews getViewAt<span style=\"color: #66cc66;\">&#40;<\/span><span style=\"color: #993333;\">int<\/span> position<span style=\"color: #66cc66;\">&#41;<\/span> <span style=\"color: #66cc66;\">&#123;<\/span>\n&#160;\n    <span style=\"color: #808080; font-style: italic;\">\/\/ Construct a remote views item based on the app widget item XML file, <\/span>\n    <span style=\"color: #808080; font-style: italic;\">\/\/ and set the text based on the position.<\/span>\n    RemoteViews rv = <span style=\"color: #000000; font-weight: bold;\">new<\/span> RemoteViews<span style=\"color: #66cc66;\">&#40;<\/span>mContext.<span style=\"color: #006600;\">getPackageName<\/span><span style=\"color: #66cc66;\">&#40;<\/span><span style=\"color: #66cc66;\">&#41;<\/span>, R.<span style=\"color: #006600;\">layout<\/span>.<span style=\"color: #006600;\">widget_item<\/span><span style=\"color: #66cc66;\">&#41;<\/span>;\n    rv.<span style=\"color: #006600;\">setTextViewText<\/span><span style=\"color: #66cc66;\">&#40;<\/span>R.<span style=\"color: #006600;\">id<\/span>.<span style=\"color: #006600;\">widget_item<\/span>, mWidgetItems.<span style=\"color: #006600;\">get<\/span><span style=\"color: #66cc66;\">&#40;<\/span>position<span style=\"color: #66cc66;\">&#41;<\/span>.<span style=\"color: #006600;\">text<\/span><span style=\"color: #66cc66;\">&#41;<\/span>;\n&#160;\n    ...\n    <span style=\"color: #808080; font-style: italic;\">\/\/ Return the remote views object.<\/span>\n    <span style=\"color: #000000; font-weight: bold;\">return<\/span> rv;\n<span style=\"color: #66cc66;\">&#125;<\/span>\n&#160;<\/pre>\n<h3> <span class=\"mw-headline\" id=\"Adding_behavior_to_individual_items\">Adding behavior to individual items<\/span><\/h3>\n<p>\u4e0a\u9762\u7684\u5c0f\u8282\u5c06\u5411\u60a8\u5c55\u793a\u5982\u4f55\u7ed1\u5b9a\u6570\u636e\u5230\u4f60\u7684\u5e94\u7528\u7a0b\u5e8f\u5c0f\u90e8\u4ef6\u96c6\u5408\u3002\u4f46\u662f\uff0c\u5982\u679c\u4f60\u60f3\u6dfb\u52a0\u52a8\u6001\u884c\u4e3a\u7684\u96c6\u5408\u89c6\u56fe\u4e2d\u7684\u5404\u4e2a\u9879\u76ee\u5417\uff1f<br \/>\n<br \/>\nUsingtheAppWidgetProviderClass\u6240\u63cf\u8ff0\u7684\u90a3\u6837,\u60a8\u901a\u5e38\u4f7f\u7528setOnClickPendingIntent()\u6765\u8bbe\u7f6e\u4e00\u4e2a\u5bf9\u8c61\u7684\u70b9\u51fb\u884c\u4e3a\u5982\u9020\u6210\u4e00\u4e2a\u6309\u94ae\u4ee5\u542f\u52a8\u4e00\u4e2aActivity\u3002 \u4f46\u8fd9\u79cd\u65b9\u6cd5\u662f\u4e0d\u5141\u8bb8\u5728\u4e00\u4e2a\u5355\u72ec\u7684\u5b50\u89c6\u56fe\u6536\u96c6\u9879\u76ee(\u6f84\u6e05\u4e00\u4e0b,\u5728Gmail\u7684Appwidget\u4f60\u53ef\u4ee5\u4f7f\u7528setOnClickPendingIntent()\u6765\u8bbe\u7f6e\u4e00\u4e2a\u5168\u7403\u6309\u94ae\u542f\u52a8\u5e94\u7528\u7a0b\u5e8f,\u4f8b\u5982\u542f\u52a8\u5e94\u7528\u7a0b\u5e8f\uff0c\u800c\u4e0d\u662f\u5728\u4e2a\u522b\u7684\u6e05\u5355\u9879\u76ee)\u3002\u76f8\u53cd,\u6dfb\u52a0\u96c6\u5408\u4e2d\u7684\u4e2a\u522b\u9879\u76ee\u7684\u70b9\u51fb\u884c\u4e3a\uff0c\u60a8\u53ef\u4ee5\u4f7f\u7528setOnClickFillInIntent\uff08\uff09\u3002\u8fd9\u9700\u8981\u5efa\u7acb\u8d77\u4e00\u4e2a\u60ac\u800c\u672a\u51b3\u7684\u610f\u56fe\u6a21\u677f\u4e3a\u60a8\u7684\u96c6\u5408\u89c6\u56fe,\u7136\u540e\u901a\u8fc7\u4f60\u7684RemoteViewsFactory\u96c6\u5408\u8bbe\u7f6e\u4e00\u4e2a\u4ee3\u66ff\u8005\u610f\u56fe\u4e2d\u7684\u6bcf\u4e00\u9879\u3002<br \/>\n<\/p><p>\u672c\u8282\u4f7f\u7528StackView Widget sample \u6765\u63cf\u8ff0\u5982\u4f55\u5c06\u884c\u4e3a\u6dfb\u52a0\u5230\u4e2a\u522b\u9879\u76ee\u3002\u5728StackView Widget sample ,\u5982\u679c\u7528\u6237\u63a5\u89e6\u5230\u9876\u89c6\u56fe,\u8fd9\u4e2a\u5e94\u7528\u7a0b\u5e8f\u5c0f\u90e8\u4ef6\u663e\u793aToast\u6d88\u606f\u201c\u611f\u52a8\u89c6\u56fen,n\u662f\u6307\u6570(\u4f4d\u7f6e)\u7684\u611f\u52a8\u89c6\u56fe\u3002\u5b83\u662f\u5982\u4f55\u5de5\u4f5c\u7684:\n<\/p>\n<ul><li>\u5728<span style=\"color:green\">StackWidgetProvider<\/span>(\u4e00\u4e2aAppWidgetProvider\u5b50\u7c7b)\u521b\u5efa\u4e00\u4e2a\u60ac\u800c\u672a\u51b3\u7684\u610f\u56fe,\u6709\u4e00\u4e2a\u81ea\u5b9a\u4e49\u7684\u52a8\u4f5c\u79f0<span style=\"color:green\">TOAST_ACTION<\/span>\u3002\n<\/li><li>\u5f53\u7528\u6237\u89e6\u6478\u4e00\u4e2a\u89c6\u56fe,\u76ee\u7684\u662f\u53d1\u5c04\u548c\u5b83\u5e7f\u64ad<span style=\"color:green\">TOAST_ACTION<\/span>\u3002\n<\/li><li>\u8fd9\u5e7f\u64ad\u662f\u62e6\u622a\u4e86<span style=\"color:green\">StackWidgetProvider<\/span>\u7684onReceive()\u65b9\u6cd5,\u5e76Appwidget\u7684\u89e6\u6478\u89c6\u56fe\u663e\u793aToast\u6d88\u606f\u3002\u6570\u636e\u7684\u6536\u96c6\u9879\u76ee\u901a\u8fc7remoteviewsservice\u63d0\u4f9b\u4e86remoteviewsfactory\u3002\n<\/li><\/ul>\n<div style=\"margin: 1em;margin-left: 2em;padding: 0 0 0 .5em;border-left: 4px solid;border-color: #4169e1;\">\n\u6ce8\u610f:StackView Widget sample\u4f7f\u7528\u4e00\u4e2a\u5e7f\u64ad,\u4f46\u5728\u6b64\u7c7b\u573a\u666f\u901a\u5e38\u4e00\u4e2aAppwidget\u5c06\u7b80\u5355\u5730\u542f\u52a8\u4e00\u4e2aActivity\u3002<\/div>\n<h3> <span class=\"mw-headline\" id=\"Setting_up_the_pending_intent_template\">Setting up the pending intent template<\/span><\/h3>\n<p>\u8fd9\u4e2a<span style=\"color:green\">StackWidgetProvider<\/span>(AppWidgetProvider\u5b50\u7c7b)\u8bbe\u7f6e\u4e00\u4e2a\u60ac\u800c\u672a\u51b3\u7684\u610f\u56fe\u3002 \u4e2a\u4eba\u9879\u76ee\u7684\u96c6\u5408\u4e0d\u80fd\u6210\u7acb\u81ea\u5df1\u60ac\u800c\u672a\u51b3\u7684\u610f\u56fe\u3002\u76f8\u53cd\u4f5c\u4e3a\u4e00\u4e2a\u6574\u4f53\u7684\u6536\u96c6\u8bbe\u7f6e\u4e86\u4e00\u4e2a\u6302\u8d77\u7684\u610f\u56fe\u6a21\u677f\uff0c\u4e2a\u522b\u9879\u76ee\u8bbe\u7f6e\u586b\u5145\u7684\u4e00\u4e2a\u9879\u76ee\uff0c\u901a\u8fc7\u9879\u76ee\u7684\u57fa\u7840\u4e0a\uff0c\u521b\u9020\u51fa\u72ec\u7279\u7684\u884c\u4e3a\u610f\u56fe\u3002<br \/>\n<\/p><p>\u5f53\u7528\u6237\u89e6\u6478\u4e00\u4e2a\u89c6\u56fe\u800c\u53d1\u9001\u5e7f\u64ad\u65f6\uff0c\u8fd9\u4e2a\u7c7b\u4e5f\u53ef\u8fdb\u884c\u63a5\u6536\u5e7f\u64ad\u3002\u5b83\u5904\u7406\u8fd9\u4e2a\u4e8b\u4ef6\u5728\u5176onReceive()\u65b9\u6cd5\u3002\u5982\u679c\u610f\u56fe\u7684\u884c\u52a8\u662f<span style=\"color:green\">TOAST_ACTION<\/span>\u3002\n\uff0c\u5728\u5f53\u524d\u89c6\u56feAppwidget\u663e\u793aToast\u6d88\u606f\u3002\n<\/p>\n<pre class=\"java\">&#160;\n<span style=\"color: #000000; font-weight: bold;\">public<\/span> <span style=\"color: #000000; font-weight: bold;\">class<\/span> StackWidgetProvider <span style=\"color: #000000; font-weight: bold;\">extends<\/span> AppWidgetProvider <span style=\"color: #66cc66;\">&#123;<\/span>\n    <span style=\"color: #000000; font-weight: bold;\">public<\/span> <span style=\"color: #000000; font-weight: bold;\">static<\/span> <span style=\"color: #000000; font-weight: bold;\">final<\/span> <a href=\"http:\/\/www.google.com\/search?hl=en&amp;q=allinurl%3AString+java.sun.com&amp;btnI=I%27m%20Feeling%20Lucky\"><span style=\"color: #aaaadd; font-weight: bold;\">String<\/span><\/a> TOAST_ACTION = <span style=\"color: #ff0000;\">&quot;com.example.android.stackwidget.TOAST_ACTION&quot;<\/span>;\n    <span style=\"color: #000000; font-weight: bold;\">public<\/span> <span style=\"color: #000000; font-weight: bold;\">static<\/span> <span style=\"color: #000000; font-weight: bold;\">final<\/span> <a href=\"http:\/\/www.google.com\/search?hl=en&amp;q=allinurl%3AString+java.sun.com&amp;btnI=I%27m%20Feeling%20Lucky\"><span style=\"color: #aaaadd; font-weight: bold;\">String<\/span><\/a> EXTRA_ITEM = <span style=\"color: #ff0000;\">&quot;com.example.android.stackwidget.EXTRA_ITEM&quot;<\/span>;\n&#160;\n    ...\n&#160;\n    <span style=\"color: #808080; font-style: italic;\">\/\/ Called when the BroadcastReceiver receives an Intent broadcast.<\/span>\n    <span style=\"color: #808080; font-style: italic;\">\/\/ Checks to see whether the intent's action is TOAST_ACTION. If it is, the app widget <\/span>\n    <span style=\"color: #808080; font-style: italic;\">\/\/ displays a Toast message for the current item.<\/span>\n    @Override\n    <span style=\"color: #000000; font-weight: bold;\">public<\/span> <span style=\"color: #993333;\">void<\/span> onReceive<span style=\"color: #66cc66;\">&#40;<\/span><a href=\"http:\/\/www.google.com\/search?hl=en&amp;q=allinurl%3AContext+java.sun.com&amp;btnI=I%27m%20Feeling%20Lucky\"><span style=\"color: #aaaadd; font-weight: bold;\">Context<\/span><\/a> context, Intent intent<span style=\"color: #66cc66;\">&#41;<\/span> <span style=\"color: #66cc66;\">&#123;<\/span>\n        AppWidgetManager mgr = AppWidgetManager.<span style=\"color: #006600;\">getInstance<\/span><span style=\"color: #66cc66;\">&#40;<\/span>context<span style=\"color: #66cc66;\">&#41;<\/span>;\n        <span style=\"color: #b1b100;\">if<\/span> <span style=\"color: #66cc66;\">&#40;<\/span>intent.<span style=\"color: #006600;\">getAction<\/span><span style=\"color: #66cc66;\">&#40;<\/span><span style=\"color: #66cc66;\">&#41;<\/span>.<span style=\"color: #006600;\">equals<\/span><span style=\"color: #66cc66;\">&#40;<\/span>TOAST_ACTION<span style=\"color: #66cc66;\">&#41;<\/span><span style=\"color: #66cc66;\">&#41;<\/span> <span style=\"color: #66cc66;\">&#123;<\/span>\n            <span style=\"color: #993333;\">int<\/span> appWidgetId = intent.<span style=\"color: #006600;\">getIntExtra<\/span><span style=\"color: #66cc66;\">&#40;<\/span>AppWidgetManager.<span style=\"color: #006600;\">EXTRA_APPWIDGET_ID<\/span>,\n                AppWidgetManager.<span style=\"color: #006600;\">INVALID_APPWIDGET_ID<\/span><span style=\"color: #66cc66;\">&#41;<\/span>;\n            <span style=\"color: #993333;\">int<\/span> viewIndex = intent.<span style=\"color: #006600;\">getIntExtra<\/span><span style=\"color: #66cc66;\">&#40;<\/span>EXTRA_ITEM, <span style=\"color: #cc66cc;\">0<\/span><span style=\"color: #66cc66;\">&#41;<\/span>;\n            Toast.<span style=\"color: #006600;\">makeText<\/span><span style=\"color: #66cc66;\">&#40;<\/span>context, <span style=\"color: #ff0000;\">&quot;Touched view &quot;<\/span> + viewIndex, Toast.<span style=\"color: #006600;\">LENGTH_SHORT<\/span><span style=\"color: #66cc66;\">&#41;<\/span>.<span style=\"color: #006600;\">show<\/span><span style=\"color: #66cc66;\">&#40;<\/span><span style=\"color: #66cc66;\">&#41;<\/span>;\n        <span style=\"color: #66cc66;\">&#125;<\/span>\n        <span style=\"color: #000000; font-weight: bold;\">super<\/span>.<span style=\"color: #006600;\">onReceive<\/span><span style=\"color: #66cc66;\">&#40;<\/span>context, intent<span style=\"color: #66cc66;\">&#41;<\/span>;\n    <span style=\"color: #66cc66;\">&#125;<\/span>\n&#160;\n    @Override\n    <span style=\"color: #000000; font-weight: bold;\">public<\/span> <span style=\"color: #993333;\">void<\/span> onUpdate<span style=\"color: #66cc66;\">&#40;<\/span><a href=\"http:\/\/www.google.com\/search?hl=en&amp;q=allinurl%3AContext+java.sun.com&amp;btnI=I%27m%20Feeling%20Lucky\"><span style=\"color: #aaaadd; font-weight: bold;\">Context<\/span><\/a> context, AppWidgetManager appWidgetManager, <span style=\"color: #993333;\">int<\/span><span style=\"color: #66cc66;\">&#91;<\/span><span style=\"color: #66cc66;\">&#93;<\/span> appWidgetIds<span style=\"color: #66cc66;\">&#41;<\/span> <span style=\"color: #66cc66;\">&#123;<\/span>\n        <span style=\"color: #808080; font-style: italic;\">\/\/ update each of the app widgets with the remote adapter<\/span>\n        <span style=\"color: #b1b100;\">for<\/span> <span style=\"color: #66cc66;\">&#40;<\/span><span style=\"color: #993333;\">int<\/span> i = <span style=\"color: #cc66cc;\">0<\/span>; i &lt; appWidgetIds.<span style=\"color: #006600;\">length<\/span>; ++i<span style=\"color: #66cc66;\">&#41;<\/span> <span style=\"color: #66cc66;\">&#123;<\/span>\n&#160;\n            <span style=\"color: #808080; font-style: italic;\">\/\/ Sets up the intent that points to the StackViewService that will<\/span>\n            <span style=\"color: #808080; font-style: italic;\">\/\/ provide the views for this collection.<\/span>\n            Intent intent = <span style=\"color: #000000; font-weight: bold;\">new<\/span> Intent<span style=\"color: #66cc66;\">&#40;<\/span>context, StackWidgetService.<span style=\"color: #000000; font-weight: bold;\">class<\/span><span style=\"color: #66cc66;\">&#41;<\/span>;\n            intent.<span style=\"color: #006600;\">putExtra<\/span><span style=\"color: #66cc66;\">&#40;<\/span>AppWidgetManager.<span style=\"color: #006600;\">EXTRA_APPWIDGET_ID<\/span>, appWidgetIds<span style=\"color: #66cc66;\">&#91;<\/span>i<span style=\"color: #66cc66;\">&#93;<\/span><span style=\"color: #66cc66;\">&#41;<\/span>;\n            <span style=\"color: #808080; font-style: italic;\">\/\/ When intents are compared, the extras are ignored, so we need to embed the extras<\/span>\n            <span style=\"color: #808080; font-style: italic;\">\/\/ into the data so that the extras will not be ignored.<\/span>\n            intent.<span style=\"color: #006600;\">setData<\/span><span style=\"color: #66cc66;\">&#40;<\/span>Uri.<span style=\"color: #006600;\">parse<\/span><span style=\"color: #66cc66;\">&#40;<\/span>intent.<span style=\"color: #006600;\">toUri<\/span><span style=\"color: #66cc66;\">&#40;<\/span>Intent.<span style=\"color: #006600;\">URI_INTENT_SCHEME<\/span><span style=\"color: #66cc66;\">&#41;<\/span><span style=\"color: #66cc66;\">&#41;<\/span><span style=\"color: #66cc66;\">&#41;<\/span>;\n            RemoteViews rv = <span style=\"color: #000000; font-weight: bold;\">new<\/span> RemoteViews<span style=\"color: #66cc66;\">&#40;<\/span>context.<span style=\"color: #006600;\">getPackageName<\/span><span style=\"color: #66cc66;\">&#40;<\/span><span style=\"color: #66cc66;\">&#41;<\/span>, R.<span style=\"color: #006600;\">layout<\/span>.<span style=\"color: #006600;\">widget_layout<\/span><span style=\"color: #66cc66;\">&#41;<\/span>;\n            rv.<span style=\"color: #006600;\">setRemoteAdapter<\/span><span style=\"color: #66cc66;\">&#40;<\/span>appWidgetIds<span style=\"color: #66cc66;\">&#91;<\/span>i<span style=\"color: #66cc66;\">&#93;<\/span>, R.<span style=\"color: #006600;\">id<\/span>.<span style=\"color: #006600;\">stack_view<\/span>, intent<span style=\"color: #66cc66;\">&#41;<\/span>;\n&#160;\n            <span style=\"color: #808080; font-style: italic;\">\/\/ The empty view is displayed when the collection has no items. It should be a sibling<\/span>\n            <span style=\"color: #808080; font-style: italic;\">\/\/ of the collection view.<\/span>\n            rv.<span style=\"color: #006600;\">setEmptyView<\/span><span style=\"color: #66cc66;\">&#40;<\/span>R.<span style=\"color: #006600;\">id<\/span>.<span style=\"color: #006600;\">stack_view<\/span>, R.<span style=\"color: #006600;\">id<\/span>.<span style=\"color: #006600;\">empty_view<\/span><span style=\"color: #66cc66;\">&#41;<\/span>;\n&#160;\n            <span style=\"color: #808080; font-style: italic;\">\/\/ This section makes it possible for items to have individualized behavior.<\/span>\n            <span style=\"color: #808080; font-style: italic;\">\/\/ It does this by setting up a pending intent template. Individuals items of a collection<\/span>\n            <span style=\"color: #808080; font-style: italic;\">\/\/ cannot set up their own pending intents. Instead, the collection as a whole sets<\/span>\n            <span style=\"color: #808080; font-style: italic;\">\/\/ up a pending intent template, and the individual items set a fillInIntent<\/span>\n            <span style=\"color: #808080; font-style: italic;\">\/\/ to create unique behavior on an item-by-item basis.<\/span>\n            Intent toastIntent = <span style=\"color: #000000; font-weight: bold;\">new<\/span> Intent<span style=\"color: #66cc66;\">&#40;<\/span>context, StackWidgetProvider.<span style=\"color: #000000; font-weight: bold;\">class<\/span><span style=\"color: #66cc66;\">&#41;<\/span>;\n            <span style=\"color: #808080; font-style: italic;\">\/\/ Set the action for the intent.<\/span>\n            <span style=\"color: #808080; font-style: italic;\">\/\/ When the user touches a particular view, it will have the effect of<\/span>\n            <span style=\"color: #808080; font-style: italic;\">\/\/ broadcasting TOAST_ACTION.<\/span>\n            toastIntent.<span style=\"color: #006600;\">setAction<\/span><span style=\"color: #66cc66;\">&#40;<\/span>StackWidgetProvider.<span style=\"color: #006600;\">TOAST_ACTION<\/span><span style=\"color: #66cc66;\">&#41;<\/span>;\n            toastIntent.<span style=\"color: #006600;\">putExtra<\/span><span style=\"color: #66cc66;\">&#40;<\/span>AppWidgetManager.<span style=\"color: #006600;\">EXTRA_APPWIDGET_ID<\/span>, appWidgetIds<span style=\"color: #66cc66;\">&#91;<\/span>i<span style=\"color: #66cc66;\">&#93;<\/span><span style=\"color: #66cc66;\">&#41;<\/span>;\n            intent.<span style=\"color: #006600;\">setData<\/span><span style=\"color: #66cc66;\">&#40;<\/span>Uri.<span style=\"color: #006600;\">parse<\/span><span style=\"color: #66cc66;\">&#40;<\/span>intent.<span style=\"color: #006600;\">toUri<\/span><span style=\"color: #66cc66;\">&#40;<\/span>Intent.<span style=\"color: #006600;\">URI_INTENT_SCHEME<\/span><span style=\"color: #66cc66;\">&#41;<\/span><span style=\"color: #66cc66;\">&#41;<\/span><span style=\"color: #66cc66;\">&#41;<\/span>;\n            PendingIntent toastPendingIntent = PendingIntent.<span style=\"color: #006600;\">getBroadcast<\/span><span style=\"color: #66cc66;\">&#40;<\/span>context, <span style=\"color: #cc66cc;\">0<\/span>, toastIntent,\n                PendingIntent.<span style=\"color: #006600;\">FLAG_UPDATE_CURRENT<\/span><span style=\"color: #66cc66;\">&#41;<\/span>;\n            rv.<span style=\"color: #006600;\">setPendingIntentTemplate<\/span><span style=\"color: #66cc66;\">&#40;<\/span>R.<span style=\"color: #006600;\">id<\/span>.<span style=\"color: #006600;\">stack_view<\/span>, toastPendingIntent<span style=\"color: #66cc66;\">&#41;<\/span>;\n&#160;\n            appWidgetManager.<span style=\"color: #006600;\">updateAppWidget<\/span><span style=\"color: #66cc66;\">&#40;<\/span>appWidgetIds<span style=\"color: #66cc66;\">&#91;<\/span>i<span style=\"color: #66cc66;\">&#93;<\/span>, rv<span style=\"color: #66cc66;\">&#41;<\/span>;\n        <span style=\"color: #66cc66;\">&#125;<\/span>\n    <span style=\"color: #000000; font-weight: bold;\">super<\/span>.<span style=\"color: #006600;\">onUpdate<\/span><span style=\"color: #66cc66;\">&#40;<\/span>context, appWidgetManager, appWidgetIds<span style=\"color: #66cc66;\">&#41;<\/span>;\n    <span style=\"color: #66cc66;\">&#125;<\/span>\n<span style=\"color: #66cc66;\">&#125;<\/span>\n&#160;<\/pre>\n<h3> <span class=\"mw-headline\" id=\"Setting_the_fill-in_Intent\">Setting the fill-in Intent<\/span><\/h3>\n<p>\u4f60\u7684RemoteViewsFactory\u548b\u6bcf\u4e2a\u9879\u76ee\u96c6\u5408\u4e2d\u5fc5\u987b\u8bbe\u7f6e\u4e00\u4e2a\u4ee3\u66ff\u8005\u610f\u56fe\u3002\u8fd9\u4f7f\u5f97\u5b83\u53ef\u4ee5\u533a\u5206\u4e00\u4e2a\u7ed9\u5b9a\u7684\u9879\u76ee\u7684\u4e2a\u522b\u70b9\u51fb\u52a8\u4f5c\u3002\u586b\u5145\u7684\u610f\u56fe\uff0c\u7136\u540e\u7ed3\u5408pendingintent\u6a21\u677f\u6765\u786e\u5b9a\u6700\u7ec8\u7684\u610f\u56fe\u5c06\u88ab\u6267\u884c\u65f6\u5355\u51fb\u8be5\u9879\u76ee\u3002\n<\/p>\n<pre class=\"java\">&#160;\n<span style=\"color: #000000; font-weight: bold;\">public<\/span> <span style=\"color: #000000; font-weight: bold;\">class<\/span> StackWidgetService <span style=\"color: #000000; font-weight: bold;\">extends<\/span> RemoteViewsService <span style=\"color: #66cc66;\">&#123;<\/span>\n    @Override\n    <span style=\"color: #000000; font-weight: bold;\">public<\/span> RemoteViewsFactory onGetViewFactory<span style=\"color: #66cc66;\">&#40;<\/span>Intent intent<span style=\"color: #66cc66;\">&#41;<\/span> <span style=\"color: #66cc66;\">&#123;<\/span>\n        <span style=\"color: #000000; font-weight: bold;\">return<\/span> <span style=\"color: #000000; font-weight: bold;\">new<\/span> StackRemoteViewsFactory<span style=\"color: #66cc66;\">&#40;<\/span><span style=\"color: #000000; font-weight: bold;\">this<\/span>.<span style=\"color: #006600;\">getApplicationContext<\/span><span style=\"color: #66cc66;\">&#40;<\/span><span style=\"color: #66cc66;\">&#41;<\/span>, intent<span style=\"color: #66cc66;\">&#41;<\/span>;\n    <span style=\"color: #66cc66;\">&#125;<\/span>\n<span style=\"color: #66cc66;\">&#125;<\/span>\n&#160;\n<span style=\"color: #000000; font-weight: bold;\">class<\/span> StackRemoteViewsFactory <span style=\"color: #000000; font-weight: bold;\">implements<\/span> RemoteViewsService.<span style=\"color: #006600;\">RemoteViewsFactory<\/span> <span style=\"color: #66cc66;\">&#123;<\/span>\n    <span style=\"color: #000000; font-weight: bold;\">private<\/span> <span style=\"color: #000000; font-weight: bold;\">static<\/span> <span style=\"color: #000000; font-weight: bold;\">final<\/span> <span style=\"color: #993333;\">int<\/span> mCount = <span style=\"color: #cc66cc;\">10<\/span>;\n    <span style=\"color: #000000; font-weight: bold;\">private<\/span> List&lt;WidgetItem&gt; mWidgetItems = <span style=\"color: #000000; font-weight: bold;\">new<\/span> ArrayList&lt;WidgetItem&gt;<span style=\"color: #66cc66;\">&#40;<\/span><span style=\"color: #66cc66;\">&#41;<\/span>;\n    <span style=\"color: #000000; font-weight: bold;\">private<\/span> <a href=\"http:\/\/www.google.com\/search?hl=en&amp;q=allinurl%3AContext+java.sun.com&amp;btnI=I%27m%20Feeling%20Lucky\"><span style=\"color: #aaaadd; font-weight: bold;\">Context<\/span><\/a> mContext;\n    <span style=\"color: #000000; font-weight: bold;\">private<\/span> <span style=\"color: #993333;\">int<\/span> mAppWidgetId;\n&#160;\n    <span style=\"color: #000000; font-weight: bold;\">public<\/span> StackRemoteViewsFactory<span style=\"color: #66cc66;\">&#40;<\/span><a href=\"http:\/\/www.google.com\/search?hl=en&amp;q=allinurl%3AContext+java.sun.com&amp;btnI=I%27m%20Feeling%20Lucky\"><span style=\"color: #aaaadd; font-weight: bold;\">Context<\/span><\/a> context, Intent intent<span style=\"color: #66cc66;\">&#41;<\/span> <span style=\"color: #66cc66;\">&#123;<\/span>\n        mContext = context;\n        mAppWidgetId = intent.<span style=\"color: #006600;\">getIntExtra<\/span><span style=\"color: #66cc66;\">&#40;<\/span>AppWidgetManager.<span style=\"color: #006600;\">EXTRA_APPWIDGET_ID<\/span>,\n                AppWidgetManager.<span style=\"color: #006600;\">INVALID_APPWIDGET_ID<\/span><span style=\"color: #66cc66;\">&#41;<\/span>;\n    <span style=\"color: #66cc66;\">&#125;<\/span>\n&#160;\n    <span style=\"color: #808080; font-style: italic;\">\/\/ Initialize the data set.<\/span>\n        <span style=\"color: #000000; font-weight: bold;\">public<\/span> <span style=\"color: #993333;\">void<\/span> onCreate<span style=\"color: #66cc66;\">&#40;<\/span><span style=\"color: #66cc66;\">&#41;<\/span> <span style=\"color: #66cc66;\">&#123;<\/span>\n            <span style=\"color: #808080; font-style: italic;\">\/\/ In onCreate() you set up any connections \/ cursors to your data source. Heavy lifting,<\/span>\n            <span style=\"color: #808080; font-style: italic;\">\/\/ for example downloading or creating content etc, should be deferred to onDataSetChanged()<\/span>\n            <span style=\"color: #808080; font-style: italic;\">\/\/ or getViewAt(). Taking more than 20 seconds in this call will result in an ANR.<\/span>\n            <span style=\"color: #b1b100;\">for<\/span> <span style=\"color: #66cc66;\">&#40;<\/span><span style=\"color: #993333;\">int<\/span> i = <span style=\"color: #cc66cc;\">0<\/span>; i &lt; mCount; i++<span style=\"color: #66cc66;\">&#41;<\/span> <span style=\"color: #66cc66;\">&#123;<\/span>\n                mWidgetItems.<span style=\"color: #006600;\">add<\/span><span style=\"color: #66cc66;\">&#40;<\/span><span style=\"color: #000000; font-weight: bold;\">new<\/span> WidgetItem<span style=\"color: #66cc66;\">&#40;<\/span>i + <span style=\"color: #ff0000;\">&quot;!&quot;<\/span><span style=\"color: #66cc66;\">&#41;<\/span><span style=\"color: #66cc66;\">&#41;<\/span>;\n            <span style=\"color: #66cc66;\">&#125;<\/span>\n           ...\n        <span style=\"color: #66cc66;\">&#125;<\/span>\n        ...\n&#160;\n        <span style=\"color: #808080; font-style: italic;\">\/\/ Given the position (index) of a WidgetItem in the array, use the item's text value in <\/span>\n        <span style=\"color: #808080; font-style: italic;\">\/\/ combination with the app widget item XML file to construct a RemoteViews object.<\/span>\n        <span style=\"color: #000000; font-weight: bold;\">public<\/span> RemoteViews getViewAt<span style=\"color: #66cc66;\">&#40;<\/span><span style=\"color: #993333;\">int<\/span> position<span style=\"color: #66cc66;\">&#41;<\/span> <span style=\"color: #66cc66;\">&#123;<\/span>\n            <span style=\"color: #808080; font-style: italic;\">\/\/ position will always range from 0 to getCount() - 1.<\/span>\n&#160;\n            <span style=\"color: #808080; font-style: italic;\">\/\/ Construct a RemoteViews item based on the app widget item XML file, and set the<\/span>\n            <span style=\"color: #808080; font-style: italic;\">\/\/ text based on the position.<\/span>\n            RemoteViews rv = <span style=\"color: #000000; font-weight: bold;\">new<\/span> RemoteViews<span style=\"color: #66cc66;\">&#40;<\/span>mContext.<span style=\"color: #006600;\">getPackageName<\/span><span style=\"color: #66cc66;\">&#40;<\/span><span style=\"color: #66cc66;\">&#41;<\/span>, R.<span style=\"color: #006600;\">layout<\/span>.<span style=\"color: #006600;\">widget_item<\/span><span style=\"color: #66cc66;\">&#41;<\/span>;\n            rv.<span style=\"color: #006600;\">setTextViewText<\/span><span style=\"color: #66cc66;\">&#40;<\/span>R.<span style=\"color: #006600;\">id<\/span>.<span style=\"color: #006600;\">widget_item<\/span>, mWidgetItems.<span style=\"color: #006600;\">get<\/span><span style=\"color: #66cc66;\">&#40;<\/span>position<span style=\"color: #66cc66;\">&#41;<\/span>.<span style=\"color: #006600;\">text<\/span><span style=\"color: #66cc66;\">&#41;<\/span>;\n&#160;\n            <span style=\"color: #808080; font-style: italic;\">\/\/ Next, set a fill-intent, which will be used to fill in the pending intent template<\/span>\n            <span style=\"color: #808080; font-style: italic;\">\/\/ that is set on the collection view in StackWidgetProvider.<\/span>\n            Bundle extras = <span style=\"color: #000000; font-weight: bold;\">new<\/span> Bundle<span style=\"color: #66cc66;\">&#40;<\/span><span style=\"color: #66cc66;\">&#41;<\/span>;\n            extras.<span style=\"color: #006600;\">putInt<\/span><span style=\"color: #66cc66;\">&#40;<\/span>StackWidgetProvider.<span style=\"color: #006600;\">EXTRA_ITEM<\/span>, position<span style=\"color: #66cc66;\">&#41;<\/span>;\n            Intent fillInIntent = <span style=\"color: #000000; font-weight: bold;\">new<\/span> Intent<span style=\"color: #66cc66;\">&#40;<\/span><span style=\"color: #66cc66;\">&#41;<\/span>;\n            fillInIntent.<span style=\"color: #006600;\">putExtras<\/span><span style=\"color: #66cc66;\">&#40;<\/span>extras<span style=\"color: #66cc66;\">&#41;<\/span>;\n            <span style=\"color: #808080; font-style: italic;\">\/\/ Make it possible to distinguish the individual on-click<\/span>\n            <span style=\"color: #808080; font-style: italic;\">\/\/ action of a given item<\/span>\n            rv.<span style=\"color: #006600;\">setOnClickFillInIntent<\/span><span style=\"color: #66cc66;\">&#40;<\/span>R.<span style=\"color: #006600;\">id<\/span>.<span style=\"color: #006600;\">widget_item<\/span>, fillInIntent<span style=\"color: #66cc66;\">&#41;<\/span>;\n&#160;\n            ...\n&#160;\n            <span style=\"color: #808080; font-style: italic;\">\/\/ Return the RemoteViews object.<\/span>\n            <span style=\"color: #000000; font-weight: bold;\">return<\/span> rv;\n        <span style=\"color: #66cc66;\">&#125;<\/span>\n    ...\n    <span style=\"color: #66cc66;\">&#125;<\/span>\n&#160;<\/pre>\n<h3> <span class=\"mw-headline\" id=\"Keeping_Collection_Data_Fresh\">Keeping Collection Data Fresh<\/span><\/h3>\n<p>\u4e0b\u56fe\u8bf4\u660e\u4e86\u53d1\u751f\u5728\u4e00\u4e2aApp Widget\u7684\u4f7f\u7528\u96c6\u5408\u66f4\u65b0\u65f6\u53d1\u751f\u7684\u6d41\u91cf\u3002\u5b83\u663e\u793a\u4e86\u5982\u4f55\u5728App Widget\u7684\u4ee3\u7801\u4ea4\u4e92\u7684RemoteViewsFactory\uff0c\u4ee5\u53ca\u5982\u4f55\u89e6\u53d1\u66f4\u65b0\uff1a\n<img src=\"http:\/\/docs.eoeandroid.com\/images\/appwidget_collections.png\" alt=\"appwidget_collections.png\" \/><br \/>\n\u4e00\u4e2a\u7279\u6027\u7684Appwidget,\u4f7f\u7528\u96c6\u5408\u662f\u80fd\u591f\u7ed9\u7528\u6237\u63d0\u4f9b\u6700\u65b0\u7684\u5185\u5bb9\u3002\u4f8b\u5982,\u8003\u8651Android 3.0 Gmail\u7684Appwidget,\u5b83\u4e3a\u7528\u6237\u63d0\u4f9b\u4e86\u4e00\u4e2a\u4e86\u89e3\u4ed6\u4eec\u7684\u6536\u4ef6\u7bb1\u3002\u8981\u5b9e\u73b0\u8fd9\u4e00\u70b9,\u60a8\u9700\u8981\u80fd\u591f\u89e6\u53d1\u4f60\u7684<span style=\"color:green\">RemoteViewsFactory<\/span>\u3002\n\u548c\u96c6\u5408\u89c6\u56fe\u83b7\u53d6\u548c\u663e\u793a\u65b0\u7684\u6570\u636e\u3002\u4f60\u8fbe\u5230\u8fd9\u4e2a\u4e0eAppWidgetManager\u8c03\u7528notifyAppWidgetViewDataChanged()\u3002 \u8fd9\u4e2a\u8c03\u7528\u4f1a\u5bfc\u81f4\u56de\u8c03\u5230\u4f60\u7684onDataSetChanged RemoteViewsFactory()\u65b9\u6cd5,\u5b83\u7ed9\u4e86\u4f60\u673a\u4f1a\u53bb\u83b7\u53d6\u4efb\u4f55\u65b0\u7684\u6570\u636e\u3002\u6ce8\u610f,\u60a8\u53ef\u4ee5\u6267\u884c\u8fd0\u7b97\u64cd\u4f5c\u540c\u6b65\u5728onDataSetChanged()\u56de\u8c03\u3002\u4f60\u662f\u4fdd\u8bc1\u8fd9\u4e2a\u8c03\u7528\u5c06\u5143\u6570\u636e\u6216\u89c6\u56fe\u4e4b\u524d\u5b8c\u6210\u4ece<span style=\"color:green\">RemoteViewsFactory<\/span>\u6293\u53d6\u6570\u636e\u3002\u6b64\u5916,\u60a8\u53ef\u4ee5\u6267\u884c\u8fd0\u7b97\u64cd\u4f5c\u5728getViewAt()\u65b9\u6cd5\u3002\u5982\u679c\u8fd9\u4e2a\u8c03\u7528\u9700\u8981\u5f88\u957f\u65f6\u95f4,\u52a0\u8f7d\u89c6\u56fe(\u6307\u5b9a\u7684RemoteViewsFactory\u7684getLoadingView()\u65b9\u6cd5)\u5c06\u663e\u793a\u5728\u76f8\u5e94\u7684\u4f4d\u7f6e,\u76f4\u5230\u5b83\u8fd4\u56de\u96c6\u5408\u89c6\u56fe\u3002\n<\/p>"}