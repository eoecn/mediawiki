{"title":"Advanced NFC","text":"<p>\u8d1f\u8d23\u4eba\uff1aRiver \n<\/p><p>\u539f\u6587\u94fe\u63a5\uff1a<a rel=\"nofollow\" target=\"_blank\" class=\"external free\" href=\"http:\/\/docs.eoeandroid.com\/guide\/topics\/connectivity\/nfc\/advanced-nfc.html\">http:\/\/docs.eoeandroid.com\/guide\/topics\/connectivity\/nfc\/advanced-nfc.html<\/a>\n<\/p><p><br \/>\n<\/p>\n<table id=\"toc\" class=\"toc\"><tr><td><div id=\"toctitle\"><h2>\u76ee\u5f55<\/h2><\/div>\n<ul>\n<li class=\"toclevel-1 tocsection-1\"><a href=\"#.E9.AB.98.E7.BA.A7NFC\"><span class=\"tocnumber\">1<\/span> <span class=\"toctext\">\u9ad8\u7ea7NFC<\/span><\/a>\n<ul>\n<li class=\"toclevel-2 tocsection-2\"><a href=\"#.E4.BD.BF.E7.94.A8.E6.94.AF.E6.8C.81.E7.9A.84.E6.A0.87.E7.AD.BE.E6.8A.80.E6.9C.AF\"><span class=\"tocnumber\">1.1<\/span> <span class=\"toctext\">\u4f7f\u7528\u652f\u6301\u7684\u6807\u7b7e\u6280\u672f<\/span><\/a>\n<ul>\n<li class=\"toclevel-3 tocsection-3\"><a href=\"#.E4.BD.BF.E7.94.A8.E6.A0.87.E7.AD.BE.E6.8A.80.E6.9C.AF.E4.BB.A5.E5.8F.8AACTION_TECH_DISVOVERED_intent\"><span class=\"tocnumber\">1.1.1<\/span> <span class=\"toctext\">\u4f7f\u7528\u6807\u7b7e\u6280\u672f\u4ee5\u53caACTION_TECH_DISVOVERED intent<\/span><\/a><\/li>\n<li class=\"toclevel-3 tocsection-4\"><a href=\"#.E8.AF.BB.E5.86.99.E6.A0.87.E7.AD.BE\"><span class=\"tocnumber\">1.1.2<\/span> <span class=\"toctext\">\u8bfb\u5199\u6807\u7b7e<\/span><\/a><\/li>\n<\/ul>\n<\/li>\n<li class=\"toclevel-2 tocsection-5\"><a href=\"#.E4.BD.BF.E7.94.A8.E5.89.8D.E5.8F.B0.E5.88.86.E5.8F.91.E7.B3.BB.E7.BB.9F.28Foreground_Dispatch_System.29\"><span class=\"tocnumber\">1.2<\/span> <span class=\"toctext\">\u4f7f\u7528\u524d\u53f0\u5206\u53d1\u7cfb\u7edf(Foreground Dispatch System)<\/span><\/a><\/li>\n<\/ul>\n<\/li>\n<\/ul>\n<\/td><\/tr><\/table>\n<h1> <span class=\"mw-headline\" id=\".E9.AB.98.E7.BA.A7NFC\"><b>\u9ad8\u7ea7NFC<\/b><\/span><\/h1>\n<p>\u672c\u6587\u6863\u4ecb\u7ecd\u9ad8\u7ea7NFC\u6280\u672f\uff0c\u6bd4\u5982\u5404\u79cd\u6807\u7b7e\u6280\u672f\uff0c\u5199NFC\u6807\u7b7e\uff0c\u4ee5\u53ca\u524d\u666f\u8c03\u5ea6\uff0c\u5b83\u5141\u8bb8\u4e00\u4e2a\u5e94\u7528\u7a0b\u5e8f\u80fd\u591f\u5728\u4f18\u5148\u63a7\u5236intent(\u610f\u56fe)\u5373\u4f7f\u5176\u4ed6\u7684\u7a0b\u5e8ffilter\u4e5f\u6307\u5411\u540c\u4e00\u4e2aintent(\u610f\u56fe)\u3002\n<\/p>\n<h2> <span class=\"mw-headline\" id=\".E4.BD.BF.E7.94.A8.E6.94.AF.E6.8C.81.E7.9A.84.E6.A0.87.E7.AD.BE.E6.8A.80.E6.9C.AF\"><b>\u4f7f\u7528\u652f\u6301\u7684\u6807\u7b7e\u6280\u672f<\/b><\/span><\/h2>\n<p>\u5f53\u4e0eNFC\u6807\u7b7e\u548cAndroid\u4f9b\u7535\u8bbe\u5907\u4ea4\u4e92\u65f6\uff0c\u6211\u4eec\u5728\u6807\u7b7e\u4e0a\u7528\u4ee5\u8bfb\u548c\u5199\u7684\u4e3b\u8981\u683c\u5f0f\u662fNDEF\u3002\u5f53\u4e00\u4e2a\u8bbe\u5907\u626b\u63cf\u5230\u5305\u542bNDEF\u6570\u636e\u7684\u6807\u7b7e\uff0c\n\u5982\u679c\u53ef\u80fd\uff0cAndroid\u4f1a\u63d0\u4f9b\u4e00\u4e2aNdefMessage\u5bf9\u8c61\u6765\u89e3\u6790\u4fe1\u606f\u5e76\u4f20\u8f93\u5b83\u3002\n<\/p><p>\u7136\u540e\uff0c\u5728\u4e00\u4e9b\u60c5\u51b5\u4e0b\uff0c\u5f53\u4f60\u626b\u63cf\u5230\u7684\u6807\u7b7e\u6ca1\u6709\u5305\u542bNDEF\u6570\u636e\u6216\u8005\u5f53NDEF\u6570\u636e\u65e0\u6cd5\u6620\u5c04\u5230MIME\u7c7b\u578b\u6216\u8005URI\uff0c\u5728\u8fd9\u4e9b\u60c5\u51b5\u4e0b\uff0c\u4f60\u9700\u8981\u76f4\u63a5\u6253\u5f00\u4e0e\u6807\u7b7e\u7684\u8fde\u63a5\uff0c\n\u5e76\u4f7f\u7528\u4f60\u81ea\u5df1\u7684\u534f\u8bae(\u4f7f\u7528\u539f\u59cb\u5b57\u8282)\u53bb\u8bfb\u5199\u3002\nAndroid\u4f7f\u7528android.nfc.tech\u5305\u4e3a\u8fd9\u4e9b\u60c5\u51b5\u63d0\u4f9b\u4e86\u901a\u7528\u7684\u652f\u6301\uff0c\u8be6\u89c1Table1.\u4f60\u53ef\u4ee5\u4f7f\u7528getTechList\u65b9\u6cd5\u6765\u786e\u5b9a\u6807\u7b7e\u652f\u6301\u7684\u6280\u672f\u5e76\u4f7f\u7528android.nfc.tech\u63d0\u4f9b\u7684\u7c7b\u6765\u521b\u5efa\u76f8\u5e94\u7684\u6807\u7b7e\u6280\u672f\u5bf9\u8c61\u3002\n<\/p><p>Table1.\u652f\u6301\u7684\u6807\u7b7e\u6280\u672f\n<\/p>\n<table style=\"border-spacing: 0px;margin: 4px 4px; width: 90%; border-left:1px solid #ccc;border-top:1px solid #ccc;\">\n\n\n<tr style=\"background:#DEE8F1;\">\n<th style=\"border-right:1px solid #ccc;border-bottom:1px solid #ccc; padding:5px 15px\"> \u7c7b\n<\/th>\n<th style=\"border-right:1px solid #ccc;border-bottom:1px solid #ccc; padding:5px 15px\"> \u63cf\u8ff0\n<\/th><\/tr>\n<tr style=\"vertical-align:top;\">\n<td style=\"border-right:1px solid #ccc;border-bottom:1px solid #ccc; padding:5px 15px;\">\n<p>TagTechnology\n<\/p>\n<\/td>\n<td style=\"border-right:1px solid #ccc;border-bottom:1px solid #ccc; padding:5px 15px;\">\n<p>\u6240\u6709\u6807\u7b7e\u6280\u672f\u7c7b\u5fc5\u987b\u5b9e\u73b0\u7684\u63a5\u53e3\n<\/p>\n<\/td><\/tr>\n<tr style=\"vertical-align:top;\">\n<td style=\"border-right:1px solid #ccc;border-bottom:1px solid #ccc; padding:5px 15px;\">\n<p>NfcA\n<\/p>\n<\/td>\n<td style=\"border-right:1px solid #ccc;border-bottom:1px solid #ccc; padding:5px 15px;\">\n<p>\u63d0\u4f9bNFC-A(ISO 14443-3A)\u5c5e\u6027\u901a\u9053\u4ee5\u53caI\/O\u64cd\u4f5c\n<\/p>\n<\/td><\/tr>\n<tr style=\"vertical-align:top;\">\n<td style=\"border-right:1px solid #ccc;border-bottom:1px solid #ccc; padding:5px 15px;\">\n<p>NfcB\n<\/p>\n<\/td>\n<td style=\"border-right:1px solid #ccc;border-bottom:1px solid #ccc; padding:5px 15px;\">\n<p>\u63d0\u4f9bNFC-B(ISO 14443-3B)\u5c5e\u6027\u901a\u9053\u4ee5\u53caI\/O\u64cd\u4f5c\n<\/p>\n<\/td><\/tr>\n<tr style=\"vertical-align:top;\">\n<td style=\"border-right:1px solid #ccc;border-bottom:1px solid #ccc; padding:5px 15px;\">\n<p>NfcF\n<\/p>\n<\/td>\n<td style=\"border-right:1px solid #ccc;border-bottom:1px solid #ccc; padding:5px 15px;\">\n<p>\u63d0\u4f9bNFC-F(JIS 6319-4)\u5c5e\u6027\u901a\u9053\u4ee5\u53caI\/O\u64cd\u4f5c\n<\/p>\n<\/td><\/tr>\n<tr style=\"vertical-align:top;\">\n<td style=\"border-right:1px solid #ccc;border-bottom:1px solid #ccc; padding:5px 15px;\">\n<p>NfcV\n<\/p>\n<\/td>\n<td style=\"border-right:1px solid #ccc;border-bottom:1px solid #ccc; padding:5px 15px;\">\n<p>\u63d0\u4f9bNFC-V(ISO 15693)\u5c5e\u6027\u901a\u9053\u4ee5\u53caI\/O\u64cd\u4f5c\n<\/p>\n<\/td><\/tr>\n<tr style=\"vertical-align:top;\">\n<td style=\"border-right:1px solid #ccc;border-bottom:1px solid #ccc; padding:5px 15px;\">\n<p>IsoDep\n<\/p>\n<\/td>\n<td style=\"border-right:1px solid #ccc;border-bottom:1px solid #ccc; padding:5px 15px;\">\n<p>\u63d0\u4f9bISO-DEP(ISO 14443-4)\u5c5e\u6027\u901a\u9053\u4ee5\u53caI\/O\u64cd\u4f5c\n<\/p>\n<\/td><\/tr>\n<tr style=\"vertical-align:top;\">\n<td style=\"border-right:1px solid #ccc;border-bottom:1px solid #ccc; padding:5px 15px;\">\n<p>Ndef\n<\/p>\n<\/td>\n<td style=\"border-right:1px solid #ccc;border-bottom:1px solid #ccc; padding:5px 15px;\">\n<p>\u63d0\u4f9bNDEF\u6570\u636e\u901a\u9053\u4ee5\u53ca\u5728\u5df2\u7ecf\u88ab\u8f6c\u6362\u4e3aNDEF\u683c\u5f0f\u7684NFC\u6807\u7b7e\u4e0a\u7684\u64cd\u4f5c\n<\/p>\n<\/td><\/tr>\n<tr style=\"vertical-align:top;\">\n<td style=\"border-right:1px solid #ccc;border-bottom:1px solid #ccc; padding:5px 15px;\">\n<p>NdefFormatable\n<\/p>\n<\/td>\n<td style=\"border-right:1px solid #ccc;border-bottom:1px solid #ccc; padding:5px 15px;\">\n<p>\u4e3a\u53ef\u80fd\u8f6c\u6362\u4e3aNDEF\u683c\u5f0f\u7684\u6807\u7b7e\u63d0\u4f9b\u8f6c\u6362\u64cd\u4f5c\n<\/p>\n<\/td><\/tr><\/table>\n<p><br \/>\n\u4ee5\u4e0b\u6807\u7b7e\u6280\u672f\u5e76\u4e0d\u9700\u8981\u88abandroid\u4f9b\u7535\u8bbe\u5907\u652f\u6301\u3002\nTbale2 \u53ef\u9009\u652f\u6301\u6807\u7b7e\u6280\u672f\n<\/p>\n<table style=\"border-spacing: 0px;margin: 4px 4px; width: 90%; border-left:1px solid #ccc;border-top:1px solid #ccc;\">\n\n\n<tr style=\"background:#DEE8F1;\">\n<th style=\"border-right:1px solid #ccc;border-bottom:1px solid #ccc; padding:5px 15px\"> \u7c7b\n<\/th>\n<th style=\"border-right:1px solid #ccc;border-bottom:1px solid #ccc; padding:5px 15px\"> \u63cf\u8ff0\n<\/th><\/tr>\n<tr style=\"vertical-align:top;\">\n<td style=\"border-right:1px solid #ccc;border-bottom:1px solid #ccc; padding:5px 15px;\">\n<p>MifareClassic\n<\/p>\n<\/td>\n<td style=\"border-right:1px solid #ccc;border-bottom:1px solid #ccc; padding:5px 15px;\">\n<p>\u63d0\u4f9bMIFARE Classic\u5c5e\u6027\u901a\u9053\u4ee5\u53caI\/O\u64cd\u4f5c\uff0c\u5982\u679c\u8fd9\u4e2aandroid\u8bbe\u5907\u652f\u6301MIFARE\n<\/p>\n<\/td><\/tr>\n<tr style=\"vertical-align:top;\">\n<td style=\"border-right:1px solid #ccc;border-bottom:1px solid #ccc; padding:5px 15px;\">\n<p>MifareUltralight\n<\/p>\n<\/td>\n<td style=\"border-right:1px solid #ccc;border-bottom:1px solid #ccc; padding:5px 15px;\">\n<p>\u63d0\u4f9bMIFARE UItralight\u5c5e\u6027\u901a\u9053\u4ee5\u53caI\/O\u64cd\u4f5c\uff0c\u5982\u679c\u8fd9\u4e2aandroid\u8bbe\u5907\u652f\u6301MIFARE\n<\/p>\n<\/td><\/tr><\/table>\n<p><br \/> \t\t\t\t\t\t\t\n<\/p>\n<h3> <span class=\"mw-headline\" id=\".E4.BD.BF.E7.94.A8.E6.A0.87.E7.AD.BE.E6.8A.80.E6.9C.AF.E4.BB.A5.E5.8F.8AACTION_TECH_DISVOVERED_intent\"><b>\u4f7f\u7528\u6807\u7b7e\u6280\u672f\u4ee5\u53caACTION_TECH_DISVOVERED intent<\/b><\/span><\/h3>\n<p>\u5f53\u8bbe\u5907\u626b\u63cf\u5230\u5305\u542bNDEF\u6570\u636e\u7684\u6807\u7b7e\uff0c\u4f46\u4e0d\u80fd\u88ab\u6620\u5c04\u5230MIME\u6216\u8005URI\uff0c\u6807\u7b7e\u5206\u53d1\u7cfb\u7edf\u4f1a\u8bd5\u7740\u6839\u636eACTION_TECH_DISCOVERED intent\u542f\u52a8\u4e00\u4e2aactivity\u3002\nACTION_TECH_DISCOVERED\u540c\u65f6\u4e5f\u7528\u4e8e\u5f53\u88ab\u626b\u63cf\u7684\u6807\u7b7e\u5305\u542b\u7684\u6570\u636e\u662f\u975eNDEF\u6570\u636e\u65f6\u3002\u6709\u4e86\u8fd9\u4e2a\u56de\u8c03\uff0c\u5982\u679c\u6807\u7b7e\u5206\u53d1\u7cfb\u7edf\u65e0\u6cd5\u89e3\u6790\u6807\u7b7e\u6570\u636e\uff0c\n\u4f60\u8fd8\u662f\u53ef\u4ee5\u76f4\u63a5\u4f7f\u7528\u6807\u7b7e\u4e0a\u7684\u6570\u636e\uff0c\u5f53\u4f7f\u7528\u6807\u7b7e\u4fe1\u606f\u65f6\uff0c\u57fa\u672c\u6b65\u9aa4\u5982\u4e0b\uff1a\n<\/p><p>1.\u4e3aACTION_TECH_DISVOVERED\u5b9a\u4e49\u8fc7\u6ee4\u5668\uff0c\u6307\u5b9a\u4f60\u5e0c\u671b\u5904\u7406\u7684\u6807\u7b7e\u6280\u672f\uff0c\u83b7\u53d6\u66f4\u591a\u4fe1\u606f\uff0c\u8be6\u89c1\n<a rel=\"nofollow\" target=\"_blank\" class=\"external text\" href=\"http:\/\/docs.eoeandroid.com\/guide\/topics\/connectivity\/nfc\/nfc.html#tech-disc\">Filtering for NFC intents<\/a>.\n\u901a\u5e38\u60c5\u51b5\u4e0b\uff0c\u5f53NDEF\u4fe1\u606f\u4e0d\u80fd\u88ab\u6620\u5c04\u6210MIME\u7c7b\u578b\u6216\u8005URI\uff0c\u6216\u8005\u626b\u63cf\u5230\u7684\u6807\u7b7e\u4e0d\u5305\u542bNDEF\u6570\u636e\u65f6\uff0c\u6807\u7b7e\u5206\u53d1\u7cfb\u7edf\u4f1a\u8bd5\u7740\u542f\u52a8\u4e00\u4e2aACTION_TECH_DISCOVERED intent\u3002\n\u66f4\u591a\u5173\u4e8e\u8fd9\u4e9b\u5982\u4f55\u5b9a\u4e49\uff0c\u8be6\u89c1<a rel=\"nofollow\" target=\"_blank\" class=\"external text\" href=\"http:\/\/docs.eoeandroid.com\/guide\/topics\/connectivity\/nfc\/nfc.html#tag-dispatch\">Tag Dispatch System(\u6807\u7b7e\u5206\u53d1\u7cfb\u7edf)<\/a>\n<\/p><p>2.\u5f53\u4f60\u7684\u7a0b\u5e8f\u63a5\u6536\u5230intent\uff0c\u4eceintent\u4e2d\u83b7\u53d6\u5230\u6807\u7b7e\u5bf9\u8c61\uff1a\n<\/p>\n<pre class=\"java\">&#160;\nTag tagFromIntent = intent.<span style=\"color: #006600;\">getParcelableExtra<\/span><span style=\"color: #66cc66;\">&#40;<\/span>NfcAdapter.<span style=\"color: #006600;\">EXTRA_TAG<\/span><span style=\"color: #66cc66;\">&#41;<\/span>;\n&#160;<\/pre>\n<p>3.\u901a\u8fc7\u8c03\u7528android.nfc.tech\u4e2d\u7c7b\u7684\u5176\u4e2d\u4e00\u4e2aget\u5de5\u5382\u65b9\u6cd5\u83b7\u53d6\u4e00\u4e2aTagTechnology\u5b9e\u4f8b\u3002\u5728\u8c03\u7528get\u5de5\u5382\u65b9\u6cd5\u4e4b\u524d\uff0c\n\u4f60\u53ef\u4ee5\u901a\u8fc7getTechList()\u65b9\u6cd5\u83b7\u53d6\u6807\u7b7e\u652f\u6301\u7684\u6280\u672f\u5217\u8868\u3002\n\u6bd4\u5982\uff0c\u4ece\u6807\u7b7e\u83b7\u53d6\u4e00\u4e2aMifareUltralight\u5b9e\u4f8b\uff0c\u5982\u4e0b\uff1a\n<\/p>\n<pre class=\"java\">&#160;\nMifareUltralight.<span style=\"color: #006600;\">get<\/span><span style=\"color: #66cc66;\">&#40;<\/span>intent.<span style=\"color: #006600;\">getParcelableExtra<\/span><span style=\"color: #66cc66;\">&#40;<\/span>NfcAdapter.<span style=\"color: #006600;\">EXTRA_TAG<\/span><span style=\"color: #66cc66;\">&#41;<\/span><span style=\"color: #66cc66;\">&#41;<\/span>;\n&#160;<\/pre>\n<h3> <span class=\"mw-headline\" id=\".E8.AF.BB.E5.86.99.E6.A0.87.E7.AD.BE\"><b>\u8bfb\u5199\u6807\u7b7e<\/b><\/span><\/h3>\n<p>\u8bfb\u5199\u6807\u7b7e\u6d89\u53ca\u5230\u4ece\u4e00\u4e2aintent\u4e2d\u83b7\u53d6\u6807\u7b7e\u4ee5\u53ca\u6253\u5f00\u4e0e\u6807\u7b7e\u95f4\u7684\u901a\u4fe1\u3002\u4f60\u5fc5\u987b\u5b9a\u4e49\u4f60\u81ea\u5df1\u7684\u534f\u8bae\u6808\u8bfb\u5199\u6570\u636e\u5230\u6807\u7b7e\uff0c\n\u7136\u800c\uff0c\u8bf7\u8bb0\u4f4f\uff0c\u5f53\u4f60\u76f4\u63a5\u4f7f\u7528\u6807\u7b7e\u65f6\uff0c\u4f60\u4ecd\u7136\u53ef\u4ee5\u8bfb\u5199NDEF\u6570\u636e\u3002\u8fd9\u4e2a\u53d6\u51b3\u4e8e\u4f60\u81ea\u5df1\u60f3\u600e\u6837\u6784\u5efa\u4e1c\u897f\u3002\u4ee5\u4e0b\u4f8b\u5b50\u6f14\u793a\u4e86\u600e\u6837\u4f7f\u7528MIFARE Ultralight\u6807\u7b7e:\n<\/p>\n<pre class=\"java\">&#160;\n<span style=\"color: #000000; font-weight: bold;\">package<\/span> com.<span style=\"color: #006600;\">example<\/span>.<span style=\"color: #006600;\">android<\/span>.<span style=\"color: #006600;\">nfc<\/span>;\n&#160;\n<span style=\"color: #a1a100;\">import android.nfc.Tag;<\/span>\n<span style=\"color: #a1a100;\">import android.nfc.tech.MifareUltralight;<\/span>\n<span style=\"color: #a1a100;\">import android.util.Log;<\/span>\n<span style=\"color: #a1a100;\">import java.io.IOException;<\/span>\n<span style=\"color: #a1a100;\">import java.nio.charset.Charset;<\/span>\n&#160;\n<span style=\"color: #000000; font-weight: bold;\">public<\/span> <span style=\"color: #000000; font-weight: bold;\">class<\/span> MifareUltralightTagTester <span style=\"color: #66cc66;\">&#123;<\/span>\n&#160;\n    <span style=\"color: #000000; font-weight: bold;\">private<\/span> <span style=\"color: #000000; font-weight: bold;\">static<\/span> <span style=\"color: #000000; font-weight: bold;\">final<\/span> <a href=\"http:\/\/www.google.com\/search?hl=en&amp;q=allinurl%3AString+java.sun.com&amp;btnI=I%27m%20Feeling%20Lucky\"><span style=\"color: #aaaadd; font-weight: bold;\">String<\/span><\/a> TAG = MifareUltralightTagTester.<span style=\"color: #000000; font-weight: bold;\">class<\/span>.<span style=\"color: #006600;\">getSimpleName<\/span><span style=\"color: #66cc66;\">&#40;<\/span><span style=\"color: #66cc66;\">&#41;<\/span>;\n&#160;\n    <span style=\"color: #000000; font-weight: bold;\">public<\/span> <span style=\"color: #993333;\">void<\/span> writeTag<span style=\"color: #66cc66;\">&#40;<\/span>Tag tag, <a href=\"http:\/\/www.google.com\/search?hl=en&amp;q=allinurl%3AString+java.sun.com&amp;btnI=I%27m%20Feeling%20Lucky\"><span style=\"color: #aaaadd; font-weight: bold;\">String<\/span><\/a> tagText<span style=\"color: #66cc66;\">&#41;<\/span> <span style=\"color: #66cc66;\">&#123;<\/span>\n        MifareUltralight ultralight = MifareUltralight.<span style=\"color: #006600;\">get<\/span><span style=\"color: #66cc66;\">&#40;<\/span>tag<span style=\"color: #66cc66;\">&#41;<\/span>;\n        <span style=\"color: #000000; font-weight: bold;\">try<\/span> <span style=\"color: #66cc66;\">&#123;<\/span>\n            ultralight.<span style=\"color: #006600;\">connect<\/span><span style=\"color: #66cc66;\">&#40;<\/span><span style=\"color: #66cc66;\">&#41;<\/span>;\n            ultralight.<span style=\"color: #006600;\">writePage<\/span><span style=\"color: #66cc66;\">&#40;<\/span><span style=\"color: #cc66cc;\">4<\/span>, <span style=\"color: #ff0000;\">&quot;abcd&quot;<\/span>.<span style=\"color: #006600;\">getBytes<\/span><span style=\"color: #66cc66;\">&#40;<\/span>Charset.<span style=\"color: #006600;\">forName<\/span><span style=\"color: #66cc66;\">&#40;<\/span><span style=\"color: #ff0000;\">&quot;US-ASCII&quot;<\/span><span style=\"color: #66cc66;\">&#41;<\/span><span style=\"color: #66cc66;\">&#41;<\/span><span style=\"color: #66cc66;\">&#41;<\/span>;\n            ultralight.<span style=\"color: #006600;\">writePage<\/span><span style=\"color: #66cc66;\">&#40;<\/span><span style=\"color: #cc66cc;\">5<\/span>, <span style=\"color: #ff0000;\">&quot;efgh&quot;<\/span>.<span style=\"color: #006600;\">getBytes<\/span><span style=\"color: #66cc66;\">&#40;<\/span>Charset.<span style=\"color: #006600;\">forName<\/span><span style=\"color: #66cc66;\">&#40;<\/span><span style=\"color: #ff0000;\">&quot;US-ASCII&quot;<\/span><span style=\"color: #66cc66;\">&#41;<\/span><span style=\"color: #66cc66;\">&#41;<\/span><span style=\"color: #66cc66;\">&#41;<\/span>;\n            ultralight.<span style=\"color: #006600;\">writePage<\/span><span style=\"color: #66cc66;\">&#40;<\/span><span style=\"color: #cc66cc;\">6<\/span>, <span style=\"color: #ff0000;\">&quot;ijkl&quot;<\/span>.<span style=\"color: #006600;\">getBytes<\/span><span style=\"color: #66cc66;\">&#40;<\/span>Charset.<span style=\"color: #006600;\">forName<\/span><span style=\"color: #66cc66;\">&#40;<\/span><span style=\"color: #ff0000;\">&quot;US-ASCII&quot;<\/span><span style=\"color: #66cc66;\">&#41;<\/span><span style=\"color: #66cc66;\">&#41;<\/span><span style=\"color: #66cc66;\">&#41;<\/span>;\n            ultralight.<span style=\"color: #006600;\">writePage<\/span><span style=\"color: #66cc66;\">&#40;<\/span><span style=\"color: #cc66cc;\">7<\/span>, <span style=\"color: #ff0000;\">&quot;mnop&quot;<\/span>.<span style=\"color: #006600;\">getBytes<\/span><span style=\"color: #66cc66;\">&#40;<\/span>Charset.<span style=\"color: #006600;\">forName<\/span><span style=\"color: #66cc66;\">&#40;<\/span><span style=\"color: #ff0000;\">&quot;US-ASCII&quot;<\/span><span style=\"color: #66cc66;\">&#41;<\/span><span style=\"color: #66cc66;\">&#41;<\/span><span style=\"color: #66cc66;\">&#41;<\/span>;\n        <span style=\"color: #66cc66;\">&#125;<\/span> <span style=\"color: #000000; font-weight: bold;\">catch<\/span> <span style=\"color: #66cc66;\">&#40;<\/span><a href=\"http:\/\/www.google.com\/search?hl=en&amp;q=allinurl%3AIOException+java.sun.com&amp;btnI=I%27m%20Feeling%20Lucky\"><span style=\"color: #aaaadd; font-weight: bold;\">IOException<\/span><\/a> e<span style=\"color: #66cc66;\">&#41;<\/span> <span style=\"color: #66cc66;\">&#123;<\/span>\n            Log.<span style=\"color: #006600;\">e<\/span><span style=\"color: #66cc66;\">&#40;<\/span>TAG, <span style=\"color: #ff0000;\">&quot;IOException while closing MifareUltralight...&quot;<\/span>, e<span style=\"color: #66cc66;\">&#41;<\/span>;\n        <span style=\"color: #66cc66;\">&#125;<\/span> <span style=\"color: #000000; font-weight: bold;\">finally<\/span> <span style=\"color: #66cc66;\">&#123;<\/span>\n            <span style=\"color: #000000; font-weight: bold;\">try<\/span> <span style=\"color: #66cc66;\">&#123;<\/span>\n                ultralight.<span style=\"color: #006600;\">close<\/span><span style=\"color: #66cc66;\">&#40;<\/span><span style=\"color: #66cc66;\">&#41;<\/span>;\n            <span style=\"color: #66cc66;\">&#125;<\/span> <span style=\"color: #000000; font-weight: bold;\">catch<\/span> <span style=\"color: #66cc66;\">&#40;<\/span><a href=\"http:\/\/www.google.com\/search?hl=en&amp;q=allinurl%3AIOException+java.sun.com&amp;btnI=I%27m%20Feeling%20Lucky\"><span style=\"color: #aaaadd; font-weight: bold;\">IOException<\/span><\/a> e<span style=\"color: #66cc66;\">&#41;<\/span> <span style=\"color: #66cc66;\">&#123;<\/span>\n                Log.<span style=\"color: #006600;\">e<\/span><span style=\"color: #66cc66;\">&#40;<\/span>TAG, <span style=\"color: #ff0000;\">&quot;IOException while closing MifareUltralight...&quot;<\/span>, e<span style=\"color: #66cc66;\">&#41;<\/span>;\n            <span style=\"color: #66cc66;\">&#125;<\/span>\n        <span style=\"color: #66cc66;\">&#125;<\/span>\n    <span style=\"color: #66cc66;\">&#125;<\/span>\n&#160;\n    <span style=\"color: #000000; font-weight: bold;\">public<\/span> <a href=\"http:\/\/www.google.com\/search?hl=en&amp;q=allinurl%3AString+java.sun.com&amp;btnI=I%27m%20Feeling%20Lucky\"><span style=\"color: #aaaadd; font-weight: bold;\">String<\/span><\/a> readTag<span style=\"color: #66cc66;\">&#40;<\/span>Tag tag<span style=\"color: #66cc66;\">&#41;<\/span> <span style=\"color: #66cc66;\">&#123;<\/span>\n        MifareUltralight mifare = MifareUltralight.<span style=\"color: #006600;\">get<\/span><span style=\"color: #66cc66;\">&#40;<\/span>tag<span style=\"color: #66cc66;\">&#41;<\/span>;\n        <span style=\"color: #000000; font-weight: bold;\">try<\/span> <span style=\"color: #66cc66;\">&#123;<\/span>\n            mifare.<span style=\"color: #006600;\">connect<\/span><span style=\"color: #66cc66;\">&#40;<\/span><span style=\"color: #66cc66;\">&#41;<\/span>;\n            <span style=\"color: #993333;\">byte<\/span><span style=\"color: #66cc66;\">&#91;<\/span><span style=\"color: #66cc66;\">&#93;<\/span> payload = mifare.<span style=\"color: #006600;\">readPages<\/span><span style=\"color: #66cc66;\">&#40;<\/span><span style=\"color: #cc66cc;\">4<\/span><span style=\"color: #66cc66;\">&#41;<\/span>;\n            <span style=\"color: #000000; font-weight: bold;\">return<\/span> <span style=\"color: #000000; font-weight: bold;\">new<\/span> <a href=\"http:\/\/www.google.com\/search?hl=en&amp;q=allinurl%3AString+java.sun.com&amp;btnI=I%27m%20Feeling%20Lucky\"><span style=\"color: #aaaadd; font-weight: bold;\">String<\/span><\/a><span style=\"color: #66cc66;\">&#40;<\/span>payload, Charset.<span style=\"color: #006600;\">forName<\/span><span style=\"color: #66cc66;\">&#40;<\/span><span style=\"color: #ff0000;\">&quot;US-ASCII&quot;<\/span><span style=\"color: #66cc66;\">&#41;<\/span><span style=\"color: #66cc66;\">&#41;<\/span>;\n        <span style=\"color: #66cc66;\">&#125;<\/span> <span style=\"color: #000000; font-weight: bold;\">catch<\/span> <span style=\"color: #66cc66;\">&#40;<\/span><a href=\"http:\/\/www.google.com\/search?hl=en&amp;q=allinurl%3AIOException+java.sun.com&amp;btnI=I%27m%20Feeling%20Lucky\"><span style=\"color: #aaaadd; font-weight: bold;\">IOException<\/span><\/a> e<span style=\"color: #66cc66;\">&#41;<\/span> <span style=\"color: #66cc66;\">&#123;<\/span>\n            Log.<span style=\"color: #006600;\">e<\/span><span style=\"color: #66cc66;\">&#40;<\/span>TAG, <span style=\"color: #ff0000;\">&quot;IOException while writing MifareUltralight\n            message...&quot;<\/span>, e<span style=\"color: #66cc66;\">&#41;<\/span>;\n        <span style=\"color: #66cc66;\">&#125;<\/span> <span style=\"color: #000000; font-weight: bold;\">finally<\/span> <span style=\"color: #66cc66;\">&#123;<\/span>\n            <span style=\"color: #b1b100;\">if<\/span> <span style=\"color: #66cc66;\">&#40;<\/span>mifare&#160;!= <span style=\"color: #000000; font-weight: bold;\">null<\/span><span style=\"color: #66cc66;\">&#41;<\/span> <span style=\"color: #66cc66;\">&#123;<\/span>\n               <span style=\"color: #000000; font-weight: bold;\">try<\/span> <span style=\"color: #66cc66;\">&#123;<\/span>\n                   mifare.<span style=\"color: #006600;\">close<\/span><span style=\"color: #66cc66;\">&#40;<\/span><span style=\"color: #66cc66;\">&#41;<\/span>;\n               <span style=\"color: #66cc66;\">&#125;<\/span>\n               <span style=\"color: #000000; font-weight: bold;\">catch<\/span> <span style=\"color: #66cc66;\">&#40;<\/span><a href=\"http:\/\/www.google.com\/search?hl=en&amp;q=allinurl%3AIOException+java.sun.com&amp;btnI=I%27m%20Feeling%20Lucky\"><span style=\"color: #aaaadd; font-weight: bold;\">IOException<\/span><\/a> e<span style=\"color: #66cc66;\">&#41;<\/span> <span style=\"color: #66cc66;\">&#123;<\/span>\n                   Log.<span style=\"color: #006600;\">e<\/span><span style=\"color: #66cc66;\">&#40;<\/span>TAG, <span style=\"color: #ff0000;\">&quot;Error closing tag...&quot;<\/span>, e<span style=\"color: #66cc66;\">&#41;<\/span>;\n               <span style=\"color: #66cc66;\">&#125;<\/span>\n            <span style=\"color: #66cc66;\">&#125;<\/span>\n        <span style=\"color: #66cc66;\">&#125;<\/span>\n        <span style=\"color: #000000; font-weight: bold;\">return<\/span> <span style=\"color: #000000; font-weight: bold;\">null<\/span>;\n    <span style=\"color: #66cc66;\">&#125;<\/span>\n<span style=\"color: #66cc66;\">&#125;<\/span>\n&#160;<\/pre>\n<h2> <span class=\"mw-headline\" id=\".E4.BD.BF.E7.94.A8.E5.89.8D.E5.8F.B0.E5.88.86.E5.8F.91.E7.B3.BB.E7.BB.9F.28Foreground_Dispatch_System.29\"><b>\u4f7f\u7528\u524d\u53f0\u5206\u53d1\u7cfb\u7edf(Foreground Dispatch System)<\/b><\/span><\/h2>\n<p>\u524d\u53f0\u5206\u53d1\u7cfb\u7edf\u5141\u8bb8\u4e00\u4e2aactivity\u62e6\u622aintent\u5e76\u4e14\u4f18\u5148\u4e8e\u5176\u4ed6\u5904\u7406\u540c\u4e00\u4e2aintent\u7684activity\u3002\n\u4f7f\u7528\u8fd9\u4e2a\u7cfb\u7edf\u6d89\u53ca\u4e3aAndroid\u7cfb\u7edf\u6784\u5efa\u4e00\u4e9b\u6570\u636e\u7ed3\u6784\u4ee5\u8fbe\u5230\u80fd\u88ab\u7528\u6765\u53d1\u9001\u9002\u5408\u7684intent\u5230\u4f60\u7684\u5e94\u7528\u7a0b\u5e8f\u3002\u542f\u52a8\u524d\u53f0\u5206\u53d1\u7cfb\u7edf\uff1a\n1.\u52a0\u5165\u4ee5\u4e0b\u4ee3\u7801\u5230\u4f60activity\u7684onCreate()\u65b9\u6cd5\u4e2d\uff1a\n<\/p>\n<dl><dd>1.\u521b\u5efa\u4e00\u4e2aPendingIntent\u5bf9\u8c61\uff0c\u5982\u6b64Android\u7cfb\u7edf\u626b\u63cf\u5230\u6807\u7b7e\u65f6\uff0c\u5219\u4f1a\u586b\u5145\u627e\u4e2a\u5bf9\u8c61\u3002\n<\/dd><\/dl>\n<pre class=\"java\">&#160;\nPendingIntent pendingIntent = PendingIntent.<span style=\"color: #006600;\">getActivity<\/span><span style=\"color: #66cc66;\">&#40;<\/span>\n    <span style=\"color: #000000; font-weight: bold;\">this<\/span>, <span style=\"color: #cc66cc;\">0<\/span>, <span style=\"color: #000000; font-weight: bold;\">new<\/span> Intent<span style=\"color: #66cc66;\">&#40;<\/span><span style=\"color: #000000; font-weight: bold;\">this<\/span>, getClass<span style=\"color: #66cc66;\">&#40;<\/span><span style=\"color: #66cc66;\">&#41;<\/span><span style=\"color: #66cc66;\">&#41;<\/span>.<span style=\"color: #006600;\">addFlags<\/span><span style=\"color: #66cc66;\">&#40;<\/span>Intent.<span style=\"color: #006600;\">FLAG_ACTIVITY_SINGLE_TOP<\/span><span style=\"color: #66cc66;\">&#41;<\/span>, <span style=\"color: #cc66cc;\">0<\/span><span style=\"color: #66cc66;\">&#41;<\/span>;\n&#160;<\/pre>\n<dl><dd>2.\u58f0\u660eintent filter(\u610f\u56fe\u8fc7\u6ee4\u5668)\u6765\u5904\u7406\u4f60\u60f3\u62e6\u622a\u7684intent\u3002\u524d\u53f0\u8c03\u5ea6\u7cfb\u7edf\u4f1a\u68c0\u67e5\u6307\u5b9a\u7684intent filter\u548c\u5f53\u8bbe\u5907\u626b\u63cf\u5230\u6807\u7b7e\u63a5\u6536\u5230\u7684intent\uff0c\u5982\u679c\u5339\u914d\uff0c\u4f60\u7684\u5e94\u7528\u7a0b\u5e8f\u5219\u5904\u7406\u8fd9\u4e2aintent(\u610f\u56fe)\uff0c\u5982\u679c\u4e0d\u5339\u914d\uff0c\u524d\u53f0\u5206\u53d1\u7cfb\u7edf\u56de\u9000\u5230\u610f\u56fe\u5206\u53d1\u7cfb\u7edf(intent dispatch system).\u6307\u5b9a\u4e00\u4e2aintent filter(\u610f\u56fe\u8fc7\u6ee4)\u548ctechnology filter(\u6280\u672f\u8fc7\u6ee4)\u7684\u7a7a\u6570\u7ec4,\u6307\u5b9a\u4e00\u4e2a\u610f\u56fe\u8fc7\u6ee4\u5668\u548c\u6280\u672f\u7684\u8fc7\u6ee4\u5668\u7684null\u6570\u7ec4\uff0c\u5e76\u6307\u5b9a\u8981\u8fc7\u6ee4\u7684\u56de\u9000\u5230\u7684TAG_DISCOVERED\u610f\u56fe\u7684\u6240\u6709\u6807\u7b7e\u3002 \n<\/dd><\/dl>\n<p>\u4ee5\u4e0b\u4ee3\u7801\u7247\u6bb5\u5904\u7406\u4e86\u4e3aNDEF_DISCOVERED\u7684\u6240\u6709MIME\u7c7b\u578b\uff0c\u4f60\u5e94\u8be5\u53ea\u5904\u7406\u4f60\u9700\u8981\u5f97\u4e00\u4e2a\uff1a\n<\/p>\n<pre class=\"java\">&#160;\nIntentFilter ndef = <span style=\"color: #000000; font-weight: bold;\">new<\/span> IntentFilter<span style=\"color: #66cc66;\">&#40;<\/span>NfcAdapter.<span style=\"color: #006600;\">ACTION_NDEF_DISCOVERED<\/span><span style=\"color: #66cc66;\">&#41;<\/span>;\n    <span style=\"color: #000000; font-weight: bold;\">try<\/span> <span style=\"color: #66cc66;\">&#123;<\/span>\n        ndef.<span style=\"color: #006600;\">addDataType<\/span><span style=\"color: #66cc66;\">&#40;<\/span><span style=\"color: #ff0000;\">&quot;*\/*&quot;<\/span><span style=\"color: #66cc66;\">&#41;<\/span>;    <span style=\"color: #808080; font-style: italic;\">\/* Handles all MIME based dispatches.\n                                       You should specify only the ones that you need. *\/<\/span>\n    <span style=\"color: #66cc66;\">&#125;<\/span>\n    <span style=\"color: #000000; font-weight: bold;\">catch<\/span> <span style=\"color: #66cc66;\">&#40;<\/span>MalformedMimeTypeException e<span style=\"color: #66cc66;\">&#41;<\/span> <span style=\"color: #66cc66;\">&#123;<\/span>\n        <span style=\"color: #000000; font-weight: bold;\">throw<\/span> <span style=\"color: #000000; font-weight: bold;\">new<\/span> <a href=\"http:\/\/www.google.com\/search?hl=en&amp;q=allinurl%3ARuntimeException+java.sun.com&amp;btnI=I%27m%20Feeling%20Lucky\"><span style=\"color: #aaaadd; font-weight: bold;\">RuntimeException<\/span><\/a><span style=\"color: #66cc66;\">&#40;<\/span><span style=\"color: #ff0000;\">&quot;fail&quot;<\/span>, e<span style=\"color: #66cc66;\">&#41;<\/span>;\n    <span style=\"color: #66cc66;\">&#125;<\/span>\n   intentFiltersArray = <span style=\"color: #000000; font-weight: bold;\">new<\/span> IntentFilter<span style=\"color: #66cc66;\">&#91;<\/span><span style=\"color: #66cc66;\">&#93;<\/span> <span style=\"color: #66cc66;\">&#123;<\/span>ndef, <span style=\"color: #66cc66;\">&#125;<\/span>;\n&#160;<\/pre>\n<dl><dd>3.\u521b\u5efa\u4e00\u4e2a\u4f60\u7a0b\u5e8f\u60f3\u5904\u7406\u7684\u6807\u7b7e\u6280\u672f\u6570\u7ec4\uff0c\u8c03\u7528Object.class.getName()\u65b9\u6cd5\u53bb\u83b7\u53d6\u4f60\u60f3\u652f\u6301\u7684\u6280\u672f\u7c7b\u3002\n<\/dd><\/dl>\n<p>2.\u91cd\u5199\u4ee5\u4e0bactivity\u7684\u58f0\u660e\u5468\u671f\u56de\u8c03\u51fd\u6570\u4ee5\u53ca\u6dfb\u52a0\u542f\u7528\u548c\u7981\u7528\u524d\u53f0\u5206\u53d1\u7cfb\u7edf\u7684\u903b\u8f91\uff0c\u5f53activity\u5931\u53bb(onPause())\u6216\u8005\u91cd\u83b7(onResume())\u7126\u70b9\u3002\nenableForegroundDispatch()\u65b9\u6cd5\u5fc5\u987b\u5728\u4e3b\u7ebf\u7a0b\u5e76\u4e14\u5f53activity\u5904\u4e8e\u524d\u7f6e\u4f4d\u7f6e\u65f6\u88ab\u8c03\u7528(\u8c03\u7528onResume()\u6765\u4fdd\u8bc1)\u3002\n\u540c\u65f6\u4f60\u4e5f\u9700\u8981\u5b9e\u73b0onNewIntent\u56de\u8c03\u5904\u7406\u6765\u81ea\u626b\u63cf\u5230\u7684\u6807\u7b7e\u6570\u636e\u3002\n<\/p>\n<pre class=\"java\">&#160;\n<span style=\"color: #000000; font-weight: bold;\">public<\/span> <span style=\"color: #993333;\">void<\/span> onPause<span style=\"color: #66cc66;\">&#40;<\/span><span style=\"color: #66cc66;\">&#41;<\/span> <span style=\"color: #66cc66;\">&#123;<\/span>\n    <span style=\"color: #000000; font-weight: bold;\">super<\/span>.<span style=\"color: #006600;\">onPause<\/span><span style=\"color: #66cc66;\">&#40;<\/span><span style=\"color: #66cc66;\">&#41;<\/span>;\n    mAdapter.<span style=\"color: #006600;\">disableForegroundDispatch<\/span><span style=\"color: #66cc66;\">&#40;<\/span><span style=\"color: #000000; font-weight: bold;\">this<\/span><span style=\"color: #66cc66;\">&#41;<\/span>;\n<span style=\"color: #66cc66;\">&#125;<\/span>\n&#160;\n<span style=\"color: #000000; font-weight: bold;\">public<\/span> <span style=\"color: #993333;\">void<\/span> onResume<span style=\"color: #66cc66;\">&#40;<\/span><span style=\"color: #66cc66;\">&#41;<\/span> <span style=\"color: #66cc66;\">&#123;<\/span>\n    <span style=\"color: #000000; font-weight: bold;\">super<\/span>.<span style=\"color: #006600;\">onResume<\/span><span style=\"color: #66cc66;\">&#40;<\/span><span style=\"color: #66cc66;\">&#41;<\/span>;\n    mAdapter.<span style=\"color: #006600;\">enableForegroundDispatch<\/span><span style=\"color: #66cc66;\">&#40;<\/span><span style=\"color: #000000; font-weight: bold;\">this<\/span>, pendingIntent, intentFiltersArray, techListsArray<span style=\"color: #66cc66;\">&#41;<\/span>;\n<span style=\"color: #66cc66;\">&#125;<\/span>\n&#160;\n<span style=\"color: #000000; font-weight: bold;\">public<\/span> <span style=\"color: #993333;\">void<\/span> onNewIntent<span style=\"color: #66cc66;\">&#40;<\/span>Intent intent<span style=\"color: #66cc66;\">&#41;<\/span> <span style=\"color: #66cc66;\">&#123;<\/span>\n    Tag tagFromIntent = intent.<span style=\"color: #006600;\">getParcelableExtra<\/span><span style=\"color: #66cc66;\">&#40;<\/span>NfcAdapter.<span style=\"color: #006600;\">EXTRA_TAG<\/span><span style=\"color: #66cc66;\">&#41;<\/span>;\n    <span style=\"color: #808080; font-style: italic;\">\/\/do something with tagFromIntent<\/span>\n<span style=\"color: #66cc66;\">&#125;<\/span>\n&#160;<\/pre>\n<p>\u8be6\u89c1API\u4f8b\u5b50(Demos)\u4e2d\u7684\u5b8c\u6574\u4f8b\u5b50<a rel=\"nofollow\" target=\"_blank\" class=\"external text\" href=\"http:\/\/docs.eoeandroid.com\/tools\/samples\/index.html\">\u524d\u53f0\u5206\u53d1(ForegroundDispatch)<\/a>\n<\/p>"}