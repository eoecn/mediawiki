{"title":"Renderscript","text":"<ul><li>\u524d\u4e24\u7aef\u539f\u6587\u5730\u5740\uff1a<a rel=\"nofollow\" target=\"_blank\" class=\"external free\" href=\"http:\/\/docs.eoeandroid.com\/guide\/topics\/renderscript\/compute.html\">http:\/\/docs.eoeandroid.com\/guide\/topics\/renderscript\/compute.html<\/a>\n<\/li><li>\u4e4b\u540e\u7684\u539f\u6587\u5730\u5740\uff1a<a rel=\"nofollow\" target=\"_blank\" class=\"external free\" href=\"http:\/\/docs.eoeandroid.com\/intl\/zh-CN\/guide\/topics\/renderscript\/advanced.html#native\">http:\/\/docs.eoeandroid.com\/intl\/zh-CN\/guide\/topics\/renderscript\/advanced.html#native<\/a>\n<\/li><li>\u7ffb\u8bd1\uff1aandy_xiexh\n<\/li><li>\u66f4\u65b0\u65f6\u95f4\uff1a2012.06.18\n<\/li><\/ul>\n<table id=\"toc\" class=\"toc\"><tr><td><div id=\"toctitle\"><h2>\u76ee\u5f55<\/h2><\/div>\n<ul>\n<li class=\"toclevel-1 tocsection-1\"><a href=\"#Renderscript\"><span class=\"tocnumber\">1<\/span> <span class=\"toctext\">Renderscript<\/span><\/a>\n<ul>\n<li class=\"toclevel-2 tocsection-2\"><a href=\"#Renderscript.E7.BB.BC.E8.BF.B0\"><span class=\"tocnumber\">1.1<\/span> <span class=\"toctext\">Renderscript\u7efc\u8ff0<\/span><\/a><\/li>\n<li class=\"toclevel-2 tocsection-3\"><a href=\"#Renderscript_Runtime.E5.B1.82\"><span class=\"tocnumber\">1.2<\/span> <span class=\"toctext\">Renderscript Runtime\u5c42<\/span><\/a><\/li>\n<li class=\"toclevel-2 tocsection-4\"><a href=\"#Renderscript_Reflected.E5.B1.82\"><span class=\"tocnumber\">1.3<\/span> <span class=\"toctext\">Renderscript Reflected\u5c42<\/span><\/a>\n<ul>\n<li class=\"toclevel-3 tocsection-5\"><a href=\"#.E5.87.BD.E6.95.B0\"><span class=\"tocnumber\">1.3.1<\/span> <span class=\"toctext\">\u51fd\u6570<\/span><\/a><\/li>\n<li class=\"toclevel-3 tocsection-6\"><a href=\"#.E5.8F.98.E9.87.8F\"><span class=\"tocnumber\">1.3.2<\/span> <span class=\"toctext\">\u53d8\u91cf<\/span><\/a><\/li>\n<li class=\"toclevel-3 tocsection-7\"><a href=\"#.E7.BB.93.E6.9E.84\"><span class=\"tocnumber\">1.3.3<\/span> <span class=\"toctext\">\u7ed3\u6784<\/span><\/a><\/li>\n<li class=\"toclevel-3 tocsection-8\"><a href=\"#.E6.8C.87.E9.92.88\"><span class=\"tocnumber\">1.3.4<\/span> <span class=\"toctext\">\u6307\u9488<\/span><\/a><\/li>\n<\/ul>\n<\/li>\n<li class=\"toclevel-2 tocsection-9\"><a href=\"#Memory_Allocation_APIs\"><span class=\"tocnumber\">1.4<\/span> <span class=\"toctext\">Memory Allocation APIs<\/span><\/a><\/li>\n<li class=\"toclevel-2 tocsection-10\"><a href=\"#.E5.A4.84.E7.90.86.E5.86.85.E5.AD.98\"><span class=\"tocnumber\">1.5<\/span> <span class=\"toctext\">\u5904\u7406\u5185\u5b58<\/span><\/a>\n<ul>\n<li class=\"toclevel-3 tocsection-11\"><a href=\"#.E5.8A.A8.E6.80.81.E5.88.86.E9.85.8D.E5.86.85.E5.AD.98.E5.92.8C.E7.BB.91.E5.AE.9A.E5.88.B0Renderscript\"><span class=\"tocnumber\">1.5.1<\/span> <span class=\"toctext\">\u52a8\u6001\u5206\u914d\u5185\u5b58\u548c\u7ed1\u5b9a\u5230Renderscript<\/span><\/a><\/li>\n<li class=\"toclevel-3 tocsection-12\"><a href=\"#.E5.86.85.E5.AD.98.E7.9A.84.E8.AF.BB.E5.86.99\"><span class=\"tocnumber\">1.5.2<\/span> <span class=\"toctext\">\u5185\u5b58\u7684\u8bfb\u5199<\/span><\/a><\/li>\n<li class=\"toclevel-3 tocsection-13\"><a href=\"#.E5.85.A8.E5.B1.80.E5.8F.98.E9.87.8F.E7.9A.84.E8.AF.BB.E5.86.99\"><span class=\"tocnumber\">1.5.3<\/span> <span class=\"toctext\">\u5168\u5c40\u53d8\u91cf\u7684\u8bfb\u5199<\/span><\/a><\/li>\n<li class=\"toclevel-3 tocsection-14\"><a href=\"#.E5.85.A8.E5.B1.80.E6.8C.87.E9.92.88.E7.9A.84.E8.AF.BB.E5.86.99\"><span class=\"tocnumber\">1.5.4<\/span> <span class=\"toctext\">\u5168\u5c40\u6307\u9488\u7684\u8bfb\u5199<\/span><\/a><\/li>\n<\/ul>\n<\/li>\n<\/ul>\n<\/li>\n<\/ul>\n<\/td><\/tr><\/table>\n<h1> <span class=\"mw-headline\" id=\"Renderscript\">Renderscript<\/span><\/h1>\n<p>Renderscript\u662f\u4e00\u4e2a\u63d0\u4f9b\u9ad8\u6027\u80fd\u76843D\u56fe\u5f62\u6e32\u67d3\u548c\u8ba1\u7b97\u64cd\u4f5c\u7684API\uff08C99\u6807\u51c6\uff09\u3002Renderscript\u7684\u4e3b\u8981\u4f18\u70b9\u5982\u4e0b\uff1a\n<\/p>\n<ul><li>\u53ef\u79fb\u690d\u6027\uff1aRenderscript\u8bbe\u8ba1\u8fd0\u884c\u4e8e\u591a\u79cd\u4e0d\u540c\u5904\u7406\u5668\uff08CPU, GPU, DSP\u7b49\uff09\u67b6\u6784\u7684\u8bbe\u5907\u3002\u5b83\u652f\u6301\u6240\u6709\u8fd9\u4e9b\u67b6\u6784\u800c\u4e0d\u5fc5\u9488\u5bf9\u6bcf\u4e00\u4e2a\u8bbe\u5907\uff0c\u8fd9\u662f\u56e0\u4e3a\u5b83\u7684\u4ee3\u7801\u662f\u5728\u8bbe\u5907\u8fd0\u884c\u65f6\u88ab\u7f16\u8bd1\u548c\u7f13\u5b58\u3002\n<\/li><li>\u9ad8\u6027\u80fd\uff1aRenderscript\u4e0d\u4ec5\u63d0\u4f9b\u4e0eopengl\u76f8\u4f3c\u7684\u6027\u80fd\u8fd8\u63d0\u4f9bopengl\u6ca1\u6709\u7684\u9ad8\u6027\u80fd\u8ba1\u7b97\u64cd\u4f5cAPI\u3002\n<\/li><li>\u6613\u7528\uff1aRenderscript\u5c3d\u53ef\u80fd\u7b80\u5316\u4e86\u5f00\u53d1\u3002\n<\/li><\/ul>\n<p>\u4e3b\u8981\u7f3a\u70b9\u5982\u4e0b\uff1a\n<\/p>\n<ul><li>\u5f00\u53d1\u590d\u6742\u5ea6\uff1a\u9700\u8981\u5b66\u4e60Renderscript \u5f15\u8fdb\u7684\u4e00\u5957\u65b0API\u3002Renderscript\u5206\u914d\u5185\u5b58\u4e0eopengl\u4e0d\u4e00\u6837\u3002\u5c3d\u7ba1\u5982\u6b64\uff0c\u8fd9\u4e9b\u95ee\u9898\u5e76\u4e0d\u96be\u7406\u89e3\uff0cRenderscript \u7684\u8bb8\u591a\u7279\u6027\u4f7f\u5f97\u5b83\u6bd4opengl\u66f4\u7b80\u5355\u3002\n<\/li><li>\u8c03\u8bd5\u53ef\u89c1\u6027\uff1a\u5982\u679c\u51fa\u73b0Renderscript \u8fd0\u884c\u5728\u591a\u4e2a\u5904\u7406\u5668\u800c\u4e0d\u662f\u4e3bCPU\uff08\u5982GPU\uff09\uff0c\u8c03\u8bd5\u5c06\u5f88\u56f0\u96be\u3002\n<\/li><\/ul>\n<p>Renderscript \u7684\u5b9e\u4f8b\u5b58\u5728\u4e8eSDK\u7684 &lt;sdk_root&gt;\/samples\/android-11\/RenderScript\u76ee\u5f55\uff0c\u540c\u65f6\u4f60\u4e5f\u53ef\u4ee5\u5728Android3.x\u7248\u672c\u7684Google Books\u548cYoutube\u4e2d\u770b\u5230\u4f7f\u7528Renderscript \u5b9e\u73b0\u7684\u5178\u578b3D\u65cb\u8f6c\u89c6\u56fe\u3002\n<\/p>\n<h2> <span class=\"mw-headline\" id=\"Renderscript.E7.BB.BC.E8.BF.B0\">Renderscript\u7efc\u8ff0<\/span><\/h2>\n<p>Renderscript \u5728\u7cfb\u7edf\u5e95\u5c42\u8fd0\u884c\u4e14\u9700\u8981\u4e0eAndroid VM\u8fdb\u884c\u901a\u4fe1\uff0c\u6240\u4ee5\u5b83\u7684\u8bbe\u7f6e\u4e0e\u7eafVM\u5e94\u7528\u6709\u6240\u4e0d\u540c\u3002\u4f7f\u7528Renderscript\u7684\u5e94\u7528\u548c\u4f20\u7edf\u5e94\u7528\u4e00\u6837\u8fd0\u884c\u5728VM\u4e2d\uff0c\u4f46\u662f\u4f60\u5199\u7684Renderscript \u4ee3\u7801\u53ef\u4ee5\u53d1\u547d\u4ee4\u7ed9VM\u3002Renderscript \u53ef\u4ee5\u505a\u4e00\u4e9b\u7b80\u5355\u7684\u8ba1\u7b97,\u4e5f\u53ef\u4ee5\u590d\u6742\u7684\u6e32\u67d3\u6574\u4e2a3D\u6e38\u620f\u3002\u65e0\u8bba\u4f60\u600e\u4e48\u4f7f\u7528\u5b83\uff0c\u5b83\u59cb\u7ec8\u662f\u5e73\u53f0\u72ec\u7acb\u7684\uff0c\u6240\u4ee5\u4f60\u4e0d\u9700\u8981\u53bb\u9488\u5bf9\u5404\u4e2a\u5e73\u53f0\uff08\u5982 ARM v5, ARM v7, x86\u7b49\uff09\u3002\n<\/p><p>Renderscript \u7cfb\u7edf\u91c7\u7528\u7684\u63a7\u5236\u548c\u5b9e\u505a\u67b6\u6784\u4e3a\u5e95\u5c42Renderscript Runtime\u88ab\u4e0a\u5c42Android\u7cfb\u7edf\u63a7\u5236\u3002Android VM\u4fdd\u7559\u6240\u6709\u5bf9\u5185\u5b58\u7684\u63a7\u5236\u5e76\u5c06\u4ed6\u5206\u914d\u7ed9Renderscript Runtime\u4f7f\u7528\u3002Android\u6846\u67b6\u53ef\u4ee5\u5f02\u6b65\u8c03\u7528Renderscript \uff0c\u5e76\u5c06\u5b83\u653e\u5165\u4e00\u4e2a\u6d88\u606f\u961f\u5217\u5e76\u5c3d\u5feb\u5904\u7406\u3002\u56fe1\u663e\u793aRenderscript \u7684\u7ed3\u6784\u3002\n<\/p><p>Renderscrip\u6709\u4e09\u5c42API\u7528\u4e8eRenderscript runtime\u4e0eAndroid\u6846\u67b6\u8fdb\u884c\u6c9f\u901a\uff0c\u5982\u4e0b\uff1a\n\u2022Renderscript runtime API\uff1a\u5b83\u63d0\u4f9b\u5e94\u7528\u7a0b\u5e8f\u6240\u9700\u7684\u8ba1\u7b97\u548c\u56fe\u5f62\u6e32\u67d3\u3002\n\u2022Reflected layer\uff08\u53cd\u5c04\u5c42\uff09API\uff1a\u5b83\u662f\u4e00\u7ec4\u7c7b\uff0c\u5b83\u4ece\u4f60\u7684Renderscript\u8fd0\u884c\u65f6\u4ee3\u7801\u4e2d\u88ab\u53cd\u5c04\u3002\u5b83\u5c01\u88c5\u4e86Android\u6846\u67b6\u4e0eRenderscript\u8fd0\u884c\u65f6\u4ea4\u4e92\u7684\u57fa\u672cRenderscript\u4ee3\u7801\u3002Android build\u5de5\u5177\u5728build\u8fc7\u7a0b\u4e2d\u81ea\u52a8\u751f\u6210\u8fd9\u5c42\u7c7b\uff0c\u6e05\u9664\u8fd9\u4e9b\u7c7b\u9700\u8981\u50cfNDK\u4e00\u6837\u7f16\u5199JNI glue\u4ee3\u7801\u3002\n\u2022Android framework API\uff1a\u5b83\u63d0\u4f9b\u4e86android.renderscript\u5305\u4f7f\u4f60\u53ef\u4ee5\u5728\u4f60\u7684\u5e94\u7528\u4e2d\u4f7f\u7528\u5982activities\u548cviews\u4e4b\u7c7b\u7684\u4f20\u7edfAndroid\u7ec4\u4ef6\u3002\u5f53\u4f7f\u7528Renderscript\u7684\u65f6\u5019\uff0c\u8fd9\u4e2a\u5c42\u4f1a\u8c03\u7528\u53cd\u5c04\u5c42\u4ee5\u8bbf\u95eeRenderscript\u8fd0\u884c\u65f6\u3002\n<\/p>\n<h2> <span class=\"mw-headline\" id=\"Renderscript_Runtime.E5.B1.82\">Renderscript Runtime\u5c42<\/span><\/h2>\n<p>Renderscript\u4ee3\u7801\u5728\u4e00\u4e2a\u7d27\u51d1\u800c\u660e\u786e\u7684\u8fd0\u884c\u65f6\u5c42\u4e2d\u88ab\u7f16\u8bd1\u548c\u6267\u884c\u3002Renderscript\u8fd0\u884c\u65f6API\u63d0\u4f9b\u96c6\u4e2d\u8ba1\u7b97\u548c\u56fe\u5f62\u6e32\u67d3\u652f\u6301\uff0c\u5b83\u65f6\u53ef\u79fb\u690d\u7684\uff0c\u5728\u591a\u6838\u5fc3\u5904\u7406\u5668\u4e0a\u8fd0\u884c\u4f1a\u81ea\u52a8\u6269\u5c55\u3002\n<\/p>\n<div style=\"margin: 1em 0; padding: 10px; overflow: auto; background: #F7F7F7; border-left:4px solid; border-color:#258AAF;\">\n<p>\u6ce8\u610f\uff1a\u56e0\u4e3aRenderscript \u8bbe\u8ba1\u8fd0\u884c\u4e8e\u591a\u79cd\u5904\u7406\u5668\u67b6\u6784\u800c\u6807\u51c6C\u51fd\u6570\u53ea\u80fd\u4f7f\u7528\u4e8eCPU\u67b6\u6784\uff0c\u6240\u4ee5Renderscript \u4e0d\u80fd\u4f7f\u7528\u6807\u51c6C\u51fd\u6570\u3002\n<\/p>\n<\/div>\n<p>Renderscript \u4ee3\u7801\u4ee5.rs \u6216.rsh\u6587\u4ef6\u4fdd\u5b58\u5728Android\u5de5\u7a0b\u4e2d\u7684src\u76ee\u5f55\u4e0b\u3002\u8fd9\u4e9b\u4ee3\u7801\u5728Android build\u7684\u65f6\u5019\u88abllvm\u7f16\u8bd1\u5668\u7f16\u8bd1\u6210\u4e2d\u95f4\u5b57\u8282\u7801\u3002\u5f53\u7a0b\u5e8f\u5728\u8bbe\u5907\u4e0a\u8fd0\u884c\u65f6\uff0c\u4e2d\u95f4\u5b57\u8282\u7801\u4f1a\u88ab\u8bbe\u5907\u4e0a\u7684llvm\u7f16\u8bd1\u5668\uff08\u4e0e\u524d\u4e00\u4e2a\u4e0d\u7528\uff09\u7f16\u8bd1\u6210\u673a\u5668\u7801\u3002\u673a\u5668\u7801\u6839\u636e\u8bbe\u5907\u88ab\u4f18\u5316\u548c\u7f13\u5b58\uff0c\u8fd9\u4f7f\u5f97\u540e\u9762\u7a0b\u5e8f\u4f7f\u7528Renderscript\u65f6\u4e0d\u9700\u8981\u91cd\u65b0\u7f16\u8bd1\u5b57\u8282\u7801\u3002\n<\/p><p>Renderscript\u8fd0\u884c\u65f6\u5e93\u7684\u4e00\u4e9b\u5173\u952e\u7279\u6027\u5305\u62ec\uff1a\n<\/p>\n<ul><li>\u56fe\u5f62\u6e32\u67d3\u51fd\u6570\n<\/li><li>\u5185\u5b58\u5206\u914d\u8bf7\u6c42\u7279\u6027\n<\/li><li>\u5927\u91cf\u7684\u6570\u5b66\u51fd\u6570\uff0c\u5305\u542b\u6807\u91cf\u548c\u77e2\u91cf\u7c7b\u578b\u91cd\u8f7d\u7248\u672c\u7684\u8bb8\u591a\u5e38\u89c1\u4f8b\u7a0b\u3002\u4e00\u4e9b\u53ef\u7528\u64cd\u4f5c\u8bf8\u5982\u52a0\u3001\u4e58\u3001\u70b9\u4e58\u548c\u53c9\u4e58\uff0c\u4ee5\u53ca\u539f\u5b50\u7b97\u672f\u548c\u6bd4\u8f83\u51fd\u6570\u7b49\u7b49\u3002\n<\/li><li>\u539f\u59cb\u6570\u636e\u7c7b\u578b\u548c\u5411\u91cf\u4e4b\u95f4\u7684\u8f6c\u6362\u4f8b\u7a0b\uff0c\u77e9\u9635\u4f8b\u7a0b\uff0c\u65e5\u671f\u548c\u65f6\u95f4\u4f8b\u7a0b\uff0c\u4ee5\u53ca\u56fe\u5f62\u4f8b\u7a0b\u3002\n<\/li><li>Renderscript\u652f\u6301\u7684\u6570\u636e\u7c7b\u578b\u548c\u7ed3\u6784\uff0c\u4f8b\u5982\u5b9a\u4e49\u4e8c\u7ef4\uff0c\u4e09\u7ef4\u6216\u56db\u7ef4\u5411\u91cf\u7684Vector\u7c7b\u578b\u3002\n<\/li><li>\u65e5\u5fd7\u51fd\u6570\n<\/li><\/ul>\n<p>\u53c2\u8003Renderscript\u8fd0\u884c\u65f6API\u53c2\u8003\u624b\u518c\u4ee5\u83b7\u5f97\u5173\u4e8e\u53ef\u7528\u51fd\u6570\u7684\u66f4\u591a\u4fe1\u606f\u3002Renderscript\u7684\u5934\u6587\u4ef6\u9664\u4e86\u56fe\u5f62\u5934\u6587\u4ef6\u4e4b\u5916\u90fd\u4f1a\u81ea\u52a8\u5305\u542b\uff0c\u4f60\u53ef\u4ee5\u81ea\u5df1\u5305\u542b\u56fe\u5f62\u5934\u6587\u4ef6\uff0c\u5982\u4e0b\u6240\u793a\uff1a\n<\/p>\n<pre class=\"java\">include <span style=\"color: #ff0000;\">&quot;rs_graphics.rsh&quot;<\/span><\/pre>\n<h2> <span class=\"mw-headline\" id=\"Renderscript_Reflected.E5.B1.82\">Renderscript Reflected\u5c42<\/span><\/h2>\n<p>\u53cd\u5c04\u5c42\u662f\u4e00\u7ec4\u7531Android build\u5de5\u5177\u751f\u6210\u7684\u7c7b\uff0c\u5b83\u5141\u8bb8Android\u6846\u67b6\u8bbf\u95eeRenderscript \u8fd0\u884c\u65f6\u3002\u5b83\u8fd8\u63d0\u4f9b\u65b9\u6cd5\u548c\u6784\u9020\u51fd\u6570\u8ba9\u4f60\u53ef\u4ee5\u5206\u914d\u548c\u5904\u7406\u5b9a\u4e49\u5728Renderscript\u4ee3\u7801\u4e2d\u7684\u6307\u9488\u3002\u4ee5\u4e0b\u5217\u8868\u63cf\u8ff0\u88ab\u53cd\u5c04\u7684\u4e3b\u8981\u7ec4\u4ef6\uff1a\n<\/p>\n<ul><li>\u6240\u6709\u521b\u5efa\u7684 .rs\u6587\u4ef6\u90fd\u4f1a\u751f\u6210\u4e00\u4e2a ScriptC\u7c7b\u578b\u7684\u7c7b\uff0c\u8fd9\u4e2a\u7c7b\u5b58\u653eproject_root\/gen\/package\/name\/ScriptC_renderscript_filename\u3002\u8fd9\u4e2a\u6587\u4ef6\u662f .rs\u6587\u4ef6\u7684 .java\u7248\uff0c\u53ef\u4ee5\u4eceAndroid\u6846\u67b6\u4e2d\u8c03\u7528\u5b83\uff0c\u8fd9\u4e2a\u7c7b\u5305\u542b\u4ece.rs\u6587\u4ef6\u4e2d\u53cd\u5c04\u7684\u4ee5\u4e0b\u6761\u76ee\uff1a\n<\/li><li>\u975e\u9759\u6001\u51fd\u6570\n<\/li><li>\u975e\u9759\u6001\uff0c\u5168\u5c40Renderscript\u53d8\u91cf\uff0c\u5b58\u50a8\u5668\u65b9\u6cd5\u4ea7\u751f\u5404\u4e2a\u53d8\u91cf\uff0c\u6240\u4ee5\u4f60\u53ef\u4ee5\u901a\u8fc7Android\u6846\u67b6\u8bfb\u5199Renderscript \u53d8\u91cf\u3002\u5982\u679c\u4e00\u4e2a\u5168\u5c40\u53d8\u91cf\u5df2\u7ecf\u5728 Renderscript runtime\u5c42\u521d\u59cb\u5316\uff0c\u90a3\u4e48\u5b83\u4e5f\u4f1a\u5728 Android framework\u5c42\u521d\u59cb\u5316\u76f8\u5e94\u7684\u503c\u3002\u4f46\u662f\u5982\u679c\u5168\u5c40\u53d8\u91cf\u88ab\u6807\u8bb0\u4e3aconst\uff0c\u90a3\u4e48\u5b83\u4e0d\u9700\u8981\u91cd\u65b0\u751f\u6210\u3002\n<\/li><li>\u5168\u5c40\u6307\u9488\n<\/li><\/ul>\n<h3> <span class=\"mw-headline\" id=\".E5.87.BD.E6.95.B0\">\u51fd\u6570<\/span><\/h3>\n<p>\u51fd\u6570\u88ab\u53cd\u5c04\u6210\u811a\u672c\u7c7b\uff0c\u4f4d\u4e8eproject_root\/gen\/package\/name\/ScriptC_renderscript_filename\u3002 \u4f8b\u5982\u4f60\u5728\u4f60\u7684Renderscript \u4ee3\u7801\u4e2d\u5b9a\u4e49\u5982\u4e0b\u51fd\u6570\uff1a\n<\/p>\n<pre class=\"java\">&#160;\n<span style=\"color: #993333;\">void<\/span> touch<span style=\"color: #66cc66;\">&#40;<\/span><span style=\"color: #993333;\">float<\/span> x, <span style=\"color: #993333;\">float<\/span> y, <span style=\"color: #993333;\">float<\/span> pressure, <span style=\"color: #993333;\">int<\/span> id<span style=\"color: #66cc66;\">&#41;<\/span> <span style=\"color: #66cc66;\">&#123;<\/span>\n    <span style=\"color: #b1b100;\">if<\/span> <span style=\"color: #66cc66;\">&#40;<\/span>id &gt;= <span style=\"color: #cc66cc;\">10<\/span><span style=\"color: #66cc66;\">&#41;<\/span> <span style=\"color: #66cc66;\">&#123;<\/span>\n        <span style=\"color: #000000; font-weight: bold;\">return<\/span>;\n    <span style=\"color: #66cc66;\">&#125;<\/span>\n&#160;\n    touchPos<span style=\"color: #66cc66;\">&#91;<\/span>id<span style=\"color: #66cc66;\">&#93;<\/span>.<span style=\"color: #006600;\">x<\/span> = x;\n    touchPos<span style=\"color: #66cc66;\">&#91;<\/span>id<span style=\"color: #66cc66;\">&#93;<\/span>.<span style=\"color: #006600;\">y<\/span> = y;\n    touchPressure<span style=\"color: #66cc66;\">&#91;<\/span>id<span style=\"color: #66cc66;\">&#93;<\/span> = pressure;\n<span style=\"color: #66cc66;\">&#125;<\/span>\n&#160;<\/pre>\n<p>\u751f\u6210\u4ee3\u7801\u5982\u4e0b\uff1a\n<\/p>\n<pre class=\"java\">&#160;\n<span style=\"color: #000000; font-weight: bold;\">public<\/span> <span style=\"color: #993333;\">void<\/span> invoke_touch<span style=\"color: #66cc66;\">&#40;<\/span><span style=\"color: #993333;\">float<\/span> x, <span style=\"color: #993333;\">float<\/span> y, <span style=\"color: #993333;\">float<\/span> pressure, <span style=\"color: #993333;\">int<\/span> id<span style=\"color: #66cc66;\">&#41;<\/span> <span style=\"color: #66cc66;\">&#123;<\/span>\n    FieldPacker touch_fp = <span style=\"color: #000000; font-weight: bold;\">new<\/span> FieldPacker<span style=\"color: #66cc66;\">&#40;<\/span><span style=\"color: #cc66cc;\">16<\/span><span style=\"color: #66cc66;\">&#41;<\/span>;\n    touch_fp.<span style=\"color: #006600;\">addF32<\/span><span style=\"color: #66cc66;\">&#40;<\/span>x<span style=\"color: #66cc66;\">&#41;<\/span>;\n    touch_fp.<span style=\"color: #006600;\">addF32<\/span><span style=\"color: #66cc66;\">&#40;<\/span>y<span style=\"color: #66cc66;\">&#41;<\/span>;\n    touch_fp.<span style=\"color: #006600;\">addF32<\/span><span style=\"color: #66cc66;\">&#40;<\/span>pressure<span style=\"color: #66cc66;\">&#41;<\/span>;\n    touch_fp.<span style=\"color: #006600;\">addI32<\/span><span style=\"color: #66cc66;\">&#40;<\/span>id<span style=\"color: #66cc66;\">&#41;<\/span>;\n    invoke<span style=\"color: #66cc66;\">&#40;<\/span>mExportFuncIdx_touch, touch_fp<span style=\"color: #66cc66;\">&#41;<\/span>;\n<span style=\"color: #66cc66;\">&#125;<\/span>\n&#160;<\/pre>\n<p>\u51fd\u6570\u662f\u6ca1\u6709\u8fd4\u56de\u503c\u7684\uff0c\u56e0\u4e3aRenderscript \u7cfb\u7edf\u8bbe\u8ba1\u4e3a\u5f02\u6b65\uff0c\u5f53Android\u6846\u67b6\u4ee3\u7801\u8c03\u7528Renderscript\u4ee3\u7801\u65f6\uff0c\u8bf7\u6c42\u4f1a\u88ab\u52a0\u5165\u961f\u5217\u5e76\u5c3d\u5feb\u6267\u884c\u3002\u8fd9\u79cd\u9650\u5236\u4f7f\u5f97Renderscript \u7cfb\u7edf\u5728\u8fd0\u884c\u65f6\u6ca1\u6709\u4e2d\u65ad\uff0c\u4ece\u800c\u63d0\u9ad8\u4e86\u6548\u7387\u3002\u5982\u679c\u51fd\u6570\u5141\u8bb8\u6709\u8fd4\u56de\u503c\uff0c\u90a3\u4e48\u8bf7\u6c42\u4f1a\u963b\u585e\u7b49\u5f85\u8fd4\u56de\u503c\u3002\n\u5982\u679c\u4f60\u60f3\u5728Renderscript\u4ee3\u7801\u4e2d\u8fd4\u56de\u503c\u7ed9Android\u6846\u67b6\uff0c\u4f60\u53ef\u4ee5\u4f7f\u7528rsSendToClient()\u51fd\u6570\u3002\n<\/p>\n<h3> <span class=\"mw-headline\" id=\".E5.8F.98.E9.87.8F\">\u53d8\u91cf<\/span><\/h3>\n<p>\u6240\u6709\u652f\u6301\u7c7b\u578b\u7684\u53d8\u91cf\u88ab\u53cd\u5c04\u6210\u811a\u672c\u7c7b\uff0c\u4f4d\u4e8e project_root\/gen\/package\/name\/ScriptC_renderscript_filename\uff0c\u5b83\u7531\u4e00\u7ec4\u5b58\u50a8\u5668\u65b9\u6cd5\u751f\u6210\u3002\u4f8b\u5982\u5728\u4f60\u7684Renderscript\u4ee3\u7801\u4e2d\u58f0\u660e\u5982\u4e0b\u53d8\u91cf\uff1a\n<\/p>\n<pre class=\"java\">&#160;\nuint32_t unsignedInteger = <span style=\"color: #cc66cc;\">1<\/span>;\n&#160;<\/pre>\n<p>\u751f\u6210\u5982\u4e0b\u4ee3\u7801\uff1a\n<\/p>\n<pre class=\"java\">&#160;\n<span style=\"color: #000000; font-weight: bold;\">private<\/span> <span style=\"color: #993333;\">long<\/span> mExportVar_unsignedInteger;\n<span style=\"color: #000000; font-weight: bold;\">public<\/span> <span style=\"color: #993333;\">void<\/span> set_unsignedInteger<span style=\"color: #66cc66;\">&#40;<\/span><span style=\"color: #993333;\">long<\/span> v<span style=\"color: #66cc66;\">&#41;<\/span><span style=\"color: #66cc66;\">&#123;<\/span>\n    mExportVar_unsignedInteger = v;\n    setVar<span style=\"color: #66cc66;\">&#40;<\/span>mExportVarIdx_unsignedInteger, v<span style=\"color: #66cc66;\">&#41;<\/span>;\n<span style=\"color: #66cc66;\">&#125;<\/span>\n&#160;\n<span style=\"color: #000000; font-weight: bold;\">public<\/span> <span style=\"color: #993333;\">long<\/span> get_unsignedInteger<span style=\"color: #66cc66;\">&#40;<\/span><span style=\"color: #66cc66;\">&#41;<\/span><span style=\"color: #66cc66;\">&#123;<\/span>\n    <span style=\"color: #000000; font-weight: bold;\">return<\/span> mExportVar_unsignedInteger;\n<span style=\"color: #66cc66;\">&#125;<\/span>\n&#160;<\/pre>\n<h3> <span class=\"mw-headline\" id=\".E7.BB.93.E6.9E.84\">\u7ed3\u6784<\/span><\/h3>\n<p>\u7ed3\u6784\u4f53\u88ab\u53cd\u5c04\u5230\u4ed6\u4eec\u81ea\u5df1\u7684\u7c7b\uff0c\u4f4d\u4e8e &lt;project_root&gt;\/gen\/com\/example\/renderscript\/ScriptField_struct_name\u3002\u8fd9\u4e2a\u7c7b\u4ee3\u8868\u4e00\u4e2a\u7ed3\u6784\u4f53\u6570\u7ec4\uff0c\u5e76\u4e14\u5141\u8bb8\u4f60\u4e3a\u6307\u5b9a\u6570\u91cf\u7684\u7ed3\u6784\u4f53\u5206\u914d\u5185\u5b58\uff0c\u4f8b\u5982\u4f60\u58f0\u660e\u5982\u4e0b\u7ed3\u6784\u4f53\uff1a\n<\/p>\n<pre class=\"java\">&#160;\ntypedef struct <a href=\"http:\/\/www.google.com\/search?hl=en&amp;q=allinurl%3APoint+java.sun.com&amp;btnI=I%27m%20Feeling%20Lucky\"><span style=\"color: #aaaadd; font-weight: bold;\">Point<\/span><\/a> <span style=\"color: #66cc66;\">&#123;<\/span>\n    float2 position;\n    <span style=\"color: #993333;\">float<\/span> size;\n<span style=\"color: #66cc66;\">&#125;<\/span> Point_t;\n&#160;<\/pre>\n<p>\u5982\u4e0b\u4ee3\u7801\u751f\u6210\u5728 ScriptField_Point.java:\n<\/p>\n<pre class=\"java\">&#160;\n<span style=\"color: #000000; font-weight: bold;\">package<\/span> com.<span style=\"color: #006600;\">example<\/span>.<span style=\"color: #006600;\">android<\/span>.<span style=\"color: #006600;\">rs<\/span>.<span style=\"color: #006600;\">hellocompute<\/span>;\n&#160;\n<span style=\"color: #a1a100;\">import android.renderscript.*;<\/span>\n<span style=\"color: #a1a100;\">import android.content.res.Resources;<\/span>\n&#160;\n  <span style=\"color: #808080; font-style: italic;\">\/**\n  * @hide\n  *\/<\/span>\n<span style=\"color: #000000; font-weight: bold;\">public<\/span> <span style=\"color: #000000; font-weight: bold;\">class<\/span> ScriptField_Point <span style=\"color: #000000; font-weight: bold;\">extends<\/span> android.<span style=\"color: #006600;\">renderscript<\/span>.<span style=\"color: #006600;\">Script<\/span>.<span style=\"color: #006600;\">FieldBase<\/span> <span style=\"color: #66cc66;\">&#123;<\/span>\n&#160;\n    <span style=\"color: #000000; font-weight: bold;\">static<\/span> <span style=\"color: #000000; font-weight: bold;\">public<\/span> <span style=\"color: #000000; font-weight: bold;\">class<\/span> Item <span style=\"color: #66cc66;\">&#123;<\/span>\n        <span style=\"color: #000000; font-weight: bold;\">public<\/span> <span style=\"color: #000000; font-weight: bold;\">static<\/span> <span style=\"color: #000000; font-weight: bold;\">final<\/span> <span style=\"color: #993333;\">int<\/span> sizeof = <span style=\"color: #cc66cc;\">12<\/span>;\n&#160;\n        Float2 position;\n        <span style=\"color: #993333;\">float<\/span> size;\n&#160;\n        Item<span style=\"color: #66cc66;\">&#40;<\/span><span style=\"color: #66cc66;\">&#41;<\/span> <span style=\"color: #66cc66;\">&#123;<\/span>\n            position = <span style=\"color: #000000; font-weight: bold;\">new<\/span> Float2<span style=\"color: #66cc66;\">&#40;<\/span><span style=\"color: #66cc66;\">&#41;<\/span>;\n        <span style=\"color: #66cc66;\">&#125;<\/span>\n    <span style=\"color: #66cc66;\">&#125;<\/span>\n&#160;\n    <span style=\"color: #000000; font-weight: bold;\">private<\/span> Item mItemArray<span style=\"color: #66cc66;\">&#91;<\/span><span style=\"color: #66cc66;\">&#93;<\/span>;\n    <span style=\"color: #000000; font-weight: bold;\">private<\/span> FieldPacker mIOBuffer;\n    <span style=\"color: #000000; font-weight: bold;\">public<\/span> <span style=\"color: #000000; font-weight: bold;\">static<\/span> <a href=\"http:\/\/www.google.com\/search?hl=en&amp;q=allinurl%3AElement+java.sun.com&amp;btnI=I%27m%20Feeling%20Lucky\"><span style=\"color: #aaaadd; font-weight: bold;\">Element<\/span><\/a> createElement<span style=\"color: #66cc66;\">&#40;<\/span>RenderScript rs<span style=\"color: #66cc66;\">&#41;<\/span> <span style=\"color: #66cc66;\">&#123;<\/span>\n        <a href=\"http:\/\/www.google.com\/search?hl=en&amp;q=allinurl%3AElement+java.sun.com&amp;btnI=I%27m%20Feeling%20Lucky\"><span style=\"color: #aaaadd; font-weight: bold;\">Element<\/span><\/a>.<span style=\"color: #006600;\">Builder<\/span> eb = <span style=\"color: #000000; font-weight: bold;\">new<\/span> <a href=\"http:\/\/www.google.com\/search?hl=en&amp;q=allinurl%3AElement+java.sun.com&amp;btnI=I%27m%20Feeling%20Lucky\"><span style=\"color: #aaaadd; font-weight: bold;\">Element<\/span><\/a>.<span style=\"color: #006600;\">Builder<\/span><span style=\"color: #66cc66;\">&#40;<\/span>rs<span style=\"color: #66cc66;\">&#41;<\/span>;\n        eb.<span style=\"color: #006600;\">add<\/span><span style=\"color: #66cc66;\">&#40;<\/span><a href=\"http:\/\/www.google.com\/search?hl=en&amp;q=allinurl%3AElement+java.sun.com&amp;btnI=I%27m%20Feeling%20Lucky\"><span style=\"color: #aaaadd; font-weight: bold;\">Element<\/span><\/a>.<span style=\"color: #006600;\">F32_2<\/span><span style=\"color: #66cc66;\">&#40;<\/span>rs<span style=\"color: #66cc66;\">&#41;<\/span>, <span style=\"color: #ff0000;\">&quot;position&quot;<\/span><span style=\"color: #66cc66;\">&#41;<\/span>;\n        eb.<span style=\"color: #006600;\">add<\/span><span style=\"color: #66cc66;\">&#40;<\/span><a href=\"http:\/\/www.google.com\/search?hl=en&amp;q=allinurl%3AElement+java.sun.com&amp;btnI=I%27m%20Feeling%20Lucky\"><span style=\"color: #aaaadd; font-weight: bold;\">Element<\/span><\/a>.<span style=\"color: #006600;\">F32<\/span><span style=\"color: #66cc66;\">&#40;<\/span>rs<span style=\"color: #66cc66;\">&#41;<\/span>, <span style=\"color: #ff0000;\">&quot;size&quot;<\/span><span style=\"color: #66cc66;\">&#41;<\/span>;\n        <span style=\"color: #000000; font-weight: bold;\">return<\/span> eb.<span style=\"color: #006600;\">create<\/span><span style=\"color: #66cc66;\">&#40;<\/span><span style=\"color: #66cc66;\">&#41;<\/span>;\n    <span style=\"color: #66cc66;\">&#125;<\/span>\n&#160;\n    <span style=\"color: #000000; font-weight: bold;\">public<\/span>  ScriptField_Point<span style=\"color: #66cc66;\">&#40;<\/span>RenderScript rs, <span style=\"color: #993333;\">int<\/span> count<span style=\"color: #66cc66;\">&#41;<\/span> <span style=\"color: #66cc66;\">&#123;<\/span>\n        mItemArray = <span style=\"color: #000000; font-weight: bold;\">null<\/span>;\n        mIOBuffer = <span style=\"color: #000000; font-weight: bold;\">null<\/span>;\n        mElement = createElement<span style=\"color: #66cc66;\">&#40;<\/span>rs<span style=\"color: #66cc66;\">&#41;<\/span>;\n        init<span style=\"color: #66cc66;\">&#40;<\/span>rs, count<span style=\"color: #66cc66;\">&#41;<\/span>;\n    <span style=\"color: #66cc66;\">&#125;<\/span>\n&#160;\n    <span style=\"color: #000000; font-weight: bold;\">public<\/span>  ScriptField_Point<span style=\"color: #66cc66;\">&#40;<\/span>RenderScript rs, <span style=\"color: #993333;\">int<\/span> count, <span style=\"color: #993333;\">int<\/span> usages<span style=\"color: #66cc66;\">&#41;<\/span> <span style=\"color: #66cc66;\">&#123;<\/span>\n        mItemArray = <span style=\"color: #000000; font-weight: bold;\">null<\/span>;\n        mIOBuffer = <span style=\"color: #000000; font-weight: bold;\">null<\/span>;\n        mElement = createElement<span style=\"color: #66cc66;\">&#40;<\/span>rs<span style=\"color: #66cc66;\">&#41;<\/span>;\n        init<span style=\"color: #66cc66;\">&#40;<\/span>rs, count, usages<span style=\"color: #66cc66;\">&#41;<\/span>;\n    <span style=\"color: #66cc66;\">&#125;<\/span>\n&#160;\n    <span style=\"color: #000000; font-weight: bold;\">private<\/span> <span style=\"color: #993333;\">void<\/span> copyToArray<span style=\"color: #66cc66;\">&#40;<\/span>Item i, <span style=\"color: #993333;\">int<\/span> index<span style=\"color: #66cc66;\">&#41;<\/span> <span style=\"color: #66cc66;\">&#123;<\/span>\n        <span style=\"color: #b1b100;\">if<\/span> <span style=\"color: #66cc66;\">&#40;<\/span>mIOBuffer == <span style=\"color: #000000; font-weight: bold;\">null<\/span><span style=\"color: #66cc66;\">&#41;<\/span> mIOBuffer = <span style=\"color: #000000; font-weight: bold;\">new<\/span> FieldPacker<span style=\"color: #66cc66;\">&#40;<\/span>Item.<span style=\"color: #006600;\">sizeof<\/span> * getType<span style=\"color: #66cc66;\">&#40;<\/span><span style=\"color: #66cc66;\">&#41;<\/span>.<span style=\"color: #006600;\">getX<\/span><span style=\"color: #66cc66;\">&#40;<\/span><span style=\"color: #66cc66;\">&#41;<\/span><span style=\"color: #808080; font-style: italic;\">\/* count\n        *\/<\/span><span style=\"color: #66cc66;\">&#41;<\/span>;\n        mIOBuffer.<span style=\"color: #006600;\">reset<\/span><span style=\"color: #66cc66;\">&#40;<\/span>index * Item.<span style=\"color: #006600;\">sizeof<\/span><span style=\"color: #66cc66;\">&#41;<\/span>;\n        mIOBuffer.<span style=\"color: #006600;\">addF32<\/span><span style=\"color: #66cc66;\">&#40;<\/span>i.<span style=\"color: #006600;\">position<\/span><span style=\"color: #66cc66;\">&#41;<\/span>;\n        mIOBuffer.<span style=\"color: #006600;\">addF32<\/span><span style=\"color: #66cc66;\">&#40;<\/span>i.<span style=\"color: #006600;\">size<\/span><span style=\"color: #66cc66;\">&#41;<\/span>;\n    <span style=\"color: #66cc66;\">&#125;<\/span>\n&#160;\n    <span style=\"color: #000000; font-weight: bold;\">public<\/span> <span style=\"color: #993333;\">void<\/span> set<span style=\"color: #66cc66;\">&#40;<\/span>Item i, <span style=\"color: #993333;\">int<\/span> index, <span style=\"color: #993333;\">boolean<\/span> copyNow<span style=\"color: #66cc66;\">&#41;<\/span> <span style=\"color: #66cc66;\">&#123;<\/span>\n        <span style=\"color: #b1b100;\">if<\/span> <span style=\"color: #66cc66;\">&#40;<\/span>mItemArray == <span style=\"color: #000000; font-weight: bold;\">null<\/span><span style=\"color: #66cc66;\">&#41;<\/span> mItemArray = <span style=\"color: #000000; font-weight: bold;\">new<\/span> Item<span style=\"color: #66cc66;\">&#91;<\/span>getType<span style=\"color: #66cc66;\">&#40;<\/span><span style=\"color: #66cc66;\">&#41;<\/span>.<span style=\"color: #006600;\">getX<\/span><span style=\"color: #66cc66;\">&#40;<\/span><span style=\"color: #66cc66;\">&#41;<\/span> <span style=\"color: #808080; font-style: italic;\">\/* count *\/<\/span><span style=\"color: #66cc66;\">&#93;<\/span>;\n        mItemArray<span style=\"color: #66cc66;\">&#91;<\/span>index<span style=\"color: #66cc66;\">&#93;<\/span> = i;\n        <span style=\"color: #b1b100;\">if<\/span> <span style=\"color: #66cc66;\">&#40;<\/span>copyNow<span style=\"color: #66cc66;\">&#41;<\/span>  <span style=\"color: #66cc66;\">&#123;<\/span>\n            copyToArray<span style=\"color: #66cc66;\">&#40;<\/span>i, index<span style=\"color: #66cc66;\">&#41;<\/span>;\n            mAllocation.<span style=\"color: #006600;\">setFromFieldPacker<\/span><span style=\"color: #66cc66;\">&#40;<\/span>index, mIOBuffer<span style=\"color: #66cc66;\">&#41;<\/span>;\n        <span style=\"color: #66cc66;\">&#125;<\/span>\n    <span style=\"color: #66cc66;\">&#125;<\/span>\n&#160;\n    <span style=\"color: #000000; font-weight: bold;\">public<\/span> Item get<span style=\"color: #66cc66;\">&#40;<\/span><span style=\"color: #993333;\">int<\/span> index<span style=\"color: #66cc66;\">&#41;<\/span> <span style=\"color: #66cc66;\">&#123;<\/span>\n        <span style=\"color: #b1b100;\">if<\/span> <span style=\"color: #66cc66;\">&#40;<\/span>mItemArray == <span style=\"color: #000000; font-weight: bold;\">null<\/span><span style=\"color: #66cc66;\">&#41;<\/span> <span style=\"color: #000000; font-weight: bold;\">return<\/span> <span style=\"color: #000000; font-weight: bold;\">null<\/span>;\n        <span style=\"color: #000000; font-weight: bold;\">return<\/span> mItemArray<span style=\"color: #66cc66;\">&#91;<\/span>index<span style=\"color: #66cc66;\">&#93;<\/span>;\n    <span style=\"color: #66cc66;\">&#125;<\/span>\n&#160;\n    <span style=\"color: #000000; font-weight: bold;\">public<\/span> <span style=\"color: #993333;\">void<\/span> set_position<span style=\"color: #66cc66;\">&#40;<\/span><span style=\"color: #993333;\">int<\/span> index, Float2 v, <span style=\"color: #993333;\">boolean<\/span> copyNow<span style=\"color: #66cc66;\">&#41;<\/span> <span style=\"color: #66cc66;\">&#123;<\/span>\n        <span style=\"color: #b1b100;\">if<\/span> <span style=\"color: #66cc66;\">&#40;<\/span>mIOBuffer == <span style=\"color: #000000; font-weight: bold;\">null<\/span><span style=\"color: #66cc66;\">&#41;<\/span> mIOBuffer = <span style=\"color: #000000; font-weight: bold;\">new<\/span> FieldPacker<span style=\"color: #66cc66;\">&#40;<\/span>Item.<span style=\"color: #006600;\">sizeof<\/span> * getType<span style=\"color: #66cc66;\">&#40;<\/span><span style=\"color: #66cc66;\">&#41;<\/span>.<span style=\"color: #006600;\">getX<\/span><span style=\"color: #66cc66;\">&#40;<\/span><span style=\"color: #66cc66;\">&#41;<\/span><span style=\"color: #808080; font-style: italic;\">\/* count *\/<\/span><span style=\"color: #66cc66;\">&#41;<\/span>;\n        <span style=\"color: #b1b100;\">if<\/span> <span style=\"color: #66cc66;\">&#40;<\/span>mItemArray == <span style=\"color: #000000; font-weight: bold;\">null<\/span><span style=\"color: #66cc66;\">&#41;<\/span> mItemArray = <span style=\"color: #000000; font-weight: bold;\">new<\/span> Item<span style=\"color: #66cc66;\">&#91;<\/span>getType<span style=\"color: #66cc66;\">&#40;<\/span><span style=\"color: #66cc66;\">&#41;<\/span>.<span style=\"color: #006600;\">getX<\/span><span style=\"color: #66cc66;\">&#40;<\/span><span style=\"color: #66cc66;\">&#41;<\/span> <span style=\"color: #808080; font-style: italic;\">\/* count *\/<\/span><span style=\"color: #66cc66;\">&#93;<\/span>;\n        <span style=\"color: #b1b100;\">if<\/span> <span style=\"color: #66cc66;\">&#40;<\/span>mItemArray<span style=\"color: #66cc66;\">&#91;<\/span>index<span style=\"color: #66cc66;\">&#93;<\/span> == <span style=\"color: #000000; font-weight: bold;\">null<\/span><span style=\"color: #66cc66;\">&#41;<\/span> mItemArray<span style=\"color: #66cc66;\">&#91;<\/span>index<span style=\"color: #66cc66;\">&#93;<\/span> = <span style=\"color: #000000; font-weight: bold;\">new<\/span> Item<span style=\"color: #66cc66;\">&#40;<\/span><span style=\"color: #66cc66;\">&#41;<\/span>;\n        mItemArray<span style=\"color: #66cc66;\">&#91;<\/span>index<span style=\"color: #66cc66;\">&#93;<\/span>.<span style=\"color: #006600;\">position<\/span> = v;\n        <span style=\"color: #b1b100;\">if<\/span> <span style=\"color: #66cc66;\">&#40;<\/span>copyNow<span style=\"color: #66cc66;\">&#41;<\/span> <span style=\"color: #66cc66;\">&#123;<\/span>\n            mIOBuffer.<span style=\"color: #006600;\">reset<\/span><span style=\"color: #66cc66;\">&#40;<\/span>index * Item.<span style=\"color: #006600;\">sizeof<\/span><span style=\"color: #66cc66;\">&#41;<\/span>;\n            mIOBuffer.<span style=\"color: #006600;\">addF32<\/span><span style=\"color: #66cc66;\">&#40;<\/span>v<span style=\"color: #66cc66;\">&#41;<\/span>;\n            FieldPacker fp = <span style=\"color: #000000; font-weight: bold;\">new<\/span> FieldPacker<span style=\"color: #66cc66;\">&#40;<\/span><span style=\"color: #cc66cc;\">8<\/span><span style=\"color: #66cc66;\">&#41;<\/span>;\n            fp.<span style=\"color: #006600;\">addF32<\/span><span style=\"color: #66cc66;\">&#40;<\/span>v<span style=\"color: #66cc66;\">&#41;<\/span>;\n            mAllocation.<span style=\"color: #006600;\">setFromFieldPacker<\/span><span style=\"color: #66cc66;\">&#40;<\/span>index, <span style=\"color: #cc66cc;\">0<\/span>, fp<span style=\"color: #66cc66;\">&#41;<\/span>;\n        <span style=\"color: #66cc66;\">&#125;<\/span>\n    <span style=\"color: #66cc66;\">&#125;<\/span>\n&#160;\n    <span style=\"color: #000000; font-weight: bold;\">public<\/span> <span style=\"color: #993333;\">void<\/span> set_size<span style=\"color: #66cc66;\">&#40;<\/span><span style=\"color: #993333;\">int<\/span> index, <span style=\"color: #993333;\">float<\/span> v, <span style=\"color: #993333;\">boolean<\/span> copyNow<span style=\"color: #66cc66;\">&#41;<\/span> <span style=\"color: #66cc66;\">&#123;<\/span>\n        <span style=\"color: #b1b100;\">if<\/span> <span style=\"color: #66cc66;\">&#40;<\/span>mIOBuffer == <span style=\"color: #000000; font-weight: bold;\">null<\/span><span style=\"color: #66cc66;\">&#41;<\/span> mIOBuffer = <span style=\"color: #000000; font-weight: bold;\">new<\/span> FieldPacker<span style=\"color: #66cc66;\">&#40;<\/span>Item.<span style=\"color: #006600;\">sizeof<\/span> * getType<span style=\"color: #66cc66;\">&#40;<\/span><span style=\"color: #66cc66;\">&#41;<\/span>.<span style=\"color: #006600;\">getX<\/span><span style=\"color: #66cc66;\">&#40;<\/span><span style=\"color: #66cc66;\">&#41;<\/span><span style=\"color: #808080; font-style: italic;\">\/* count *\/<\/span><span style=\"color: #66cc66;\">&#41;<\/span>;\n        <span style=\"color: #b1b100;\">if<\/span> <span style=\"color: #66cc66;\">&#40;<\/span>mItemArray == <span style=\"color: #000000; font-weight: bold;\">null<\/span><span style=\"color: #66cc66;\">&#41;<\/span> mItemArray = <span style=\"color: #000000; font-weight: bold;\">new<\/span> Item<span style=\"color: #66cc66;\">&#91;<\/span>getType<span style=\"color: #66cc66;\">&#40;<\/span><span style=\"color: #66cc66;\">&#41;<\/span>.<span style=\"color: #006600;\">getX<\/span><span style=\"color: #66cc66;\">&#40;<\/span><span style=\"color: #66cc66;\">&#41;<\/span> <span style=\"color: #808080; font-style: italic;\">\/* count *\/<\/span><span style=\"color: #66cc66;\">&#93;<\/span>;\n        <span style=\"color: #b1b100;\">if<\/span> <span style=\"color: #66cc66;\">&#40;<\/span>mItemArray<span style=\"color: #66cc66;\">&#91;<\/span>index<span style=\"color: #66cc66;\">&#93;<\/span> == <span style=\"color: #000000; font-weight: bold;\">null<\/span><span style=\"color: #66cc66;\">&#41;<\/span> mItemArray<span style=\"color: #66cc66;\">&#91;<\/span>index<span style=\"color: #66cc66;\">&#93;<\/span> = <span style=\"color: #000000; font-weight: bold;\">new<\/span> Item<span style=\"color: #66cc66;\">&#40;<\/span><span style=\"color: #66cc66;\">&#41;<\/span>;\n        mItemArray<span style=\"color: #66cc66;\">&#91;<\/span>index<span style=\"color: #66cc66;\">&#93;<\/span>.<span style=\"color: #006600;\">size<\/span> = v;\n        <span style=\"color: #b1b100;\">if<\/span> <span style=\"color: #66cc66;\">&#40;<\/span>copyNow<span style=\"color: #66cc66;\">&#41;<\/span>  <span style=\"color: #66cc66;\">&#123;<\/span>\n            mIOBuffer.<span style=\"color: #006600;\">reset<\/span><span style=\"color: #66cc66;\">&#40;<\/span>index * Item.<span style=\"color: #006600;\">sizeof<\/span> + <span style=\"color: #cc66cc;\">8<\/span><span style=\"color: #66cc66;\">&#41;<\/span>;\n            mIOBuffer.<span style=\"color: #006600;\">addF32<\/span><span style=\"color: #66cc66;\">&#40;<\/span>v<span style=\"color: #66cc66;\">&#41;<\/span>;\n            FieldPacker fp = <span style=\"color: #000000; font-weight: bold;\">new<\/span> FieldPacker<span style=\"color: #66cc66;\">&#40;<\/span><span style=\"color: #cc66cc;\">4<\/span><span style=\"color: #66cc66;\">&#41;<\/span>;\n            fp.<span style=\"color: #006600;\">addF32<\/span><span style=\"color: #66cc66;\">&#40;<\/span>v<span style=\"color: #66cc66;\">&#41;<\/span>;\n            mAllocation.<span style=\"color: #006600;\">setFromFieldPacker<\/span><span style=\"color: #66cc66;\">&#40;<\/span>index, <span style=\"color: #cc66cc;\">1<\/span>, fp<span style=\"color: #66cc66;\">&#41;<\/span>;\n        <span style=\"color: #66cc66;\">&#125;<\/span>\n    <span style=\"color: #66cc66;\">&#125;<\/span>\n&#160;\n    <span style=\"color: #000000; font-weight: bold;\">public<\/span> Float2 get_position<span style=\"color: #66cc66;\">&#40;<\/span><span style=\"color: #993333;\">int<\/span> index<span style=\"color: #66cc66;\">&#41;<\/span> <span style=\"color: #66cc66;\">&#123;<\/span>\n        <span style=\"color: #b1b100;\">if<\/span> <span style=\"color: #66cc66;\">&#40;<\/span>mItemArray == <span style=\"color: #000000; font-weight: bold;\">null<\/span><span style=\"color: #66cc66;\">&#41;<\/span> <span style=\"color: #000000; font-weight: bold;\">return<\/span> <span style=\"color: #000000; font-weight: bold;\">null<\/span>;\n        <span style=\"color: #000000; font-weight: bold;\">return<\/span> mItemArray<span style=\"color: #66cc66;\">&#91;<\/span>index<span style=\"color: #66cc66;\">&#93;<\/span>.<span style=\"color: #006600;\">position<\/span>;\n    <span style=\"color: #66cc66;\">&#125;<\/span>\n&#160;\n    <span style=\"color: #000000; font-weight: bold;\">public<\/span> <span style=\"color: #993333;\">float<\/span> get_size<span style=\"color: #66cc66;\">&#40;<\/span><span style=\"color: #993333;\">int<\/span> index<span style=\"color: #66cc66;\">&#41;<\/span> <span style=\"color: #66cc66;\">&#123;<\/span>\n        <span style=\"color: #b1b100;\">if<\/span> <span style=\"color: #66cc66;\">&#40;<\/span>mItemArray == <span style=\"color: #000000; font-weight: bold;\">null<\/span><span style=\"color: #66cc66;\">&#41;<\/span> <span style=\"color: #000000; font-weight: bold;\">return<\/span> <span style=\"color: #cc66cc;\">0<\/span>;\n        <span style=\"color: #000000; font-weight: bold;\">return<\/span> mItemArray<span style=\"color: #66cc66;\">&#91;<\/span>index<span style=\"color: #66cc66;\">&#93;<\/span>.<span style=\"color: #006600;\">size<\/span>;\n    <span style=\"color: #66cc66;\">&#125;<\/span>\n&#160;\n    <span style=\"color: #000000; font-weight: bold;\">public<\/span> <span style=\"color: #993333;\">void<\/span> copyAll<span style=\"color: #66cc66;\">&#40;<\/span><span style=\"color: #66cc66;\">&#41;<\/span> <span style=\"color: #66cc66;\">&#123;<\/span>\n        <span style=\"color: #b1b100;\">for<\/span> <span style=\"color: #66cc66;\">&#40;<\/span><span style=\"color: #993333;\">int<\/span> ct = <span style=\"color: #cc66cc;\">0<\/span>; ct &lt; mItemArray.<span style=\"color: #006600;\">length<\/span>; ct++<span style=\"color: #66cc66;\">&#41;<\/span> copyToArray<span style=\"color: #66cc66;\">&#40;<\/span>mItemArray<span style=\"color: #66cc66;\">&#91;<\/span>ct<span style=\"color: #66cc66;\">&#93;<\/span>, ct<span style=\"color: #66cc66;\">&#41;<\/span>;\n        mAllocation.<span style=\"color: #006600;\">setFromFieldPacker<\/span><span style=\"color: #66cc66;\">&#40;<\/span><span style=\"color: #cc66cc;\">0<\/span>, mIOBuffer<span style=\"color: #66cc66;\">&#41;<\/span>;\n    <span style=\"color: #66cc66;\">&#125;<\/span>\n&#160;\n    <span style=\"color: #000000; font-weight: bold;\">public<\/span> <span style=\"color: #993333;\">void<\/span> resize<span style=\"color: #66cc66;\">&#40;<\/span><span style=\"color: #993333;\">int<\/span> newSize<span style=\"color: #66cc66;\">&#41;<\/span> <span style=\"color: #66cc66;\">&#123;<\/span>\n        <span style=\"color: #b1b100;\">if<\/span> <span style=\"color: #66cc66;\">&#40;<\/span>mItemArray&#160;!= <span style=\"color: #000000; font-weight: bold;\">null<\/span><span style=\"color: #66cc66;\">&#41;<\/span>  <span style=\"color: #66cc66;\">&#123;<\/span>\n            <span style=\"color: #993333;\">int<\/span> oldSize = mItemArray.<span style=\"color: #006600;\">length<\/span>;\n            <span style=\"color: #993333;\">int<\/span> copySize = <a href=\"http:\/\/www.google.com\/search?hl=en&amp;q=allinurl%3AMath+java.sun.com&amp;btnI=I%27m%20Feeling%20Lucky\"><span style=\"color: #aaaadd; font-weight: bold;\">Math<\/span><\/a>.<span style=\"color: #006600;\">min<\/span><span style=\"color: #66cc66;\">&#40;<\/span>oldSize, newSize<span style=\"color: #66cc66;\">&#41;<\/span>;\n            <span style=\"color: #b1b100;\">if<\/span> <span style=\"color: #66cc66;\">&#40;<\/span>newSize == oldSize<span style=\"color: #66cc66;\">&#41;<\/span> <span style=\"color: #000000; font-weight: bold;\">return<\/span>;\n            Item ni<span style=\"color: #66cc66;\">&#91;<\/span><span style=\"color: #66cc66;\">&#93;<\/span> = <span style=\"color: #000000; font-weight: bold;\">new<\/span> Item<span style=\"color: #66cc66;\">&#91;<\/span>newSize<span style=\"color: #66cc66;\">&#93;<\/span>;\n            <a href=\"http:\/\/www.google.com\/search?hl=en&amp;q=allinurl%3ASystem+java.sun.com&amp;btnI=I%27m%20Feeling%20Lucky\"><span style=\"color: #aaaadd; font-weight: bold;\">System<\/span><\/a>.<span style=\"color: #006600;\">arraycopy<\/span><span style=\"color: #66cc66;\">&#40;<\/span>mItemArray, <span style=\"color: #cc66cc;\">0<\/span>, ni, <span style=\"color: #cc66cc;\">0<\/span>, copySize<span style=\"color: #66cc66;\">&#41;<\/span>;\n            mItemArray = ni;\n        <span style=\"color: #66cc66;\">&#125;<\/span>\n        mAllocation.<span style=\"color: #006600;\">resize<\/span><span style=\"color: #66cc66;\">&#40;<\/span>newSize<span style=\"color: #66cc66;\">&#41;<\/span>;\n        <span style=\"color: #b1b100;\">if<\/span> <span style=\"color: #66cc66;\">&#40;<\/span>mIOBuffer&#160;!= <span style=\"color: #000000; font-weight: bold;\">null<\/span><span style=\"color: #66cc66;\">&#41;<\/span> mIOBuffer = <span style=\"color: #000000; font-weight: bold;\">new<\/span> FieldPacker<span style=\"color: #66cc66;\">&#40;<\/span>Item.<span style=\"color: #006600;\">sizeof<\/span> * getType<span style=\"color: #66cc66;\">&#40;<\/span><span style=\"color: #66cc66;\">&#41;<\/span>.<span style=\"color: #006600;\">getX<\/span><span style=\"color: #66cc66;\">&#40;<\/span><span style=\"color: #66cc66;\">&#41;<\/span><span style=\"color: #808080; font-style: italic;\">\/* count *\/<\/span><span style=\"color: #66cc66;\">&#41;<\/span>;\n    <span style=\"color: #66cc66;\">&#125;<\/span>\n<span style=\"color: #66cc66;\">&#125;<\/span>\n&#160;<\/pre>\n<p>\u751f\u6210\u7684\u4ee3\u7801\u4f7f\u5f97Renderscript\u8fd0\u884c\u65f6\u4e3a\u7ed3\u6784\u4f53\u5206\u914d\u5185\u5b58\u548c\u4ea4\u4e92\u66f4\u65b9\u4fbf\uff0c\u6bcf\u4e00\u4e2a\u7ed3\u6784\u4f53\u7c7b\u90fd\u5b9a\u4e49\u4e86\u5982\u4e0b\u65b9\u6cd5\u548c\u6784\u9020\u51fd\u6570\uff1a\n<\/p>\n<ul><li>\u88ab\u91cd\u8f7d\u7684\u6784\u9020\u51fd\u6570\uff0c\u5141\u8bb8\u4f60\u5206\u914d\u5185\u5b58\u3002ScriptField_struct_name(RenderScript rs, int count)\u6784\u9020\u51fd\u6570\u5141\u8bb8\u4f60\u5b9a\u4e49\u7ed3\u6784\u4f53\u7684\u6570\u91cf\uff0c\u800c\u4f60\u60f3\u4f7f\u7528count\u53c2\u6570\u5bf9\u5176\u5206\u914d\u5185\u5b58\u3002ScriptField_struct_name(RenderScript rs, int count, int usages)\u6784\u9020\u51fd\u6570\u5b9a\u4e49\u4e00\u4e2a\u5177\u4f53\u7684\u53c2\u6570usages\uff0c\u5b83\u8ba9\u4f60\u6307\u5b9a\u8fd9\u6b21\u5185\u5b58\u5206\u914d\u7684\u5185\u5b58\u7a7a\u95f4\u3002\u6709\u56db\u4e2a\u5185\u5b58\u7a7a\u95f4\u7684\u53ef\u80fd\u6027\u3002\n<\/li><li><a rel=\"nofollow\" target=\"_blank\" class=\"external text\" href=\"http:\/\/docs.eoeandroid.com\/reference\/android\/renderscript\/Allocation.html#USAGE_SCRIPT\">USAGE_SCRIPT<\/a>\uff1a\u5728\u811a\u672c\u5185\u5b58\u7a7a\u95f4\u4e2d\u5206\u914d\u3002\u8fd9\u662f\u9ed8\u8ba4\u5185\u5b58\u7a7a\u95f4\uff0c\u5982\u679c\u4f60\u4e0d\u6307\u5b9a\u4e00\u4e2a\u5185\u5b58\u7a7a\u95f4\u3002\n<\/li><li><a rel=\"nofollow\" target=\"_blank\" class=\"external text\" href=\"http:\/\/docs.eoeandroid.com\/reference\/android\/renderscript\/Allocation.html#USAGE_GRAPHICS_TEXTURE\">USAGE_GRAPHICS_TEXTURE<\/a>\uff1a\u5728GPU\u7684\u7eb9\u7406\u5185\u5b58\u7a7a\u95f4\u4e2d\u5206\u914d\u3002\n<\/li><li><a rel=\"nofollow\" target=\"_blank\" class=\"external text\" href=\"http:\/\/docs.eoeandroid.com\/reference\/android\/renderscript\/Allocation.html#USAGE_GRAPHICS_VERTEX\">SAGE_GRAPHICS_VERTEX<\/a>\uff1a\u5728GPU\u7684\u5411\u91cf\u5185\u5b58\u7a7a\u95f4\u4e2d\u5206\u914d\u3002\n<\/li><li><a rel=\"nofollow\" target=\"_blank\" class=\"external text\" href=\"http:\/\/docs.eoeandroid.com\/reference\/android\/renderscript\/Allocation.html#USAGE_GRAPHICS_CONSTANTS\">USAGE_GRAPHICS_CONSTANTS<\/a>\uff1a\u5728GPU\u7684\u5e38\u91cf\u5185\u5b58\u7a7a\u95f4\u4e2d\u5206\u914d\uff0c\u5b83\u88ab\u4e0d\u540c\u7684\u7a0b\u5e8f\u5bf9\u8c61\u4f7f\u7528\u3002\n<\/li><\/ul>\n<p>\u4f60\u53ef\u4ee5\u901a\u8fc7\u4f7f\u7528\u6309\u4f4d\u6216\u64cd\u4f5c\u6765\u6307\u5b9a\u591a\u4e2a\u5185\u5b58\u7a7a\u95f4\u3002\u505a\u8fd9\u4ef6\u4e8b\u901a\u77e5Renderscript\u8fd0\u884c\u65f6\u4f60\u6253\u7b97\u5728\u6307\u5b9a\u7684\u5185\u5b58\u7a7a\u95f4\u4e2d\u8bbf\u95ee\u6570\u636e\u3002\u4ee5\u4e0b\u793a\u4f8b\u4e3a\u4e00\u4e2a\u81ea\u5b9a\u4e49\u6570\u636e\u7c7b\u578b\u5206\u914d\u5185\u5b58\u5728\u811a\u672c\u548c\u9876\u70b9\u5185\u5b58\u7a7a\u95f4\u4e2d\uff1a\n<\/p>\n<pre class=\"java\">&#160;\nScriptField_Point touchPoints = <span style=\"color: #000000; font-weight: bold;\">new<\/span> ScriptField_Point<span style=\"color: #66cc66;\">&#40;<\/span>glRenderer, <span style=\"color: #cc66cc;\">2<\/span>,\n        Allocation.<span style=\"color: #006600;\">USAGE_SCRIPT<\/span> | Allocation.<span style=\"color: #006600;\">USAGE_GRAPHICS_VERTEX<\/span><span style=\"color: #66cc66;\">&#41;<\/span>;\n&#160;<\/pre>\n<p>\u5982\u679c\u4f60\u5728\u4e00\u4e2a\u5185\u5b58\u7a7a\u95f4\u4e2d\u4fee\u6539\u5185\u5b58\u5e76\u4e14\u60f3\u628a\u66f4\u65b0\u63a8\u5230\u5269\u4f59\u7684\u5185\u5b58\u7a7a\u95f4\uff0c\u90a3\u4e48\u4f60\u53ef\u4ee5\u5728 Renderscript\u4ee3\u7801\u4e2d\u8c03\u7528<a rel=\"nofollow\" target=\"_blank\" class=\"external text\" href=\"http:\/\/docs.eoeandroid.com\/reference\/renderscript\/rs__graphics_8rsh.html\">rsgAllocationSyncAll()<\/a>\u4ee5\u540c\u6b65\u5185\u5b58\u3002\n<\/p>\n<ul><li>A static nested class, Item, allows you to create an instance of the struct, in the form of an object. This nested class is useful if it makes more sense to work with the struct in your Android code. When you are done manipulating the object, you can push the object to the allocated memory by calling set(Item i, int index, boolean copyNow) and setting the Item to the desired position in the array. The Renderscript runtime automatically has access to the newly written memory. \n<\/li><li>Accessor methods to get and set the values of each field in a struct. Each of these accessor methods have an index parameter to specify the struct in the array that you want to read or write to. Each setter method also has a copyNow parameter that specifies whether or not to immediately sync this memory to the Renderscript runtime. To sync any memory that has not been synced, call copyAll().\n<\/li><li>The createElement() method creates a description of the struct in memory. This description is used to allocate memory consisting of one or many elements.\n<\/li><li>resize() works much like a realloc() in C, allowing you to expand previously allocated memory, maintaining the current values that were previously created.\n<\/li><li>copyAll() synchronizes memory that was set on the framework level to the Renderscript runtime. When you call a set accessor method on a member, there is an optional copyNow boolean parameter that you can specify. Specifying true synchronizes the memory when you call the method. If you specify false, you can call copyAll() once, and it synchronizes memory for all the properties that are not yet synchronized.\n<\/li><\/ul>\n<p><br \/>\n<\/p>\n<h3> <span class=\"mw-headline\" id=\".E6.8C.87.E9.92.88\">\u6307\u9488<\/span><\/h3>\n<p>\u6307\u9488\u88ab\u53cd\u5c04\u8fdb\u4f4d\u4e8eproject_root\/gen\/package\/name\/ScriptC_renderscript_filename\u4e2d\u7684\u811a\u672c\u7c7b\u81ea\u8eab\uff0c\u4f60\u53ef\u4ee5\u58f0\u660e\u6307\u5411\u4e00\u4e2astruct\u6216\u4efb\u610f\u88ab\u652f\u6301\u7684Renderscript\u7c7b\u578b\u7684\u6307\u9488\uff0c\u4f46\u4e00\u4e2astruct\u4e0d\u53ef\u4ee5\u5305\u542b\u6307\u9488\u6216\u5d4c\u5957\u7684\u6570\u7ec4\u3002\u4f8b\u5982\uff0c\u5982\u679c\u4f60\u58f0\u660e\u4e00\u4e0b\u6307\u5411\u4e00\u4e2astruct\u548cint32_t\u7684\u6307\u9488\n<\/p>\n<pre class=\"java\">&#160;\ntypedef struct <a href=\"http:\/\/www.google.com\/search?hl=en&amp;q=allinurl%3APoint+java.sun.com&amp;btnI=I%27m%20Feeling%20Lucky\"><span style=\"color: #aaaadd; font-weight: bold;\">Point<\/span><\/a> <span style=\"color: #66cc66;\">&#123;<\/span>\n    float2 position;\n    <span style=\"color: #993333;\">float<\/span> size;\n<span style=\"color: #66cc66;\">&#125;<\/span> Point_t;\n&#160;\nPoint_t *touchPoints;\nint32_t *intPointer;\n&#160;<\/pre>\n<p>\u751f\u6210\u4ee3\u7801\u5982\u4e0b\uff1a\n<\/p>\n<pre class=\"java\">&#160;\n<span style=\"color: #000000; font-weight: bold;\">private<\/span> ScriptField_Point mExportVar_touchPoints;\n<span style=\"color: #000000; font-weight: bold;\">public<\/span> <span style=\"color: #993333;\">void<\/span> bind_touchPoints<span style=\"color: #66cc66;\">&#40;<\/span>ScriptField_Point v<span style=\"color: #66cc66;\">&#41;<\/span> <span style=\"color: #66cc66;\">&#123;<\/span>\n    mExportVar_touchPoints = v;\n    <span style=\"color: #b1b100;\">if<\/span> <span style=\"color: #66cc66;\">&#40;<\/span>v == <span style=\"color: #000000; font-weight: bold;\">null<\/span><span style=\"color: #66cc66;\">&#41;<\/span> bindAllocation<span style=\"color: #66cc66;\">&#40;<\/span><span style=\"color: #000000; font-weight: bold;\">null<\/span>, mExportVarIdx_touchPoints<span style=\"color: #66cc66;\">&#41;<\/span>;\n    <span style=\"color: #b1b100;\">else<\/span> bindAllocation<span style=\"color: #66cc66;\">&#40;<\/span>v.<span style=\"color: #006600;\">getAllocation<\/span><span style=\"color: #66cc66;\">&#40;<\/span><span style=\"color: #66cc66;\">&#41;<\/span>, mExportVarIdx_touchPoints<span style=\"color: #66cc66;\">&#41;<\/span>;\n<span style=\"color: #66cc66;\">&#125;<\/span>\n&#160;\n<span style=\"color: #000000; font-weight: bold;\">public<\/span> ScriptField_Point get_touchPoints<span style=\"color: #66cc66;\">&#40;<\/span><span style=\"color: #66cc66;\">&#41;<\/span> <span style=\"color: #66cc66;\">&#123;<\/span>\n    <span style=\"color: #000000; font-weight: bold;\">return<\/span> mExportVar_touchPoints;\n<span style=\"color: #66cc66;\">&#125;<\/span>\n&#160;\n<span style=\"color: #000000; font-weight: bold;\">private<\/span> Allocation mExportVar_intPointer;\n<span style=\"color: #000000; font-weight: bold;\">public<\/span> <span style=\"color: #993333;\">void<\/span> bind_intPointer<span style=\"color: #66cc66;\">&#40;<\/span>Allocation v<span style=\"color: #66cc66;\">&#41;<\/span> <span style=\"color: #66cc66;\">&#123;<\/span>\n    mExportVar_intPointer = v;\n    <span style=\"color: #b1b100;\">if<\/span> <span style=\"color: #66cc66;\">&#40;<\/span>v == <span style=\"color: #000000; font-weight: bold;\">null<\/span><span style=\"color: #66cc66;\">&#41;<\/span> bindAllocation<span style=\"color: #66cc66;\">&#40;<\/span><span style=\"color: #000000; font-weight: bold;\">null<\/span>, mExportVarIdx_intPointer<span style=\"color: #66cc66;\">&#41;<\/span>;\n    <span style=\"color: #b1b100;\">else<\/span> bindAllocation<span style=\"color: #66cc66;\">&#40;<\/span>v, mExportVarIdx_intPointer<span style=\"color: #66cc66;\">&#41;<\/span>;\n<span style=\"color: #66cc66;\">&#125;<\/span>\n&#160;\n<span style=\"color: #000000; font-weight: bold;\">public<\/span> Allocation get_intPointer<span style=\"color: #66cc66;\">&#40;<\/span><span style=\"color: #66cc66;\">&#41;<\/span> <span style=\"color: #66cc66;\">&#123;<\/span>\n    <span style=\"color: #000000; font-weight: bold;\">return<\/span> mExportVar_intPointer;\n<span style=\"color: #66cc66;\">&#125;<\/span>\n&#160;<\/pre>\n<p>\u4e00\u4e2aget\u65b9\u6cd5\u548c\u4e00\u4e2a\u540d\u4e3abind_pointer_name\u7684\u7279\u6b8a\u65b9\u6cd5\uff08\u53d6\u4ee3\u4e00\u4e2aset()\u65b9\u6cd5\uff09\u88ab\u751f\u6210\u3002\u8fd9\u4e2a\u65b9\u6cd5\u5141\u8bb8\u4f60\u7ed1\u5b9a\u5728Android\u865a\u62df\u673a\u4e2d\u5206\u914d\u7684\u5185\u5b58\u5230Renderscript\u8fd0\u884c\u65f6\uff08\u4f60\u4e0d\u53ef\u4ee5\u5728\u4f60\u7684.rs\u6587\u4ef6\u4e2d\u5206\u914d\u5185\u5b58\uff09\u3002\u60f3\u83b7\u5f97\u66f4\u591a\u4fe1\u606f\uff0c\u8bf7\u53c2\u89c1\u5904\u7406\u5206\u914d\u7684\u5185\u5b58\u3002\n<\/p>\n<h2> <span class=\"mw-headline\" id=\"Memory_Allocation_APIs\">Memory Allocation APIs<\/span><\/h2>\n<p>\u4f7f\u7528Renderscript \u7684\u5e94\u7528\u7a0b\u5e8f\u4ecd\u7136\u8fd0\u884c\u5728Android VM\u4e2d\uff0c\u4f46\u662f\u5b9e\u9645\u7684Renderscript \u4ee3\u7801\u8fd0\u884c\u5728\u539f\u751f\u5c42\u5e76\u4e14\u9700\u8981\u8bbf\u95ee\u5206\u914d\u5728Android VM\u5185\u7684\u5185\u5b58\u3002\u4e3a\u4e86\u5b9e\u73b0\u5b83\uff0c\u4f60\u5fc5\u987b\u628a\u5728VM\u4e2d\u5206\u914d\u7684\u5185\u5b58\u9644\u52a0\u5230Renderscript\u8fd0\u884c\u65f6\u3002\u8fd9\u4e2a\u8fc7\u7a0b\u53eb\u505a\u7ed1\u5b9a\uff0c\u8fd9\u4f7f\u5f97Renderscript \u8fd0\u884c\u65f6\u65e0\u7f1d\u7684\u5904\u7406\u5b83\u8bf7\u6c42\u7684\u5185\u5b58\u800c\u4e0d\u53ef\u4ee5\u663e\u5f0f\u5730\u5206\u914d\u3002\u6700\u540e\u7684\u7ed3\u6784\u672c\u8d28\u4e0a\u662f\u76f8\u540c\u7684\uff0c\u5982\u679c\u4f60\u66fe\u7ecf\u5728C\u4e2d\u8c03\u7528malloc\u3002\u589e\u52a0\u7684\u597d\u5904\u662fAndroid\u865a\u62df\u673a\u53ef\u4ee5\u89e3\u51b3\u5783\u573e\u56de\u6536\uff08\u6ce8\uff1a\u7684\u95ee\u9898\uff09\u4ee5\u53ca\u4e0eRenderscript\u8fd0\u884c\u65f6\u5c42\u5171\u4eab\u5185\u5b58\u3002\u7ed1\u5b9a\u53ea\u5bf9\u4e8e\u52a8\u6001\u5206\u914d\u7684\u5185\u5b58\u662f\u5fc5\u9700\u7684\u3002\u9759\u6001\u5206\u914d\u7684\u5185\u5b58\u5728\u7f16\u8bd1\u671f\u4e3a\u4f60\u7684Renderscript\u81ea\u52a8\u5730\u88ab\u521b\u5efa\u3002\u89c1\u56fe1\u4ee5\u83b7\u5f97\u5173\u4e8e\u5185\u5b58\u5206\u914d\u5982\u4f55\u53d1\u751f\u7684\u66f4\u591a\u4fe1\u606f\u3002\n<\/p><p>\u4e3a\u4e86\u652f\u6301\u8fd9\u4e2a\u5185\u5b58\u5206\u914d\u7cfb\u7edf\uff0c\u6709\u4e00\u7ec4API\u5141\u8bb8Android\u865a\u62df\u673a\u5206\u914d\u5185\u5b58\u548c\u63d0\u4f9b\u4e0e\u4e00\u4e2amalloc\u8c03\u7528\u76f8\u4f3c\u7684\u529f\u80fd\u3002\u8fd9\u4e9b\u7c7b\u672c\u8d28\u4e0a\u63cf\u8ff0\u5185\u5b58\u5e94\u8be5\u5982\u4f55\u88ab\u5206\u914d\u4ee5\u53ca\u6267\u884c\u5206\u914d\u3002\u4e3a\u4e86\u66f4\u597d\u5730\u7406\u89e3\u8fd9\u4e9b\u7c7b\u5982\u4f55\u5de5\u4f5c\uff0c\u628a\u5b83\u4eec\u4e0e\u4e00\u4e2a\u7b80\u5355\u7684malloc\u8c03\u7528\u5173\u8054\u8d77\u6765\u60f3\u662f\u6709\u7528\u7684\uff0cmalloc\u8c03\u7528\u53ef\u80fd\u770b\u8d77\u6765\u50cf\u8fd9\u6837\uff1a\n<\/p>\n<pre class=\"java\">&#160;\narray = <span style=\"color: #66cc66;\">&#40;<\/span><span style=\"color: #993333;\">int<\/span> *<span style=\"color: #66cc66;\">&#41;<\/span>malloc<span style=\"color: #66cc66;\">&#40;<\/span>sizeof<span style=\"color: #66cc66;\">&#40;<\/span><span style=\"color: #993333;\">int<\/span><span style=\"color: #66cc66;\">&#41;<\/span>*<span style=\"color: #cc66cc;\">10<\/span><span style=\"color: #66cc66;\">&#41;<\/span>;\n&#160;<\/pre>\n<p>malloc\u8c03\u7528\u53ef\u4ee5\u88ab\u5206\u5272\u6210\u4e24\u90e8\u5206\uff1a\u5185\u5b58\u7684\u5927\u5c0f\u6b63\u5728\u88ab\u5206\u914d\uff08sizeof(int)\uff09\uff0c\u4f34\u968f\u7740\u90a3\u4e2a\u5185\u5b58\u7684\u591a\u5c11\u5355\u5143\u5e94\u8be5\u88ab\u5206\u914d\uff0810\uff09\u3002Android\u6846\u67b6\u4e3a\u8fd9\u4e24\u4e2a\u90e8\u5206\u63d0\u4f9b\u7c7b\u5e76\u4e14\u7528\u4e00\u4e2a\u7c7b\u6765\u4ee3\u8868malloc\u81ea\u8eab\u3002\n<\/p><p><a rel=\"nofollow\" target=\"_blank\" class=\"external text\" href=\"http:\/\/docs.eoeandroid.com\/reference\/android\/renderscript\/Element.html\">Element<\/a>\u7c7b\u4ee3\u8868malloc\u5bf9\u4e8e\u7684(sizeof(int))\u90e8\u5206\uff0c\u5e76\u4e14\u5c01\u88c5\u5185\u5b58\u5206\u914d\u7684\u4e00\u4e2a\u5355\u5143\uff0c\u8bf8\u5982\u4e00\u4e2a\u5355\u4e00float\u503c\u6216\u4e00\u4e2astruct\u3002<a rel=\"nofollow\" target=\"_blank\" class=\"external text\" href=\"http:\/\/docs.eoeandroid.com\/reference\/android\/renderscript\/Type.html\">Type<\/a>\u7c7b\u5c01\u88c5\u5143\u7d20\u548c\u8981\u5206\u914d\u7684\u5143\u7d20\u4e2a\u6570\uff08\u5728\u6211\u4eec\u7684\u793a\u4f8b\u4e2d\u662f10\uff09\u3002\u4f60\u53ef\u4ee5\u8ba4\u4e3a\u4e00\u4e2a<a rel=\"nofollow\" target=\"_blank\" class=\"external text\" href=\"http:\/\/docs.eoeandroid.com\/reference\/android\/renderscript\/Type.html\">Type<\/a>\u662f\u4e00\u4e2a<a rel=\"nofollow\" target=\"_blank\" class=\"external text\" href=\"http:\/\/docs.eoeandroid.com\/reference\/android\/renderscript\/Element.html\">Element<\/a>\u6570\u7ec4\u3002Allocation\u7c7b\u57fa\u4e8e\u7ed9\u5b9a<a rel=\"nofollow\" target=\"_blank\" class=\"external text\" href=\"http:\/\/docs.eoeandroid.com\/reference\/android\/renderscript\/Type.html\">Type<\/a>\u6267\u884c\u5b9e\u9645\u5185\u5b58\u5206\u914d\u5e76\u4e14\u4ee3\u8868\u5b9e\u9645\u5206\u914d\u7684\u5185\u5b58\u3002\n<\/p><p>\u5728\u5927\u591a\u6570\u60c5\u51b5\u4e0b\uff0c\u4f60\u4e0d\u9700\u8981\u76f4\u63a5\u5730\u8c03\u7528\u8fd9\u4e9b\u5185\u5b58\u5206\u914dAPI\u3002\u53cd\u5c04\u5c42\u7684\u7c7b\u751f\u6210\u4ee3\u7801\u4ee5\u81ea\u52a8\u5730\u4f7f\u7528\u8fd9\u4e9bAPI\uff0c\u800c\u4e14\u4f60\u8981\u5206\u914d\u5185\u5b58\u800c\u9700\u8981\u505a\u7684\u6240\u6709\u4e8b\u60c5\u662f\u8c03\u7528\u88ab\u58f0\u660e\u5728\u53cd\u5c04\u5c42\u7684\u7c7b\u4e4b\u4e00\u4e2d\u7684\u4e00\u4e2a\u6784\u9020\u51fd\u6570\uff0c\u7136\u540e\u7ed1\u5b9a\u7ed3\u679c\u7684\u5185\u5b58<a rel=\"nofollow\" target=\"_blank\" class=\"external text\" href=\"http:\/\/docs.eoeandroid.com\/reference\/android\/renderscript\/Allocation.html\">Allocation<\/a>\u5230Renderscript\u3002\u6709\u4e00\u4e9b\u60c5\u51b5\uff0c\u4f60\u5c06\u5e0c\u671b\u76f4\u63a5\u4f7f\u7528\u8fd9\u4e9b\u7c7b\u81ea\u5df1\u5206\u914d\u5185\u5b58\uff0c\u8bf8\u5982\u4ece\u4e00\u4e2a\u8d44\u6e90\u4e2d\u52a0\u8f7d\u4e00\u4e2a\u4f4d\u56fe\u6216\u5f53\u4f60\u5e0c\u671b\u4e3a\u6307\u5411\u539f\u59cb\u7c7b\u578b\u7684\u6307\u9488\u5206\u914d\u5185\u5b58\u3002\u4f60\u53ef\u4ee5\u5728\u5206\u914d\u548c\u7ed1\u5b9a\u5185\u5b58\u5230<a rel=\"nofollow\" target=\"_blank\" class=\"external text\" href=\"http:\/\/docs.eoeandroid.com\/guide\/topics\/graphics\/renderscript\/index.html#allocating-mem\">Renderscript<\/a>\u7684\u7ae0\u8282\u4e2d\u770b\u5230\u5982\u4f55\u505a\u8fd9\u4ef6\u4e8b\u3002\u4ee5\u4e0b\u8868\u683c\u66f4\u8be6\u7ec6\u5730\u63cf\u8ff0\u4e09\u4e2a\u5185\u5b58\u7ba1\u7406\u7c7b\u3002\n<\/p>\n<table style=\"border-spacing: 0px;margin: 4px 4px; width: 90%; border-left:1px solid #ccc;border-top:1px solid #ccc;\">\n\n\n<tr style=\"background:#DEE8F1;\">\n<th style=\"border-right:1px solid #ccc;border-bottom:1px solid #ccc; padding:5px 15px\"> Android Object Type\n<\/th>\n<th style=\"border-right:1px solid #ccc;border-bottom:1px solid #ccc; padding:5px 15px\"> Description\n<\/th><\/tr>\n<tr style=\"vertical-align:top;\">\n<td style=\"border-right:1px solid #ccc;border-bottom:1px solid #ccc; padding:5px 15px;\">\n<p><a rel=\"nofollow\" target=\"_blank\" class=\"external text\" href=\"http:\/\/docs.eoeandroid.com\/reference\/android\/renderscript\/Element.html\">Element<\/a>\n<\/p>\n<\/td>\n<td style=\"border-right:1px solid #ccc;border-bottom:1px solid #ccc; padding:5px 15px;\">\n<p>An element describes one cell of a memory allocation and can have two forms: basic or complex.\n<\/p><p>A basic element contains a single component of data of any valid Renderscript data type. Examples of basic element data types include a single float value, a float4 vector, or a single RGB-565 color.\n<\/p><p>Complex elements contain a list of basic elements and are created from structs that you declare in your Renderscript code. For instance an allocation can contain multiple structs arranged in order in memory. Each struct is considered as its own element, rather than each data type within that struct.\n<\/p>\n<\/td><\/tr>\n<tr style=\"vertical-align:top;\">\n<td style=\"border-right:1px solid #ccc;border-bottom:1px solid #ccc; padding:5px 15px;\">\n<p><a rel=\"nofollow\" target=\"_blank\" class=\"external text\" href=\"http:\/\/docs.eoeandroid.com\/reference\/android\/renderscript\/Type.html\">Type<\/a>\n<\/p>\n<\/td>\n<td style=\"border-right:1px solid #ccc;border-bottom:1px solid #ccc; padding:5px 15px;\">\n<p>A type is a memory allocation template and consists of an element and one or more dimensions. It describes the layout of the memory (basically an array of Elements) but does not allocate the memory for the data that it describes.\n<\/p><p>A type consists of five dimensions: X, Y, Z, LOD (level of detail), and Faces (of a cube map). You can assign the X,Y,Z dimensions to any positive integer value within the constraints of available memory. A single dimension allocation has an X dimension of greater than zero while the Y and Z dimensions are zero to indicate not present. For example, an allocation of x=10, y=1 is considered two dimensional and x=10, y=0 is considered one dimensional. The LOD and Faces dimensions are booleans to indicate present or not present.\n<\/p>\n<\/td><\/tr>\n<tr style=\"vertical-align:top;\">\n<td style=\"border-right:1px solid #ccc;border-bottom:1px solid #ccc; padding:5px 15px;\">\n<p><a rel=\"nofollow\" target=\"_blank\" class=\"external text\" href=\"http:\/\/docs.eoeandroid.com\/reference\/android\/renderscript\/Allocation.html\">Allocation<\/a>\n<\/p>\n<\/td>\n<td style=\"border-right:1px solid #ccc;border-bottom:1px solid #ccc; padding:5px 15px;\">\n<p>An allocation provides the memory for applications based on a description of the memory that is represented by a Type. Allocated memory can exist in many memory spaces concurrently. If memory is modified in one space, you must explicitly synchronize the memory, so that it is updated in all the other spaces in which it exists. \n<\/p><p>Allocation data is uploaded in one of two primary ways: type checked and type unchecked. For simple arrays there are copyFrom() functions that take an array from the Android system and copy it to the native layer memory store. The unchecked variants allow the Android system to copy over arrays of structures because it does not support structures. For example, if there is an allocation that is an array of n floats, the data contained in a float[n] array or a byte[n*4] array can be copied.\n<\/p>\n<\/td><\/tr><\/table>\n<p><br \/>\n<\/p>\n<h2> <span class=\"mw-headline\" id=\".E5.A4.84.E7.90.86.E5.86.85.E5.AD.98\">\u5904\u7406\u5185\u5b58<\/span><\/h2>\n<p>\u4f60\u5728\u4f60\u7684Renderscript\u4e2d\u58f0\u660e\u7684\u975e\u9759\u6001\u3001\u5168\u5c40\u53d8\u91cf\u662f\u5728\u7f16\u8bd1\u671f\u5206\u914d\u7684\u5185\u5b58\u3002\u4f60\u53ef\u4ee5\u76f4\u63a5\u5730\u5728\u4f60\u7684Renderscript\u4ee3\u7801\u4e2d\u5904\u7406\u8fd9\u4e9b\u53d8\u91cf\u800c\u4e0d\u5fc5\u5728Android\u6846\u67b6\u7ea7\uff08\u6ce8\uff1a\u5c42\uff09\u4e0a\u4e3a\u5b83\u4eec\u5206\u914d\u5185\u5b58\u3002Android\u6846\u67b6\u5c42\u8fd8\u4f7f\u7528\u63d0\u4f9b\u7684\u8bbf\u95ee\u5668\u65b9\u6cd5\u62e5\u6709\u5bf9\u8fd9\u4e9b\u53d8\u91cf\u7684\u8bbf\u95ee\u6743\uff0c\u8fd9\u4e9b\u65b9\u6cd5\u88ab\u751f\u6210\u5728\u53cd\u5c04\u5c42\u7c7b\u4e2d\u3002\u5982\u679c\u8fd9\u4e9b\u53d8\u91cf\u5728Renderscript\u8fd0\u884c\u65f6\u5c42\u4e0a\u88ab\u521d\u59cb\u5316\uff0c\u90a3\u4e9b\u503c\u88ab\u7528\u4e8e\u521d\u59cb\u5316\u5728Android\u6846\u67b6\u5c42\u4e2d\u76f8\u5e94\u7684\u503c\u3002\u5982\u679c\u5168\u5c40\u53d8\u91cf\u88ab\u6807\u6ce8\u4e3aconst\uff0c\u90a3\u4e48\u4e0d\u751f\u6210set\u65b9\u6cd5\u3002\n<\/p>\n<div style=\"margin: 1em 0; padding: 10px; overflow: auto; background: #F7F7F7; border-left:4px solid; border-color:#258AAF;\">\n<p>\u6ce8\u610f\uff1a\u5982\u679c\u4f60\u6b63\u5728\u4f7f\u7528\u67d0\u4e9b\u5305\u542b\u6307\u9488\u7684Renderscript\u7ed3\u6784\u4f53\uff0c\u5982rs_program_fragment\u548crs_allocation\uff0c\u4f60\u4e0d\u5f97\u4e0d\u9996\u5148\u53d6\u51fa\u76f8\u5e94Android\u6846\u67b6\u7c7b\u7684\u4e00\u4e2a\u5bf9\u8c61\uff0c\u7136\u540e\u8c03\u7528\u90a3\u4e2a\u7ed3\u6784\u4f53\u7684set\u65b9\u6cd5\u4ee5\u7ed1\u5b9a\u5185\u5b58\u5230Renderscript\u8fd0\u884c\u65f6\u3002\u4f60\u4e0d\u53ef\u4ee5\u76f4\u63a5\u5728Renderscript\u8fd0\u884c\u65f6\u5c42\u4e0a\u64cd\u7eb5\u8fd9\u4e9b\u7ed3\u6784\u4f53\u3002\u8bf7\u8c28\u8bb0\u7528\u6237\u5b9a\u4e49\u7684\u7ed3\u6784\u4f53\u4e0d\u53ef\u4ee5\u5305\u542b\u6307\u9488\uff0c\u6240\u4ee5\u8fd9\u4e2a\u9650\u5236\u53ea\u9002\u7528\u4e8eRenderscript\u63d0\u4f9b\u7684\u67d0\u4e9b\u7ed3\u6784\u4f53\u3002\n<\/p>\n<\/div>\n<p>Renderscript\u8fd8\u62e5\u6709\u5bf9\u6307\u9488\u7684\u652f\u6301\uff0c\u4f46\u4f60\u5fc5\u987b\u548b\u4f60\u7684Android\u6846\u67b6\u4ee3\u7801\u4e2d\u663e\u5f0f\u5730\u5206\u914d\u5185\u5b58\u3002\u5f53\u4f60\u5728\u4f60\u7684.rs\u6587\u4ef6\u4e2d\u58f0\u660e\u4e00\u4e2a\u5168\u5c40\u6307\u9488\u65f6\uff0c\u4f60\u901a\u8fc7\u5408\u9002\u7684\u53cd\u5c04\u5c42\u7c7b\u5206\u914d\u5185\u5b58\u5e76\u4e14\u7ed1\u5b9a\u90a3\u4e2a\u5185\u5b58\u5230\u539f\u751fRenderscript\u5c42\u3002\u4f60\u53ef\u4ee5\u4eceAndroid\u6846\u67b6\u5c42\u548cRenderscript\u5c42\u4e0e\u8fd9\u4e2a\u5185\u5b58\u4ea4\u4e92\uff0c\u8fd9\u63d0\u4f9b\u7ed9\u4f60\u7075\u6d3b\u6027\u5728\u6700\u5408\u9002\u7684\u5c42\u5185\u4fee\u6539\u53d8\u91cf\u3002\n<\/p>\n<h3> <span class=\"mw-headline\" id=\".E5.8A.A8.E6.80.81.E5.88.86.E9.85.8D.E5.86.85.E5.AD.98.E5.92.8C.E7.BB.91.E5.AE.9A.E5.88.B0Renderscript\">\u52a8\u6001\u5206\u914d\u5185\u5b58\u548c\u7ed1\u5b9a\u5230Renderscript<\/span><\/h3>\n<p>\u4e3a\u4e86\u5206\u914d\u52a8\u6001\u5185\u5b58\uff0c\u4f60\u9700\u8981\u8c03\u7528\u4e00\u4e2aScript.FieldBase\u7c7b\u7684\u6784\u9020\u51fd\u6570\uff0c\u5b83\u662f\u6700\u4e00\u822c\u7684\u65b9\u6cd5\u3002\u4e00\u4e2a\u66ff\u6362\u65b9\u6848\u662f\u624b\u5de5\u521b\u5efa\u4e00\u4e2aAllocation\uff0c\u5b83\u5bf9\u4e8e\u4e00\u4e9b\u4e1c\u897f\u8bf8\u5982\u539f\u59cb\u7c7b\u578b\u6307\u9488\u662f\u5fc5\u9700\u7684\u3002\u4e3a\u4e86\u7b80\u5316\uff0c\u4f60\u5e94\u8be5\u4f7f\u7528\u4e00\u4e2aScript.FieldBase\u7c7b\u6784\u9020\u51fd\u6570\uff0c\u53ea\u8981\u5b83\u662f\u53ef\u7528\u7684\u3002\u5728\u83b7\u53d6\u4e00\u6b21\u5185\u5b58\u5206\u914d\u540e\uff0c\u8c03\u7528\u8be5\u6307\u9488\u88ab\u53cd\u5c04\u7684\u7ed1\u5b9a\u65b9\u6cd5\u4ee5\u7ed1\u5b9a\u88ab\u5206\u914d\u5185\u5b58\u5230Renderscript\u8fd0\u884c\u65f6\u3002\n<\/p><p>\u4e0b\u9762\u7684\u793a\u4f8b\u4e3a\u4e00\u4e2a\u539f\u59cb\u7c7b\u578b\u7684\u6307\u9488intPointer\u548c\u6307\u5411\u4e00\u4e2astruct\u7684\u6307\u9488touchPoints\u90fd\u5206\u914d\u5185\u5b58\u3002\u5b83\u8fd8\u7ed1\u5b9a\u5185\u5b58\u5230Renderscript\uff1a\n<\/p>\n<pre class=\"java\">&#160;\n<span style=\"color: #000000; font-weight: bold;\">private<\/span> RenderScriptGL glRenderer;\n<span style=\"color: #000000; font-weight: bold;\">private<\/span> ScriptC_example script;\n<span style=\"color: #000000; font-weight: bold;\">private<\/span> Resources resources;\n&#160;\n<span style=\"color: #000000; font-weight: bold;\">public<\/span> <span style=\"color: #993333;\">void<\/span> init<span style=\"color: #66cc66;\">&#40;<\/span>RenderScriptGL rs, Resources res<span style=\"color: #66cc66;\">&#41;<\/span> <span style=\"color: #66cc66;\">&#123;<\/span>\n    <span style=\"color: #808080; font-style: italic;\">\/\/get the rendering context and resources from the calling method<\/span>\n    glRenderer = rs;\n    resources = res;\n&#160;\n    <span style=\"color: #808080; font-style: italic;\">\/\/allocate memory for the struct pointer, calling the constructor<\/span>\n    ScriptField_Point touchPoints = <span style=\"color: #000000; font-weight: bold;\">new<\/span> ScriptField_Point<span style=\"color: #66cc66;\">&#40;<\/span>glRenderer, <span style=\"color: #cc66cc;\">2<\/span><span style=\"color: #66cc66;\">&#41;<\/span>;\n&#160;\n    <span style=\"color: #808080; font-style: italic;\">\/\/Create an element manually and allocate memory for the int pointer<\/span>\n    intPointer = Allocation.<span style=\"color: #006600;\">createSized<\/span><span style=\"color: #66cc66;\">&#40;<\/span>glRenderer, <a href=\"http:\/\/www.google.com\/search?hl=en&amp;q=allinurl%3AElement+java.sun.com&amp;btnI=I%27m%20Feeling%20Lucky\"><span style=\"color: #aaaadd; font-weight: bold;\">Element<\/span><\/a>.<span style=\"color: #006600;\">I32<\/span><span style=\"color: #66cc66;\">&#40;<\/span>glRenderer<span style=\"color: #66cc66;\">&#41;<\/span>, <span style=\"color: #cc66cc;\">2<\/span><span style=\"color: #66cc66;\">&#41;<\/span>;\n&#160;\n    <span style=\"color: #808080; font-style: italic;\">\/\/create an instance of the Renderscript, pointing it to the bytecode resource<\/span>\n    mScript = <span style=\"color: #000000; font-weight: bold;\">new<\/span> ScriptC_example<span style=\"color: #66cc66;\">&#40;<\/span>glRenderer, resources, R.<span style=\"color: #006600;\">raw<\/span>.<span style=\"color: #006600;\">example<\/span><span style=\"color: #66cc66;\">&#41;<\/span>;\n&#160;\n    <span style=\"color: #808080; font-style: italic;\">\/\/bind the struct and int pointers to the Renderscript<\/span>\n    mScript.<span style=\"color: #006600;\">bind_touchPoints<\/span><span style=\"color: #66cc66;\">&#40;<\/span>touchPoints<span style=\"color: #66cc66;\">&#41;<\/span>;\n    script.<span style=\"color: #006600;\">bind_intPointer<\/span><span style=\"color: #66cc66;\">&#40;<\/span>intPointer<span style=\"color: #66cc66;\">&#41;<\/span>;\n&#160;\n   ...\n<span style=\"color: #66cc66;\">&#125;<\/span>\n&#160;<\/pre>\n<h3> <span class=\"mw-headline\" id=\".E5.86.85.E5.AD.98.E7.9A.84.E8.AF.BB.E5.86.99\">\u5185\u5b58\u7684\u8bfb\u5199<\/span><\/h3>\n<p>\u4f60\u53ef\u4ee5\u540c\u65f6\u5728Renderscript\u8fd0\u884c\u65f6\u548cAndroid\u6846\u67b6\u5c42\u4e0a\u8bfb\u5199\u9759\u6001\u548c\u52a8\u6001\u5206\u914d\u7684\u5185\u5b58\u3002\n<\/p><p>\u9759\u6001\u5206\u914d\u5185\u5b58\u4f34\u968f\u7740Renderscript\u8fd0\u884c\u65f6\u5c42\u4e0a\u7684\u5355\u5411\u901a\u4fe1\u9650\u5236\u3002\u5f53Renderscript\u4ee3\u7801\u6539\u53d8\u53d8\u91cf\u7684\u503c\u65f6\uff0c\u5b83\u51fa\u4e8e\u6548\u7387\u7684\u76ee\u7684\u800c\u4e0d\u901a\u4fe1\u56deAndroid\u6846\u67b6\u5c42\u3002\u6765\u81eaAndroid\u6846\u67b6\u7684\u88ab\u8bbe\u7f6e\u7684\u6700\u540e\u503c\u603b\u662f\u5728\u5bf9get\u65b9\u6cd5\u7684\u4e00\u6b21\u8c03\u7528\u671f\u95f4\u88ab\u8fd4\u56de\u3002\u7136\u800c\uff0c\u5f53Android\u6846\u67b6\u4fee\u6539\u4e00\u4e2a\u53d8\u91cf\u65f6\uff0c\u90a3\u4e2a\u6539\u53d8\u53ef\u4ee5\u88ab\u81ea\u52a8\u5730\u901a\u4fe1\u5230Renderscript\u8fd0\u884c\u65f6\u6216\u5728\u7a0d\u540e\u7684\u65f6\u5019\u88ab\u540c\u6b65\u3002\u5982\u679c\u4f60\u9700\u8981\u4eceRenderscript\u8fd0\u884c\u65f6\u53d1\u9001\u6570\u636e\u5230Android\u6846\u67b6\u5c42\uff0c\u4f60\u53ef\u4ee5\u4f7f\u7528<a rel=\"nofollow\" target=\"_blank\" class=\"external text\" href=\"http:\/\/docs.eoeandroid.com\/reference\/renderscript\/rs__core_8rsh.html\">rsSendToClient()<\/a>\u51fd\u6570\u4ee5\u514b\u670d\u8fd9\u4e2a\u9650\u5236\u3002\n<\/p><p>\u5f53\u5904\u7406\u52a8\u6001\u5206\u914d\u5185\u5b58\u65f6\uff0c\u5728Renderscript\u8fd0\u884c\u65f6\u5c42\u4e0a\u7684\u4efb\u610f\u6539\u53d8\u88ab\u4f20\u64ad\u56deAndroid\u6846\u67b6\u5c42\uff0c\u5982\u679c\u4f60\u66fe\u4f7f\u7528\u5b83\u7684\u5173\u8054\u6307\u9488\u4fee\u6539\u5185\u5b58\u5206\u914d\u3002\u5728Android\u6846\u67b6\u5c42\u4e0a\u4fee\u6539\u4e00\u4e2a\u5bf9\u8c61\u7acb\u523b\u5730\u4f20\u64ad\u90a3\u4e2a\u6539\u53d8\u56deRenderscript\u8fd0\u884c\u65f6\u5c42\u3002\n<\/p>\n<h3> <span class=\"mw-headline\" id=\".E5.85.A8.E5.B1.80.E5.8F.98.E9.87.8F.E7.9A.84.E8.AF.BB.E5.86.99\">\u5168\u5c40\u53d8\u91cf\u7684\u8bfb\u5199<\/span><\/h3>\n<p>\u8bfb\u5199\u5168\u5c40\u53d8\u91cf\u662f\u4e00\u4e2a\u76f4\u622a\u4e86\u5f53\u7684\u8fc7\u7a0b\u3002\u4f60\u53ef\u4ee5\u5728Android\u6846\u67b6\u5c42\u4e0a\u4f7f\u7528\u8bbf\u95ee\u5668\u65b9\u6cd5\u6216\u76f4\u63a5\u5730\u5728Renderscript\u4ee3\u7801\u4e2d\u8bbe\u7f6e\u5b83\u4eec\u3002\u8c28\u8bb0\u4f60\u5728\u4f60\u7684Renderscript\u4ee3\u7801\u4e2d\u4f5c\u51fa\u7684\u4efb\u610f\u6539\u53d8\u4e0d\u88ab\u4f20\u64ad\u56deAndroid\u6846\u67b6\u5c42\u3002\n<\/p><p>\u4f8b\u5982\uff0c\u5047\u8bbe\u4ee5\u4e0b\u58f0\u660e\u5728\u4e00\u4e2a\u540d\u4e3arsfile.rs\u7684\u6587\u4ef6\u4e2d\u7684\u4e00\u4e2astruct\uff1a\n<\/p>\n<pre class=\"java\">&#160;\ntypedef struct <a href=\"http:\/\/www.google.com\/search?hl=en&amp;q=allinurl%3APoint+java.sun.com&amp;btnI=I%27m%20Feeling%20Lucky\"><span style=\"color: #aaaadd; font-weight: bold;\">Point<\/span><\/a> <span style=\"color: #66cc66;\">&#123;<\/span>\n    <span style=\"color: #993333;\">int<\/span> x;\n    <span style=\"color: #993333;\">int<\/span> y;\n<span style=\"color: #66cc66;\">&#125;<\/span> Point_t;\n&#160;\nPoint_t point;\n&#160;<\/pre>\n<p>\u4f60\u53ef\u4ee5\u50cf\u8fd9\u6837\u76f4\u63a5\u5728rsfile.rs\u4e2d\u8d4b\u503c\u5230struct\u3002\u8fd9\u4e9b\u503c\u4e0d\u88ab\u4f20\u64ad\u56deAndroid\u6846\u67b6\u5c42\uff1a\n<\/p>\n<pre class=\"java\">&#160;\npoint.<span style=\"color: #006600;\">x<\/span> = <span style=\"color: #cc66cc;\">1<\/span>;\npoint.<span style=\"color: #006600;\">y<\/span> = <span style=\"color: #cc66cc;\">1<\/span>;\n&#160;<\/pre>\n<p>\u4f60\u53ef\u4ee5\u5728Android\u6846\u67b6\u5c42\u4e0a\u50cf\u8fd9\u6837\u8d4b\u503c\u7ed9struct\u3002\u8fd9\u4e9b\u503c\u88ab\u4f20\u64ad\u56deRenderscript\u8fd0\u884c\u65f6\u5c42\uff1a\n<\/p>\n<pre class=\"java\">&#160;\nScriptC_rsfile mScript;\n&#160;\n...\n&#160;\n<span style=\"color: #006600;\">Item<\/span> i = <span style=\"color: #000000; font-weight: bold;\">new<\/span> ScriptField_Point.<span style=\"color: #006600;\">Item<\/span><span style=\"color: #66cc66;\">&#40;<\/span><span style=\"color: #66cc66;\">&#41;<\/span>;\ni.<span style=\"color: #006600;\">x<\/span> = <span style=\"color: #cc66cc;\">1<\/span>;\ni.<span style=\"color: #006600;\">y<\/span> = <span style=\"color: #cc66cc;\">1<\/span>;\nmScript.<span style=\"color: #006600;\">set_point<\/span><span style=\"color: #66cc66;\">&#40;<\/span>i<span style=\"color: #66cc66;\">&#41;<\/span>;\n&#160;<\/pre>\n<p>\u4f60\u53ef\u4ee5\u4ece\u4f60\u7684Renderscript\u4ee3\u7801\u4e2d\u8bfb\u5230\u5982\u4e0b\u503c\uff1a\n<\/p>\n<pre class=\"java\">&#160;\nrsDebug<span style=\"color: #66cc66;\">&#40;<\/span><span style=\"color: #ff0000;\">&quot;Printing out a Point&quot;<\/span>, point.<span style=\"color: #006600;\">x<\/span>, point.<span style=\"color: #006600;\">y<\/span><span style=\"color: #66cc66;\">&#41;<\/span>;\n&#160;<\/pre>\n<p>\u4f60\u53ef\u4ee5\u7528\u4ee5\u4e0b\u4ee3\u7801\u5728Android\u6846\u67b6\u5c42\u8bfb\u53d6\u503c\u3002\u8c28\u8bb0\u8fd9\u6bb5\u4ee3\u7801\u53ea\u8fd4\u56de\u4e00\u4e2a\u503c\uff0c\u5982\u679c\u5b83\u66fe\u5728Android\u6846\u67b6\u5c42\u4e0a\u88ab\u8bbe\u7f6e\u3002\u4f60\u5c06\u5f97\u5230\u4e00\u4e2a\u7a7a\u6307\u9488\u5f02\u5e38\uff0c\u5982\u679c\u4f60\u53ea\u5728Renderscript\u8fd0\u884c\u65f6\u5c42\u4e0a\u8bbe\u7f6e\u8be5\u503c\uff1a\n<\/p>\n<pre class=\"java\">&#160;\nLog.<span style=\"color: #006600;\">i<\/span><span style=\"color: #66cc66;\">&#40;<\/span><span style=\"color: #ff0000;\">&quot;TAGNAME&quot;<\/span>, <span style=\"color: #ff0000;\">&quot;Printing out a Point: &quot;<\/span> + mScript.<span style=\"color: #006600;\">get_point<\/span><span style=\"color: #66cc66;\">&#40;<\/span><span style=\"color: #66cc66;\">&#41;<\/span>.<span style=\"color: #006600;\">x<\/span> + <span style=\"color: #ff0000;\">&quot; &quot;<\/span> + mScript.<span style=\"color: #006600;\">get_point<\/span><span style=\"color: #66cc66;\">&#40;<\/span><span style=\"color: #66cc66;\">&#41;<\/span>.<span style=\"color: #006600;\">y<\/span><span style=\"color: #66cc66;\">&#41;<\/span>;\n<a href=\"http:\/\/www.google.com\/search?hl=en&amp;q=allinurl%3ASystem+java.sun.com&amp;btnI=I%27m%20Feeling%20Lucky\"><span style=\"color: #aaaadd; font-weight: bold;\">System<\/span><\/a>.<span style=\"color: #006600;\">out<\/span>.<span style=\"color: #006600;\">println<\/span><span style=\"color: #66cc66;\">&#40;<\/span>point.<span style=\"color: #006600;\">get_x<\/span><span style=\"color: #66cc66;\">&#40;<\/span><span style=\"color: #66cc66;\">&#41;<\/span> + <span style=\"color: #ff0000;\">&quot; &quot;<\/span> + point.<span style=\"color: #006600;\">get_y<\/span><span style=\"color: #66cc66;\">&#40;<\/span><span style=\"color: #66cc66;\">&#41;<\/span><span style=\"color: #66cc66;\">&#41;<\/span>;\n&#160;<\/pre>\n<h3> <span class=\"mw-headline\" id=\".E5.85.A8.E5.B1.80.E6.8C.87.E9.92.88.E7.9A.84.E8.AF.BB.E5.86.99\">\u5168\u5c40\u6307\u9488\u7684\u8bfb\u5199<\/span><\/h3>\n<p>\u5047\u8bbe\u5185\u5b58\u5df2\u7ecf\u5728Android\u6846\u67b6\u5c42\u4e2d\u88ab\u5206\u914d\uff0c\u5e76\u4e14\u5df2\u7ecf\u88ab\u7ed1\u5b9a\u5230Renderscript\u8fd0\u884c\u65f6\uff0c\u4f60\u53ef\u4ee5\u4eceAndroid\u6846\u67b6\u5c42\u4e2d\u901a\u8fc7\u4f7f\u7528\u90a3\u4e2a\u6307\u9488\u7684get\u548cset\u65b9\u6cd5\u6765\u8bfb\u5199\u5185\u5b58\u3002\u5728Renderscript\u8fd0\u884c\u65f6\u5c42\u4e2d\uff0c\u4f60\u53ef\u4ee5\u5982\u5e73\u5e38\u90a3\u6837\u7528\u6307\u9488\u8bfb\u5199\u5185\u5b58\uff0c\u800c\u6539\u53d8\u88ab\u4f20\u64ad\u56deAndroid\u6846\u67b6\u5c42\uff0c\u4e0d\u50cf\u4f7f\u7528\u9759\u6001\u5206\u914d\u5185\u5b58\u90a3\u6837\u3002\n<\/p><p><br \/>\n\u4f8b\u5982\uff0c\u5047\u8bbe\u4e0b\u9762\u5728\u4e00\u4e2a\u540d\u4e3arsfile.rs\u6587\u4ef6\u4e2d\u6709\u4e00\u4e2a\u6307\u5411\u4e00\u4e2astruct\u7684\u6307\u9488\uff1a\n<\/p>\n<pre class=\"java\">&#160;\ntypedef struct <a href=\"http:\/\/www.google.com\/search?hl=en&amp;q=allinurl%3APoint+java.sun.com&amp;btnI=I%27m%20Feeling%20Lucky\"><span style=\"color: #aaaadd; font-weight: bold;\">Point<\/span><\/a> <span style=\"color: #66cc66;\">&#123;<\/span>\n    <span style=\"color: #993333;\">int<\/span> x;\n    <span style=\"color: #993333;\">int<\/span> y;\n<span style=\"color: #66cc66;\">&#125;<\/span> Point_t;\nPoint_t *point;\n&#160;<\/pre>\n<p>\u5047\u8bbe\u4f60\u5df2\u7ecf\u5728Android\u6846\u67b6\u5c42\u5206\u914d\u597d\u5185\u5b58\uff0c\u4f60\u53ef\u4ee5\u5982\u5e73\u5e38\u90a3\u6837\u8bbf\u95ee\u7ed3\u6784\u4f53\u4e2d\u7684\u503c\u3002\u4f60\u901a\u8fc7\u5176\u6307\u9488\u503c\u5bf9struct\u4f5c\u51fa\u7684\u4efb\u4f55\u6539\u53d8\u5bf9\u4e8eAndroid\u6846\u67b6\u5c42\u662f\u81ea\u52a8\u5730\u53ef\u7528\u7684\uff1a\n<\/p>\n<pre class=\"java\">&#160;\npoint<span style=\"color: #66cc66;\">&#91;<\/span>index<span style=\"color: #66cc66;\">&#93;<\/span>.<span style=\"color: #006600;\">x<\/span> = <span style=\"color: #cc66cc;\">1<\/span>;\npoint<span style=\"color: #66cc66;\">&#91;<\/span>index<span style=\"color: #66cc66;\">&#93;<\/span>.<span style=\"color: #006600;\">y<\/span> = <span style=\"color: #cc66cc;\">1<\/span>;\n&#160;<\/pre>\n<p>\u4f60\u8fd8\u53ef\u4ee5\u5728Android\u6846\u67b6\u5c42\u4e0a\u8bfb\u5199\u6307\u9488\uff1a\n<\/p>\n<pre class=\"java\">&#160;\nScriptField_Point p = <span style=\"color: #000000; font-weight: bold;\">new<\/span> ScriptField_Point<span style=\"color: #66cc66;\">&#40;<\/span>mRS, <span style=\"color: #cc66cc;\">1<\/span><span style=\"color: #66cc66;\">&#41;<\/span>;\n    Item i = <span style=\"color: #000000; font-weight: bold;\">new<\/span> ScriptField_Point.<span style=\"color: #006600;\">Item<\/span><span style=\"color: #66cc66;\">&#40;<\/span><span style=\"color: #66cc66;\">&#41;<\/span>;\n    i.<span style=\"color: #006600;\">x<\/span>=<span style=\"color: #cc66cc;\">100<\/span>;\n    i.<span style=\"color: #006600;\">y<\/span> = <span style=\"color: #cc66cc;\">100<\/span>;\n    p.<span style=\"color: #006600;\">set<\/span><span style=\"color: #66cc66;\">&#40;<\/span>i, <span style=\"color: #cc66cc;\">0<\/span>, <span style=\"color: #000000; font-weight: bold;\">true<\/span><span style=\"color: #66cc66;\">&#41;<\/span>;\n    mScript.<span style=\"color: #006600;\">bind_point<\/span><span style=\"color: #66cc66;\">&#40;<\/span>p<span style=\"color: #66cc66;\">&#41;<\/span>;\n&#160;\n    points.<span style=\"color: #006600;\">get_x<\/span><span style=\"color: #66cc66;\">&#40;<\/span><span style=\"color: #cc66cc;\">0<\/span><span style=\"color: #66cc66;\">&#41;<\/span>;            <span style=\"color: #808080; font-style: italic;\">\/\/read x and y from index 0<\/span>\n    points.<span style=\"color: #006600;\">get_x<\/span><span style=\"color: #66cc66;\">&#40;<\/span><span style=\"color: #cc66cc;\">0<\/span><span style=\"color: #66cc66;\">&#41;<\/span>;\n&#160;<\/pre>\n<p>\u4e00\u65e6\u5185\u5b58\u88ab\u7ed1\u5b9a\uff0c\u4ee5\u540e\u4f7f\u7528\u4e0d\u518d\u9700\u8981\u91cd\u65b0\u7ed1\u5b9a\u5185\u5b58\u5230Renderscript\u8fd0\u884c\u65f6\u3002\n<\/p>"}